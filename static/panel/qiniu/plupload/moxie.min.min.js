var MXI_DEBUG=true;(function(i,l){var o={};function p(a,e){var b,d=[];for(var c=0;c<a.length;++c){b=o[a[c]]||n(a[c]);if(!b){throw"module definition dependecy not found: "+a[c]}d.push(b)}e.apply(null,d)}function k(a,b,c){if(typeof a!=="string"){throw"invalid module definition, module id must be defined and be a string"}if(b===l){throw"invalid module definition, dependencies must be specified"}if(c===l){throw"invalid module definition, definition function must be specified"}p(b,function(){o[a]=c.apply(null,arguments)})}function m(a){return !!o[a]}function n(a){var c=i;var d=a.split(/[.\/]/);for(var b=0;b<d.length;++b){if(!c[d[b]]){return}c=c[d[b]]}return c}function j(b){for(var c=0;c<b.length;c++){var a=i;var e=b[c];var d=e.split(/[.\/]/);for(var f=0;f<d.length-1;++f){if(a[d[f]]===l){a[d[f]]={}}a=a[d[f]]}a[d[d.length-1]]=o[e]}}k("moxie/core/utils/Basic",[],function(){var B=function(q){var r;if(q===r){return"undefined"}else{if(q===null){return"null"}else{if(q.nodeType){return"node"}}}return({}).toString.call(q).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()};var e=function(q){var r;b(arguments,function(t,s){if(s>0){b(t,function(v,u){if(v!==r){if(B(q[u])===B(v)&&!!~y(B(v),["array","object"])){e(q[u],v)}else{q[u]=v}}})}});return q};var b=function(r,v){var t,q,s,u;if(r){if(B(r.length)==="number"){for(s=0,t=r.length;s<t;s++){if(v(r[s],s)===false){return}}}else{if(B(r)==="object"){for(q in r){if(r.hasOwnProperty(q)){if(v(r[q],q)===false){return}}}}}}};var A=function(r){var q;if(!r||B(r)!=="object"){return true}for(q in r){return false}return true};var g=function(r,s){var u=0,t=r.length;if(B(s)!=="function"){s=function(){}}if(!r||!r.length){s()}function q(v){if(B(r[v])==="function"){r[v](function(D){++v<t&&!D?q(v):s(D)})}}q(u)};var x=function(r,s){var t=0,u=r.length,q=new Array(u);b(r,function(v,D){v(function(C){if(C){return s(C)}var F=[].slice.call(arguments);F.shift();q[D]=F;t++;if(t===u){q.unshift(null);s.apply(this,q)}})})};var y=function(t,s){if(s){if(Array.prototype.indexOf){return Array.prototype.indexOf.call(s,t)}for(var r=0,q=s.length;r<q;r++){if(s[r]===t){return r}}}return -1};var a=function(q,s){var t=[];if(B(q)!=="array"){q=[q]}if(B(s)!=="array"){s=[s]}for(var r in q){if(y(q[r],s)===-1){t.push(q[r])}}return t.length?t:false};var z=function(s,q){var r=[];b(s,function(t){if(y(t,q)!==-1){r.push(t)}});return r.length?r:null};var f=function(s){var q,r=[];for(q=0;q<s.length;q++){r[q]=s[q]}return r};var c=(function(){var q=0;return function(s){var r=new Date().getTime().toString(32),t;for(t=0;t<5;t++){r+=Math.floor(Math.random()*65535).toString(32)}return(s||"o_")+r+(q++).toString(32)}}());var w=function(q){if(!q){return q}return String.prototype.trim?String.prototype.trim.call(q):q.toString().replace(/^\s*/,"").replace(/\s*$/,"")};var h=function(r){if(typeof(r)!=="string"){return r}var s={t:1099511627776,g:1073741824,m:1048576,k:1024},q;r=/^([0-9\.]+)([tmgk]?)$/.exec(r.toLowerCase().replace(/[^0-9\.tmkg]/g,""));q=r[2];r=+r[1];if(s.hasOwnProperty(q)){r*=s[q]}return Math.floor(r)};var d=function(q){var r=[].slice.call(arguments,1);return q.replace(/%[a-z]/g,function(){var s=r.shift();return B(s)!=="undefined"?s:""})};return{guid:c,typeOf:B,extend:e,each:b,isEmptyObj:A,inSeries:g,inParallel:x,inArray:y,arrayDiff:a,arrayIntersect:z,toArray:f,trim:w,sprintf:d,parseSizeStr:h}});k("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(a){var c=(function(T){var J="",M="?",V="function",Q="undefined",Y="object",W="major",U="model",S="name",g="type",K="vendor",P="version",ab="architecture",O="console",X="mobile",N="tablet";var aa={has:function(q,r){return r.toLowerCase().indexOf(q.toLowerCase())!==-1},lowerize:function(q){return q.toLowerCase()}};var R={rgx:function(){for(var q,w=0,x,y,z,A,v,u,t=arguments;w<t.length;w+=2){var r=t[w],s=t[w+1];if(typeof(q)===Q){q={};for(z in s){A=s[z];if(typeof(A)===Y){q[A[0]]=T}else{q[A]=T}}}for(x=y=0;x<r.length;x++){v=r[x].exec(this.getUA());if(!!v){for(z=0;z<s.length;z++){u=v[++y];A=s[z];if(typeof(A)===Y&&A.length>0){if(A.length==2){if(typeof(A[1])==V){q[A[0]]=A[1].call(this,u)}else{q[A[0]]=A[1]}}else{if(A.length==3){if(typeof(A[1])===V&&!(A[1].exec&&A[1].test)){q[A[0]]=u?A[1].call(this,u,A[2]):T}else{q[A[0]]=u?u.replace(A[1],A[2]):T}}else{if(A.length==4){q[A[0]]=u?A[3].call(this,u.replace(A[1],A[2])):T}}}}else{q[A]=u?u:T}}break}}if(!!v){break}}return q},str:function(t,q){for(var r in q){if(typeof(q[r])===Y&&q[r].length>0){for(var s=0;s<q[r].length;s++){if(aa.has(q[r][s],t)){return(r===M)?T:r}}}else{if(aa.has(q[r],t)){return(r===M)?T:r}}}return t}};var Z={browser:{oldsafari:{major:{"1":["/8","/1","/3"],"2":"/4","?":"/"},version:{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0","2000":"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0","7":"NT 6.1","8":"NT 6.2","8.1":"NT 6.3",RT:"ARM"}}}};var h={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[S,P],[/\s(opr)\/([\w\.]+)/i],[[S,"Opera"],P],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],[S,P],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[S,"IE"],P],[/(edge)\/((\d+)?[\w\.]+)/i],[S,P],[/(yabrowser)\/([\w\.]+)/i],[[S,"Yandex"],P],[/(comodo_dragon)\/([\w\.]+)/i],[[S,/_/g," "],P],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[S,P],[/(dolfin)\/([\w\.]+)/i],[[S,"Dolphin"],P],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[S,"Chrome"],P],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[P,[S,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[P,[S,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[P,[S,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[P,[S,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[P,S],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[S,[P,R.str,Z.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[S,P],[/(navigator|netscape)\/([\w\.-]+)/i],[[S,"Netscape"],P],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[S,P]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[P,[S,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[S,P],[/rv\:([\w\.]+).*(gecko)/i],[P,S]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[S,P],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[S,[P,R.str,Z.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[S,"Windows"],[P,R.str,Z.os.windows.version]],[/\((bb)(10);/i],[[S,"BlackBerry"],P],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[S,P],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[S,"Symbian"],P],[/\((series40);/i],[S],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[S,"Firefox OS"],P],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[S,P],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[S,"Chromium OS"],P],[/(sunos)\s?([\w\.]+\d)*/i],[[S,"Solaris"],P],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[S,P],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[S,"iOS"],[P,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[S,"Mac OS"],[P,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[S,P]]};var L=function(r){var q=r||((window&&window.navigator&&window.navigator.userAgent)?window.navigator.userAgent:J);this.getBrowser=function(){return R.rgx.apply(this,h.browser)};this.getEngine=function(){return R.rgx.apply(this,h.engine)};this.getOS=function(){return R.rgx.apply(this,h.os)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return q};this.setUA=function(s){q=s;return this};this.setUA(q)};return L})();function d(z,B,x){var C=0,A=0,y=0,h={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},g=function(q){q=(""+q).replace(/[_\-+]/g,".");q=q.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,".");return(!q.length?[-8]:q.split("."))},D=function(q){return !q?0:(isNaN(q)?h[q]||-7:parseInt(q,10))};z=g(z);B=g(B);A=Math.max(z.length,B.length);for(C=0;C<A;C++){if(z[C]==B[C]){continue}z[C]=D(z[C]);B[C]=D(B[C]);if(z[C]<B[C]){y=-1;break}else{if(z[C]>B[C]){y=1;break}}}if(!x){return y}switch(x){case">":case"gt":return(y>0);case">=":case"ge":return(y>=0);case"<=":case"le":return(y<=0);case"==":case"=":case"eq":return(y===0);case"<>":case"!=":case"ne":return(y!==0);case"":case"<":case"lt":return(y<0);default:return null}}var b=(function(){var g={define_property:(function(){return false}()),create_canvas:(function(){var h=document.createElement("canvas");return !!(h.getContext&&h.getContext("2d"))}()),return_response_type:function(t){try{if(a.inArray(t,["","text","document"])!==-1){return true}else{if(window.XMLHttpRequest){var h=new XMLHttpRequest();h.open("get","/");if("responseType" in h){h.responseType=t;if(h.responseType!==t){return false}return true}}}}catch(s){}return false},use_data_uri:(function(){var h=new Image();h.onload=function(){g.use_data_uri=(h.width===1&&h.height===1)};setTimeout(function(){h.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1);return false}()),use_data_uri_over32kb:function(){return g.use_data_uri&&(e.browser!=="IE"||e.version>=9)},use_data_uri_of:function(h){return(g.use_data_uri&&h<33000||g.use_data_uri_over32kb())},use_fileinput:function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/)){return false}var h=document.createElement("input");h.setAttribute("type","file");return !h.disabled}};return function(h){var r=[].slice.call(arguments);r.shift();return a.typeOf(g[h])==="function"?g[h].apply(this,r):!!g[h]}}());var f=new c().getResult();var e={can:b,uaParser:c,browser:f.browser.name,version:f.browser.version,os:f.os.name,osVersion:f.os.version,verComp:d,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};e.OS=e.os;if(MXI_DEBUG){e.debug={runtime:true,events:false};e.log=function(){function h(q){r.appendChild(document.createTextNode(q+"\n"))}var g=arguments[0];if(a.typeOf(g)==="string"){g=a.sprintf.apply(this,arguments)}if(window&&window.console&&window.console.log){window.console.log(g)}else{if(document){var r=document.getElementById("moxie-console");if(!r){r=document.createElement("pre");r.id="moxie-console";document.body.appendChild(r)}if(a.inArray(a.typeOf(g),["object","array"])!==-1){h(g)}else{r.appendChild(document.createTextNode(g+"\n"))}}}}}return e});k("moxie/core/I18n",["moxie/core/utils/Basic"],function(a){var b={};return{addI18n:function(c){return a.extend(b,c)},translate:function(c){return b[c]||c},_:function(c){return this.translate(c)},sprintf:function(c){var d=[].slice.call(arguments,1);return c.replace(/%[a-z]/g,function(){var e=d.shift();return a.typeOf(e)!=="undefined"?e:""})}}});k("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(a,b){var d="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe";var c={mimes:{},extensions:{},addMimeType:function(e){var r=e.split(/,/),h,f,g;for(h=0;h<r.length;h+=2){g=r[h+1].split(/ /);for(f=0;f<g.length;f++){this.mimes[g[f]]=r[h]}this.extensions[r[h]]=g}},extList2mimes:function(g,f){var x=this,h,w,u,v,e=[];for(w=0;w<g.length;w++){h=g[w].extensions.split(/\s*,\s*/);for(u=0;u<h.length;u++){if(h[u]==="*"){return[]}v=x.mimes[h[u]];if(v&&a.inArray(v,e)===-1){e.push(v)}if(f&&/^\w+$/.test(h[u])){e.push("."+h[u])}else{if(!v){return[]}}}}return e},mimes2exts:function(e){var g=this,f=[];a.each(e,function(h){if(h==="*"){f=[];return false}var r=h.match(/^(\w+)\/(\*|\w+)$/);if(r){if(r[2]==="*"){a.each(g.extensions,function(t,q){if((new RegExp("^"+r[1]+"/")).test(q)){[].push.apply(f,g.extensions[q])}})}else{if(g.extensions[h]){[].push.apply(f,g.extensions[h])}}}});return f},mimes2extList:function(e){var f=[],g=[];if(a.typeOf(e)==="string"){e=a.trim(e).split(/\s*,\s*/)}g=this.mimes2exts(e);f.push({title:b.translate("Files"),extensions:g.length?g.join(","):"*"});f.mimes=e;return f},getFileExtension:function(f){var e=f&&f.match(/\.([^.]+)$/);if(e){return e[1].toLowerCase()}return""},getFileMime:function(e){return this.mimes[this.getFileExtension(e)]||""}};c.addMimeType(d);return c});k("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(d){var c=function(r){if(typeof r!=="string"){return r}return document.getElementById(r)};var b=function(t,u){if(!t.className){return false}var v=new RegExp("(^|\\s+)"+u+"(\\s+|$)");return v.test(t.className)};var a=function(s,t){if(!b(s,t)){s.className=!s.className?t:s.className.replace(/\s+$/,"")+" "+t}};var f=function(t,u){if(t.className){var v=new RegExp("(^|\\s+)"+u+"(\\s+|$)");t.className=t.className.replace(v,function(r,s,q){return s===" "&&q===" "?" ":""})}};var e=function(s,t){if(s.currentStyle){return s.currentStyle[t]}else{if(window.getComputedStyle){return window.getComputedStyle(s,null)[t]}}};var g=function(x,E){var D=0,F=0,B,C=document,H,G;x=x;E=E||C.body;function y(r){var t,s,u=0,q=0;if(r){s=r.getBoundingClientRect();t=C.compatMode==="CSS1Compat"?C.documentElement:C.body;u=s.left+t.scrollLeft;q=s.top+t.scrollTop}return{x:u,y:q}}if(x&&x.getBoundingClientRect&&d.browser==="IE"&&(!C.documentMode||C.documentMode<8)){H=y(x);G=y(E);return{x:H.x-G.x,y:H.y-G.y}}B=x;while(B&&B!=E&&B.nodeType){D+=B.offsetLeft||0;F+=B.offsetTop||0;B=B.offsetParent}B=x.parentNode;while(B&&B!=E&&B.nodeType){D-=B.scrollLeft||0;F-=B.scrollTop||0;B=B.parentNode}return{x:D,y:F}};var h=function(r){return{w:r.offsetWidth||r.clientWidth,h:r.offsetHeight||r.clientHeight}};return{get:c,hasClass:b,addClass:a,removeClass:f,getStyle:e,getPos:g,getSize:h}});k("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(a){function b(c,d){var e;for(e in c){if(c[e]===d){return e}}return null}return{RuntimeError:(function(){var d={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};function c(e){this.code=e;this.name=b(d,e);this.message=this.name+": RuntimeError "+this.code}a.extend(c,d);c.prototype=Error.prototype;return c}()),OperationNotAllowedException:(function(){function c(d){this.code=d;this.name="OperationNotAllowedException"}a.extend(c,{NOT_ALLOWED_ERR:1});c.prototype=Error.prototype;return c}()),ImageError:(function(){var d={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};function c(e){this.code=e;this.name=b(d,e);this.message=this.name+": ImageError "+this.code}a.extend(c,d);c.prototype=Error.prototype;return c}()),FileException:(function(){var d={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};function c(e){this.code=e;this.name=b(d,e);this.message=this.name+": FileException "+this.code}a.extend(c,d);c.prototype=Error.prototype;return c}()),DOMException:(function(){var d={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};function c(e){this.code=e;this.name=b(d,e);this.message=this.name+": DOMException "+this.code}a.extend(c,d);c.prototype=Error.prototype;return c}()),EventException:(function(){function c(d){this.code=d;this.name="EventException"}a.extend(c,{UNSPECIFIED_EVENT_TYPE_ERR:0});c.prototype=Error.prototype;return c}())}});k("moxie/core/EventTarget",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic"],function(c,d,b){function a(){var e={};b.extend(this,{uid:null,init:function(){if(!this.uid){this.uid=b.guid("uid_")}},addEventListener:function(g,h,u,t){var v=this,f;if(!this.hasOwnProperty("uid")){this.uid=b.guid("uid_")}g=b.trim(g);if(/\s/.test(g)){b.each(g.split(/\s+/),function(q){v.addEventListener(q,h,u,t)});return}g=g.toLowerCase();u=parseInt(u,10)||0;f=e[this.uid]&&e[this.uid][g]||[];f.push({fn:h,priority:u,scope:t||this});if(!e[this.uid]){e[this.uid]={}}e[this.uid][g]=f},hasEventListener:function(f){return f?!!(e[this.uid]&&e[this.uid][f]):!!e[this.uid]},removeEventListener:function(g,h){g=g.toLowerCase();var f=e[this.uid]&&e[this.uid][g],r;if(f){if(h){for(r=f.length-1;r>=0;r--){if(f[r].fn===h){f.splice(r,1);break}}}else{f=[]}if(!f.length){delete e[this.uid][g];if(b.isEmptyObj(e[this.uid])){delete e[this.uid]}}}},removeAllEventListeners:function(){if(e[this.uid]){delete e[this.uid]}},dispatchEvent:function(B){var h,g,f,A,z={},y=true,x;if(b.typeOf(B)!=="string"){A=B;if(b.typeOf(A.type)==="string"){B=A.type;if(A.total!==x&&A.loaded!==x){z.total=A.total;z.loaded=A.loaded}z.async=A.async||false}else{throw new d.EventException(d.EventException.UNSPECIFIED_EVENT_TYPE_ERR)}}if(B.indexOf("::")!==-1){(function(q){h=q[0];B=q[1]}(B.split("::")))}else{h=this.uid}B=B.toLowerCase();g=e[h]&&e[h][B];if(g){g.sort(function(q,r){return r.priority-q.priority});f=[].slice.call(arguments);f.shift();z.type=B;f.unshift(z);if(MXI_DEBUG&&c.debug.events){c.log("Event '%s' fired on %u",z.type,h)}var w=[];b.each(g,function(q){f[0].target=q.scope;if(z.async){w.push(function(r){setTimeout(function(){r(q.fn.apply(q.scope,f)===false)},1)})}else{w.push(function(r){r(q.fn.apply(q.scope,f)===false)})}});if(w.length){b.inSeries(w,function(q){y=!q})}}return y},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function(f){var g=this;this.bind(f.join(" "),function(r){var h="on"+r.type.toLowerCase();if(b.typeOf(this[h])==="function"){this[h].apply(this,arguments)}});b.each(f,function(h){h="on"+h.toLowerCase(h);if(b.typeOf(g[h])==="undefined"){g[h]=null}})}})}a.instance=new a();return a});k("moxie/runtime/Runtime",["moxie/core/utils/Env","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(d,g,a,f){var e={},c={};function b(A,D,F,h,y){var B=this,z,C=g.guid(D+"_"),E=y||"browser";A=A||{};c[C]=this;F=g.extend({access_binary:false,access_image_binary:false,display_media:false,do_cors:false,drag_and_drop:false,filter_by_extension:true,resize_image:false,report_upload_progress:false,return_response_headers:false,return_response_type:false,return_status_code:true,send_custom_headers:false,select_file:false,select_folder:false,select_multiple:true,send_binary_string:false,send_browser_cookies:true,send_multipart:true,slice_blob:false,stream_upload:false,summon_file_dialog:false,upload_filesize:true,use_http_method:true},F);if(A.preferred_caps){E=b.getMode(h,A.preferred_caps,E)}if(MXI_DEBUG&&d.debug.runtime){d.log("\tdefault mode: %s",E)}z=(function(){var q={};return{exec:function(u,t,s,r){if(z[t]){if(!q[u]){q[u]={context:this,instance:new z[t]()}}if(q[u].instance[s]){return q[u].instance[s].apply(this,r)}}},removeInstance:function(r){delete q[r]},removeAllInstances:function(){var r=this;g.each(q,function(t,s){if(g.typeOf(t.instance.destroy)==="function"){t.instance.destroy.call(t.context)}r.removeInstance(s)})}}}());g.extend(this,{initialized:false,uid:C,type:D,mode:b.getMode(h,(A.required_caps),E),shimid:C+"_container",clients:0,options:A,can:function(q,t){var s=arguments[2]||F;if(g.typeOf(q)==="string"&&g.typeOf(t)==="undefined"){q=b.parseCaps(q)}if(g.typeOf(q)==="object"){for(var r in q){if(!this.can(r,q[r],s)){return false}}return true}if(g.typeOf(s[q])==="function"){return s[q].call(this,t)}else{return(t===s[q])}},getShimContainer:function(){var r,q=a.get(this.shimid);if(!q){r=this.options.container?a.get(this.options.container):document.body;q=document.createElement("div");q.id=this.shimid;q.className="moxie-shim moxie-shim-"+this.type;g.extend(q.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"});r.appendChild(q);r=null}return q},getShim:function(){return z},shimExec:function(r,q){var s=[].slice.call(arguments,2);return B.getShim().exec.call(this,this.uid,r,q,s)},exec:function(r,q){var s=[].slice.call(arguments,2);if(B[r]&&B[r][q]){return B[r][q].apply(this,s)}return B.shimExec.apply(this,arguments)},destroy:function(){if(!B){return}var q=a.get(this.shimid);if(q){q.parentNode.removeChild(q)}if(z){z.removeAllInstances()}this.unbindAll();delete c[this.uid];this.uid=null;C=B=z=q=null}});if(this.mode&&A.required_caps&&!this.can(A.required_caps)){this.mode=false}}b.order="html5,flash,silverlight,html4";b.getRuntime=function(h){return c[h]?c[h]:false};b.addConstructor=function(h,r){r.prototype=f.instance;e[h]=r};b.getConstructor=function(h){return e[h]||null};b.getInfo=function(r){var h=b.getRuntime(r);if(h){return{uid:h.uid,type:h.type,mode:h.mode,can:function(){return h.can.apply(h,arguments)}}}return null};b.parseCaps=function(r){var h={};if(g.typeOf(r)!=="string"){return r||{}}g.each(r.split(","),function(q){h[q]=true});return h};b.can=function(w,u){var v,x=b.getConstructor(w),h;if(x){v=new x({required_caps:u});h=v.mode;v.destroy();return !!h}return false};b.thatCan=function(t,h){var u=(h||b.order).split(/\s*,\s*/);for(var v in u){if(b.can(u[v],t)){return u[v]}}return null};b.getMode=function(v,h,u){var t=null;if(g.typeOf(u)==="undefined"){u="browser"}if(h&&!g.isEmptyObj(v)){g.each(h,function(q,s){if(v.hasOwnProperty(s)){var r=v[s](q);if(typeof(r)==="string"){r=[r]}if(!t){t=r}else{if(!(t=g.arrayIntersect(t,r))){if(MXI_DEBUG&&d.debug.runtime){d.log("\t\t%c: %v (conflicting mode requested: %s)",s,q,r)}return(t=false)}}}if(MXI_DEBUG&&d.debug.runtime){d.log("\t\t%c: %v (compatible modes: %s)",s,q,t)}});if(t){return g.inArray(u,t)!==-1?u:t[0]}else{if(t===false){return false}}}return u};b.capTrue=function(){return true};b.capFalse=function(){return false};b.capTest=function(h){return function(){return !!h}};return b});k("moxie/runtime/RuntimeClient",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(d,e,a,b){return function c(){var f;a.extend(this,{connectRuntime:function(g){var s=this,h;function t(v){var q,r;if(!v.length){s.trigger("RuntimeError",new e.RuntimeError(e.RuntimeError.NOT_INIT_ERR));f=null;return}q=v.shift().toLowerCase();r=b.getConstructor(q);if(!r){t(v);return}if(MXI_DEBUG&&d.debug.runtime){d.log("Trying runtime: %s",q);d.log(g)}f=new r(g);f.bind("Init",function(){f.initialized=true;if(MXI_DEBUG&&d.debug.runtime){d.log("Runtime '%s' initialized",f.type)}setTimeout(function(){f.clients++;s.trigger("RuntimeInit",f)},1)});f.bind("Error",function(){if(MXI_DEBUG&&d.debug.runtime){d.log("Runtime '%s' failed to initialize",f.type)}f.destroy();t(v)});if(MXI_DEBUG&&d.debug.runtime){d.log("\tselected mode: %s",f.mode)}if(!f.mode){f.trigger("Error");return}f.init()}if(a.typeOf(g)==="string"){h=g}else{if(a.typeOf(g.ruid)==="string"){h=g.ruid}}if(h){f=b.getRuntime(h);if(f){f.clients++;return f}else{throw new e.RuntimeError(e.RuntimeError.NOT_INIT_ERR)}}t((g.runtime_order||b.order).split(/\s*,\s*/))},disconnectRuntime:function(){if(f&&--f.clients<=0){f.destroy()}f=null},getRuntime:function(){if(f&&f.uid){return f}return f=null},exec:function(){if(f){return f.exec.apply(this,arguments)}return null}})}});k("moxie/file/FileInput",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/I18n","moxie/runtime/Runtime","moxie/runtime/RuntimeClient"],function(t,d,f,g,b,v,h,u,c){var a=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];function e(r){if(MXI_DEBUG){d.log("Instantiating FileInput...")}var y=this,z,s,q;if(t.inArray(t.typeOf(r),["string","node"])!==-1){r={browse_button:r}}s=g.get(r.browse_button);if(!s){throw new b.DOMException(b.DOMException.NOT_FOUND_ERR)}q={accept:[{title:h.translate("All Files"),extensions:"*"}],name:"file",multiple:false,required_caps:false,container:s.parentNode||document.body};r=t.extend({},q,r);if(typeof(r.required_caps)==="string"){r.required_caps=u.parseCaps(r.required_caps)}if(typeof(r.accept)==="string"){r.accept=f.mimes2extList(r.accept)}z=g.get(r.container);if(!z){z=document.body}if(g.getStyle(z,"position")==="static"){z.style.position="relative"}z=s=null;c.call(y);t.extend(y,{uid:t.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){y.bind("RuntimeInit",function(w,x){y.ruid=x.uid;y.shimid=x.shimid;y.bind("Ready",function(){y.trigger("Refresh")},999);y.bind("Refresh",function(){var F,G,H,E;H=g.get(r.browse_button);E=g.get(x.shimid);if(H){F=g.getPos(H,g.get(r.container));G=g.getSize(H);if(E){t.extend(E.style,{top:F.y+"px",left:F.x+"px",width:G.w+"px",height:G.h+"px"})}}E=H=null});x.exec.call(y,"FileInput","init",r)});y.connectRuntime(t.extend({},r,{required_caps:{select_file:true}}))},disable:function(w){var x=this.getRuntime();if(x){x.exec.call(this,"FileInput","disable",t.typeOf(w)==="undefined"?true:w)}},refresh:function(){y.trigger("Refresh")},destroy:function(){var w=this.getRuntime();if(w){w.exec.call(this,"FileInput","destroy");this.disconnectRuntime()}if(t.typeOf(this.files)==="array"){t.each(this.files,function(x){x.destroy()})}this.files=null;this.unbindAll()}});this.handleEventProps(a)}e.prototype=v.instance;return e});k("moxie/core/utils/Encode",[],function(){var b=function(e){return unescape(encodeURIComponent(e))};var a=function(e){return decodeURIComponent(escape(e))};var c=function(K,F){if(typeof(window.atob)==="function"){return F?a(window.atob(K)):window.atob(K)}var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var B,C,D,G,H,I,J,E,L=0,h=0,f="",e=[];if(!K){return K}K+="";do{G=g.indexOf(K.charAt(L++));H=g.indexOf(K.charAt(L++));I=g.indexOf(K.charAt(L++));J=g.indexOf(K.charAt(L++));E=G<<18|H<<12|I<<6|J;B=E>>16&255;C=E>>8&255;D=E&255;if(I==64){e[h++]=String.fromCharCode(B)}else{if(J==64){e[h++]=String.fromCharCode(B,C)}else{e[h++]=String.fromCharCode(B,C,D)}}}while(L<K.length);f=e.join("");return F?a(f):f};var d=function(K,D){if(D){K=b(K)}if(typeof(window.btoa)==="function"){return window.btoa(K)}var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var h,r,E,G,H,I,J,g,L=0,e=0,M="",N=[];if(!K){return K}do{h=K.charCodeAt(L++);r=K.charCodeAt(L++);E=K.charCodeAt(L++);g=h<<16|r<<8|E;G=g>>18&63;H=g>>12&63;I=g>>6&63;J=g&63;N[e++]=f.charAt(G)+f.charAt(H)+f.charAt(I)+f.charAt(J)}while(L<K.length);M=N.join("");var F=K.length%3;return(F?M.slice(0,F-3):M)+"===".slice(F||3)};return{utf8_encode:b,utf8_decode:a,atob:c,btoa:d}});k("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(b,d,c){var e={};function a(f,g){function h(v,z,x){var y,w=e[this.uid];if(b.typeOf(w)!=="string"||!w.length){return null}y=new a(null,{type:x,size:z-v});y.detach(w.substr(v,y.size));return y}c.call(this);if(f){this.connectRuntime(f)}if(!g){g={}}else{if(b.typeOf(g)==="string"){g={data:g}}}b.extend(this,{uid:g.uid||b.guid("uid_"),ruid:f,size:g.size||0,type:g.type||"",slice:function(t,v,u){if(this.isDetached()){return h.apply(this,arguments)}return this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),t,v,u)},getSource:function(){if(!e[this.uid]){return null}return e[this.uid]},detach:function(s){if(this.ruid){this.getRuntime().exec.call(this,"Blob","destroy");this.disconnectRuntime();this.ruid=null}s=s||"";if(s.substr(0,5)=="data:"){var t=s.indexOf(";base64,");this.type=s.substring(5,t);s=d.atob(s.substring(t+8))}this.size=s.length;e[this.uid]=s},isDetached:function(){return !this.ruid&&b.typeOf(e[this.uid])==="string"},destroy:function(){this.detach();delete e[this.uid]}});if(g.data){this.detach(g.data)}else{e[this.uid]=g}}return a});k("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(b,c,a){function d(h,g){if(!g){g={}}a.apply(this,arguments);if(!this.type){this.type=c.getFileMime(g.name)}var e;if(g.name){e=g.name.replace(/\\/g,"/");e=e.substr(e.lastIndexOf("/")+1)}else{if(this.type){var f=this.type.split("/")[0];e=b.guid((f!==""?f:"file")+"_");if(c.extensions[this.type]){e+="."+c.extensions[this.type][0]}}}b.extend(this,{name:e||b.guid("file_"),relativePath:"",lastModifiedDate:g.lastModifiedDate||(new Date()).toLocaleString()})}d.prototype=a.prototype;return d});k("moxie/file/FileDrop",["moxie/core/I18n","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/core/utils/Env","moxie/file/File","moxie/runtime/RuntimeClient","moxie/core/EventTarget","moxie/core/utils/Mime"],function(h,f,b,u,e,d,c,v,g){var a=["ready","dragenter","dragleave","drop","error"];function t(r){if(MXI_DEBUG){e.log("Instantiating FileDrop...")}var s=this,q;if(typeof(r)==="string"){r={drop_zone:r}}q={accept:[{title:h.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:true}};r=typeof(r)==="object"?u.extend({},q,r):q;r.container=f.get(r.drop_zone)||document.body;if(f.getStyle(r.container,"position")==="static"){r.container.style.position="relative"}if(typeof(r.accept)==="string"){r.accept=g.mimes2extList(r.accept)}c.call(s);u.extend(s,{uid:u.guid("uid_"),ruid:null,files:null,init:function(){s.bind("RuntimeInit",function(y,z){s.ruid=z.uid;z.exec.call(s,"FileDrop","init",r);s.dispatchEvent("ready")});s.connectRuntime(r)},destroy:function(){var x=this.getRuntime();if(x){x.exec.call(this,"FileDrop","destroy");this.disconnectRuntime()}this.files=null;this.unbindAll()}});this.handleEventProps(a)}t.prototype=v.instance;return t});k("moxie/file/FileReader",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/Exceptions","moxie/core/EventTarget","moxie/file/Blob","moxie/runtime/RuntimeClient"],function(h,d,e,f,g,b){var c=["loadstart","progress","load","abort","error","loadend"];function a(){b.call(this);h.extend(this,{uid:h.guid("uid_"),readyState:a.EMPTY,result:null,error:null,readAsBinaryString:function(q){r.call(this,"readAsBinaryString",q)},readAsDataURL:function(q){r.call(this,"readAsDataURL",q)},readAsText:function(q){r.call(this,"readAsText",q)},abort:function(){this.result=null;if(h.inArray(this.readyState,[a.EMPTY,a.DONE])!==-1){return}else{if(this.readyState===a.LOADING){this.readyState=a.DONE}}this.exec("FileReader","abort");this.trigger("abort");this.trigger("loadend")},destroy:function(){this.abort();this.exec("FileReader","destroy");this.disconnectRuntime();this.unbindAll()}});this.handleEventProps(c);this.bind("Error",function(q,t){this.readyState=a.DONE;this.error=t},999);this.bind("Load",function(q){this.readyState=a.DONE},999);function r(q,w){var x=this;this.trigger("loadstart");if(this.readyState===a.LOADING){this.trigger("error",new e.DOMException(e.DOMException.INVALID_STATE_ERR));this.trigger("loadend");return}if(!(w instanceof g)){this.trigger("error",new e.DOMException(e.DOMException.NOT_FOUND_ERR));this.trigger("loadend");return}this.result=null;this.readyState=a.LOADING;if(w.isDetached()){var v=w.getSource();switch(q){case"readAsText":case"readAsBinaryString":this.result=v;break;case"readAsDataURL":this.result="data:"+w.type+";base64,"+d.btoa(v);break}this.readyState=a.DONE;this.trigger("load");this.trigger("loadend")}else{this.connectRuntime(w.ruid);this.exec("FileReader","read",q,w)}}}a.EMPTY=0;a.LOADING=1;a.DONE=2;a.prototype=f.instance;return a});k("moxie/core/utils/Url",[],function(){var c=function(v,x){var y=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],f=y.length,e={http:80,https:443},h={},d=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,g=d.exec(v||"");while(f--){if(g[f]){h[y[f]]=g[f]}}if(!h.scheme){if(!x||typeof(x)==="string"){x=c(x||document.location.href)}h.scheme=x.scheme;h.host=x.host;h.port=x.port;var w="";if(/^[^\/]/.test(h.path)){w=x.path;if(/\/[^\/]*\.[^\/]*$/.test(w)){w=w.replace(/\/[^\/]+$/,"/")}else{w=w.replace(/\/?$/,"/")}}h.path=w+(h.path||"")}if(!h.port){h.port=e[h.scheme]||80}h.port=parseInt(h.port,10);if(!h.path){h.path="/"}delete h.source;return h};var a=function(d){var f={http:80,https:443},e=typeof(d)==="object"?d:c(d);return e.scheme+"://"+e.host+(e.port!==f[e.scheme]?":"+e.port:"")+e.path+(e.query?e.query:"")};var b=function(d){function e(f){return[f.scheme,f.host,f.port].join("/")}if(typeof d==="string"){d=c(d)}return e(c())===e(d)};return{parseUrl:c,resolveUrl:a,hasSameOrigin:b}});k("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(b,c,a){function d(){this.uid=b.guid("uid_");c.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}d.prototype=a.instance;return d});k("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(a,b,c){return function(){b.call(this);a.extend(this,{uid:a.guid("uid_"),readAsBinaryString:function(e){return d.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){return d.call(this,"readAsDataURL",e)},readAsText:function(e){return d.call(this,"readAsText",e)}});function d(f,u){if(u.isDetached()){var g=u.getSource();switch(f){case"readAsBinaryString":return g;case"readAsDataURL":return"data:"+u.type+";base64,"+c.btoa(g);case"readAsText":var v="";for(var t=0,h=g.length;t<h;t++){v+=String.fromCharCode(g[t])}return v}}else{var e=this.connectRuntime(u.ruid).exec.call(this,"FileReaderSync","read",f,u);this.disconnectRuntime();return e}}}});k("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(d,c,a){function b(){var e,f=[];c.extend(this,{append:function(s,h){var t=this,g=c.typeOf(h);if(h instanceof a){e={name:s,value:h}}else{if("array"===g){s+="[]";c.each(h,function(q){t.append(s,q)})}else{if("object"===g){c.each(h,function(q,r){t.append(s+"["+r+"]",q)})}else{if("null"===g||"undefined"===g||"number"===g&&isNaN(h)){t.append(s,"false")}else{f.push({name:s,value:h.toString()})}}}}},hasBlob:function(){return !!this.getBlob()},getBlob:function(){return e&&e.value||null},getBlobName:function(){return e&&e.name||null},each:function(g){c.each(f,function(h){g(h.value,h.name)});if(e){g(e.value,e.name)}},destroy:function(){e=null;f=[]}})}return b});k("moxie/xhr/XMLHttpRequest",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/core/utils/Url","moxie/runtime/Runtime","moxie/runtime/RuntimeTarget","moxie/file/Blob","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/core/utils/Env","moxie/core/utils/Mime"],function(x,h,C,b,e,D,g,E,c,a,J,f){var I={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};function F(){this.uid=x.guid("uid_")}F.prototype=C.instance;var G=["loadstart","progress","abort","error","load","timeout","loadend"];var H=1,B=2;function d(){var z=this,an={timeout:0,readyState:d.UNSENT,withCredentials:false,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},s=true,ah,ab,A={},y,al,ai=null,ag=null,ar=false,aq=false,aj=false,af=false,ao=false,ak=false,ad,t,u=null,r=null,w={},ac,v="",ap;x.extend(this,an,{uid:x.guid("uid_"),upload:new F(),open:function(K,M,L,O,N){var P;if(!K||!M){throw new h.DOMException(h.DOMException.SYNTAX_ERR)}if(/[\u0100-\uffff]/.test(K)||b.utf8_encode(K)!==K){throw new h.DOMException(h.DOMException.SYNTAX_ERR)}if(!!~x.inArray(K.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])){ab=K.toUpperCase()}if(!!~x.inArray(ab,["CONNECT","TRACE","TRACK"])){throw new h.DOMException(h.DOMException.SECURITY_ERR)}M=b.utf8_encode(M);P=e.parseUrl(M);ak=e.hasSameOrigin(P);ah=e.resolveUrl(M);if((O||N)&&!ak){throw new h.DOMException(h.DOMException.INVALID_ACCESS_ERR)}y=O||P.user;al=N||P.pass;s=L||true;if(s===false&&(q("timeout")||q("withCredentials")||q("responseType")!=="")){throw new h.DOMException(h.DOMException.INVALID_ACCESS_ERR)}ar=!s;aq=false;A={};ae.call(this);q("readyState",d.OPENED);this.dispatchEvent("readystatechange")},setRequestHeader:function(K,L){var M=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(q("readyState")!==d.OPENED||aq){throw new h.DOMException(h.DOMException.INVALID_STATE_ERR)}if(/[\u0100-\uffff]/.test(K)||b.utf8_encode(K)!==K){throw new h.DOMException(h.DOMException.SYNTAX_ERR)}K=x.trim(K).toLowerCase();if(!!~x.inArray(K,M)||/^(proxy\-|sec\-)/.test(K)){return false}if(!A[K]){A[K]=L}else{A[K]+=", "+L}return true},getAllResponseHeaders:function(){return v||""},getResponseHeader:function(K){K=K.toLowerCase();if(ao||!!~x.inArray(K,["set-cookie","set-cookie2"])){return null}if(v&&v!==""){if(!ap){ap={};x.each(v.split(/\r\n/),function(M){var L=M.split(/:\s+/);if(L.length===2){L[0]=x.trim(L[0]);ap[L[0].toLowerCase()]={header:L[0],value:x.trim(L[1])}}})}if(ap.hasOwnProperty(K)){return ap[K].header+": "+ap[K].value}}return null},overrideMimeType:function(L){var M,K;if(!!~x.inArray(q("readyState"),[d.LOADING,d.DONE])){throw new h.DOMException(h.DOMException.INVALID_STATE_ERR)}L=x.trim(L.toLowerCase());if(/;/.test(L)&&(M=L.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))){L=M[1];if(M[2]){K=M[2]}}if(!f.mimes[L]){throw new h.DOMException(h.DOMException.SYNTAX_ERR)}u=L;r=K},send:function(K,L){if(x.typeOf(L)==="string"){w={ruid:L}}else{if(!L){w={}}else{w=L}}if(this.readyState!==d.OPENED||aq){throw new h.DOMException(h.DOMException.INVALID_STATE_ERR)}if(K instanceof E){w.ruid=K.ruid;ag=K.type||"application/octet-stream"}else{if(K instanceof a){if(K.hasBlob()){var M=K.getBlob();w.ruid=M.ruid;ag=M.type||"application/octet-stream"}}else{if(typeof K==="string"){ai="UTF-8";ag="text/plain;charset=UTF-8";K=b.utf8_encode(K)}}}if(!this.withCredentials){this.withCredentials=(w.required_caps&&w.required_caps.send_browser_cookies)&&!ak}aj=(!ar&&this.upload.hasEventListener());ao=false;af=!K;if(!ar){aq=true}am.call(this,K)},abort:function(){ao=true;ar=false;if(!~x.inArray(q("readyState"),[d.UNSENT,d.OPENED,d.DONE])){q("readyState",d.DONE);aq=false;if(ac){ac.getRuntime().exec.call(ac,"XMLHttpRequest","abort",af)}else{throw new h.DOMException(h.DOMException.INVALID_STATE_ERR)}af=true}else{q("readyState",d.UNSENT)}},destroy:function(){if(ac){if(x.typeOf(ac.destroy)==="function"){ac.destroy()}ac=null}this.unbindAll();if(this.upload){this.upload.unbindAll();this.upload=null}}});this.handleEventProps(G.concat(["readystatechange"]));this.upload.handleEventProps(G);function q(K,L){if(!an.hasOwnProperty(K)){return}if(arguments.length===1){return J.can("define_property")?an[K]:z[K]}else{if(J.can("define_property")){an[K]=L}else{z[K]=L}}}function am(K){var M=this;ad=new Date().getTime();ac=new g();function L(){if(ac){ac.destroy();ac=null}M.dispatchEvent("loadend");M=null}function N(O){ac.bind("LoadStart",function(P){q("readyState",d.LOADING);M.dispatchEvent("readystatechange");M.dispatchEvent(P);if(aj){M.upload.dispatchEvent(P)}});ac.bind("Progress",function(P){if(q("readyState")!==d.LOADING){q("readyState",d.LOADING);M.dispatchEvent("readystatechange")}M.dispatchEvent(P)});ac.bind("UploadProgress",function(P){if(aj){M.upload.dispatchEvent({type:"progress",lengthComputable:false,total:P.total,loaded:P.loaded})}});ac.bind("Load",function(P){q("readyState",d.DONE);q("status",Number(O.exec.call(ac,"XMLHttpRequest","getStatus")||0));q("statusText",I[q("status")]||"");q("response",O.exec.call(ac,"XMLHttpRequest","getResponse",q("responseType")));if(!!~x.inArray(q("responseType"),["text",""])){q("responseText",q("response"))}else{if(q("responseType")==="document"){q("responseXML",q("response"))}}v=O.exec.call(ac,"XMLHttpRequest","getAllResponseHeaders");M.dispatchEvent("readystatechange");if(q("status")>0){if(aj){M.upload.dispatchEvent(P)}M.dispatchEvent(P)}else{ao=true;M.dispatchEvent("error")}L()});ac.bind("Abort",function(P){M.dispatchEvent(P);L()});ac.bind("Error",function(P){ao=true;q("readyState",d.DONE);M.dispatchEvent("readystatechange");af=true;M.dispatchEvent(P);L()});O.exec.call(ac,"XMLHttpRequest","send",{url:ah,method:ab,async:s,user:y,password:al,headers:A,mimeType:ag,encoding:ai,responseType:M.responseType,withCredentials:M.withCredentials,options:w},K)}if(typeof(w.required_caps)==="string"){w.required_caps=D.parseCaps(w.required_caps)}w.required_caps=x.extend({},w.required_caps,{return_response_type:M.responseType});if(K instanceof a){w.required_caps.send_multipart=true}if(!x.isEmptyObj(A)){w.required_caps.send_custom_headers=true}if(!ak){w.required_caps.do_cors=true}if(w.ruid){N(ac.connectRuntime(w))}else{ac.bind("RuntimeInit",function(O,P){N(P)});ac.bind("RuntimeError",function(O,P){M.dispatchEvent("RuntimeError",P)});ac.connectRuntime(w)}}function ae(){q("responseText","");q("responseXML",null);q("response",null);q("status",0);q("statusText","");ad=t=null}}d.UNSENT=0;d.OPENED=1;d.HEADERS_RECEIVED=2;d.LOADING=3;d.DONE=4;d.prototype=C.instance;return d});k("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(b,e,d,a){function c(){var f,h,x,B,y,z;d.call(this);b.extend(this,{uid:b.guid("uid_"),state:c.IDLE,result:null,transport:function(r,t,u){var q=this;u=b.extend({chunk_size:204798},u);if((f=u.chunk_size%3)){u.chunk_size+=3-f}z=u.chunk_size;A.call(this);x=r;B=r.length;if(b.typeOf(u)==="string"||u.ruid){g.call(q,t,this.connectRuntime(u))}else{var s=function(v,D){q.unbind("RuntimeInit",s);g.call(q,t,D)};this.bind("RuntimeInit",s);this.connectRuntime(u)}},abort:function(){var q=this;q.state=c.IDLE;if(h){h.exec.call(q,"Transporter","clear");q.trigger("TransportingAborted")}A.call(q)},destroy:function(){this.unbindAll();h=null;this.disconnectRuntime();A.call(this)}});function A(){B=y=0;x=this.result=null}function g(q,s){var r=this;h=s;r.bind("TransportingProgress",function(t){y=t.loaded;if(y<B&&b.inArray(r.state,[c.IDLE,c.DONE])===-1){w.call(r)}},999);r.bind("TransportingComplete",function(){y=B;r.state=c.DONE;x=null;r.result=h.exec.call(r,"Transporter","getAsBlob",q||"")},999);r.state=c.BUSY;r.trigger("TransportingStarted");w.call(r)}function w(){var r=this,q,s=B-y;if(z>s){z=s}q=e.btoa(x.substr(y,z));h.exec.call(r,"Transporter","receive",q,B)}}c.IDLE=0;c.BUSY=1;c.DONE=2;c.prototype=a.instance;return c});k("moxie/image/Image",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/file/FileReaderSync","moxie/xhr/XMLHttpRequest","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/runtime/Transporter","moxie/core/utils/Env","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/core/utils/Encode"],function(h,e,C,a,B,x,D,f,b,z,g,c,d){var A=["progress","load","error","resize","embedded"];function y(){D.call(this);h.extend(this,{uid:h.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){s.apply(this,arguments)},downsize:function(w){var v={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:false,preserveHeaders:true,resample:false};if(typeof(w)==="object"){w=h.extend(v,w)}else{w=h.extend(v,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]})}try{if(!this.size){throw new C.DOMException(C.DOMException.INVALID_STATE_ERR)}if(this.width>y.MAX_RESIZE_WIDTH||this.height>y.MAX_RESIZE_HEIGHT){throw new C.ImageError(C.ImageError.MAX_RESOLUTION_ERR)}this.exec("Image","downsize",w.width,w.height,w.crop,w.preserveHeaders)}catch(F){this.trigger("error",F.code)}},crop:function(v,F,w){this.downsize(v,F,true,w)},getAsCanvas:function(){if(!b.can("create_canvas")){throw new C.RuntimeError(C.RuntimeError.NOT_SUPPORTED_ERR)}var v=this.connectRuntime(this.ruid);return v.exec.call(this,"Image","getAsCanvas")},getAsBlob:function(w,v){if(!this.size){throw new C.DOMException(C.DOMException.INVALID_STATE_ERR)}return this.exec("Image","getAsBlob",w||"image/jpeg",v||90)},getAsDataURL:function(w,v){if(!this.size){throw new C.DOMException(C.DOMException.INVALID_STATE_ERR)}return this.exec("Image","getAsDataURL",w||"image/jpeg",v||90)},getAsBinaryString:function(F,v){var w=this.getAsDataURL(F,v);return d.atob(w.substring(w.indexOf("base64,")+7))},embed:function(J,v){var M=this,w;v=h.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90},v||{});function K(E,H){var G=this;if(b.can("create_canvas")){var F=G.getAsCanvas();if(F){J.appendChild(F);F=null;G.destroy();M.trigger("embedded");return}}var I=G.getAsDataURL(E,H);if(!I){throw new C.ImageError(C.ImageError.WRONG_FORMAT)}if(b.can("use_data_uri_of",I.length)){J.innerHTML='<img src="'+I+'" width="'+G.width+'" height="'+G.height+'" />';G.destroy();M.trigger("embedded")}else{var P=new f();P.bind("TransportingComplete",function(){w=M.connectRuntime(this.result.ruid);M.bind("Embedded",function(){h.extend(w.getShimContainer().style,{top:"0px",left:"0px",width:G.width+"px",height:G.height+"px"});w=null},999);w.exec.call(M,"ImageView","display",this.result.uid,width,height);G.destroy()});P.transport(d.atob(I.substring(I.indexOf("base64,")+7)),E,{required_caps:{display_media:true},runtime_order:"flash,silverlight",container:J})}}try{if(!(J=e.get(J))){throw new C.DOMException(C.DOMException.INVALID_NODE_TYPE_ERR)}if(!this.size){throw new C.DOMException(C.DOMException.INVALID_STATE_ERR)}if(this.width>y.MAX_RESIZE_WIDTH||this.height>y.MAX_RESIZE_HEIGHT){}var N=new y();N.bind("Resize",function(){K.call(this,v.type,v.quality)});N.bind("Load",function(){N.downsize(v)});if(this.meta.thumb&&this.meta.thumb.width>=v.width&&this.meta.thumb.height>=v.height){N.load(this.meta.thumb.data)}else{N.clone(this,false)}return N}catch(L){this.trigger("error",L.code)}},destroy:function(){if(this.ruid){this.getRuntime().exec.call(this,"Image","destroy");this.disconnectRuntime()}this.unbindAll()}});this.handleEventProps(A);this.bind("Load Resize",function(){u.call(this)},999);function u(v){if(!v){v=this.exec("Image","getInfo")}if(v.meta&&v.meta.thumb&&!(v.meta.thumb.data instanceof g)){v.meta.thumb.data=new g(this.ruid,{type:"image/jpeg",data:v.meta.thumb.data})}this.size=v.size;this.width=v.width;this.height=v.height;this.type=v.type;this.meta=v.meta;if(this.name===""){this.name=v.name}}function s(v){var w=h.typeOf(v);try{if(v instanceof y){if(!v.size){throw new C.DOMException(C.DOMException.INVALID_STATE_ERR)}r.apply(this,arguments)}else{if(v instanceof g){if(!~h.inArray(v.type,["image/jpeg","image/png"])){throw new C.ImageError(C.ImageError.WRONG_FORMAT)}q.apply(this,arguments)}else{if(h.inArray(w,["blob","file"])!==-1){s.call(this,new c(null,v),arguments[1])}else{if(w==="string"){if(/^data:[^;]*;base64,/.test(v)){s.call(this,new g(null,{data:v}),arguments[1])}else{t.apply(this,arguments)}}else{if(w==="node"&&v.nodeName.toLowerCase()==="img"){s.call(this,v.src,arguments[1])}else{throw new C.DOMException(C.DOMException.TYPE_MISMATCH_ERR)}}}}}}catch(F){this.trigger("error",F.code)}}function r(F,w){var v=this.connectRuntime(F.ruid);this.ruid=v.uid;v.exec.call(this,"Image","loadFromImage",F,(h.typeOf(w)==="undefined"?true:w))}function q(w,v){var G=this;G.name=w.name||"";function H(E){G.ruid=E.uid;E.exec.call(G,"Image","loadFromBlob",w)}if(w.isDetached()){this.bind("RuntimeInit",function(E,F){H(F)});if(v&&typeof(v.required_caps)==="string"){v.required_caps=x.parseCaps(v.required_caps)}this.connectRuntime(h.extend({required_caps:{access_image_binary:true,resize_image:true}},v))}else{H(this.connectRuntime(w.ruid))}}function t(w,G){var H=this,v;v=new B();v.open("get",w);v.responseType="blob";v.onprogress=function(E){H.trigger(E)};v.onload=function(){q.call(H,v.response,true)};v.onerror=function(E){H.trigger(E)};v.onloadend=function(){v.destroy()};v.bind("RuntimeError",function(E,F){H.trigger("RuntimeError",F)});v.send(null,G)}}y.MAX_RESIZE_WIDTH=8192;y.MAX_RESIZE_HEIGHT=8192;y.prototype=z.instance;return y});k("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(g,e,c,d){var a="html5",b={};function f(w){var x=this,h=c.capTest,u=c.capTrue;var v=g.extend({access_binary:h(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return x.can("access_binary")&&!!b.Image},display_media:h(d.can("create_canvas")||d.can("use_data_uri_over32kb")),do_cors:h(window.XMLHttpRequest&&"withCredentials" in new XMLHttpRequest()),drag_and_drop:h(function(){var q=document.createElement("div");return(("draggable" in q)||("ondragstart" in q&&"ondrop" in q))&&(d.browser!=="IE"||d.verComp(d.version,9,">"))}()),filter_by_extension:h(function(){return(d.browser==="Chrome"&&d.verComp(d.version,28,">="))||(d.browser==="IE"&&d.verComp(d.version,10,">="))||(d.browser==="Safari"&&d.verComp(d.version,7,">="))}()),return_response_headers:u,return_response_type:function(q){if(q==="json"&&!!window.JSON){return true}return d.can("return_response_type",q)},return_status_code:u,report_upload_progress:h(window.XMLHttpRequest&&new XMLHttpRequest().upload),resize_image:function(){return x.can("access_binary")&&d.can("create_canvas")},select_file:function(){return d.can("use_fileinput")&&window.File},select_folder:function(){return x.can("select_file")&&d.browser==="Chrome"&&d.verComp(d.version,21,">=")},select_multiple:function(){return x.can("select_file")&&!(d.browser==="Safari"&&d.os==="Windows")&&!(d.os==="iOS"&&d.verComp(d.osVersion,"7.0.0",">")&&d.verComp(d.osVersion,"8.0.0","<"))},send_binary_string:h(window.XMLHttpRequest&&(new XMLHttpRequest().sendAsBinary||(window.Uint8Array&&window.ArrayBuffer))),send_custom_headers:h(window.XMLHttpRequest),send_multipart:function(){return !!(window.XMLHttpRequest&&new XMLHttpRequest().upload&&window.FormData)||x.can("send_binary_string")},slice_blob:h(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return x.can("slice_blob")&&x.can("send_multipart")},summon_file_dialog:function(){return x.can("select_file")&&((d.browser==="Firefox"&&d.verComp(d.version,4,">="))||(d.browser==="Opera"&&d.verComp(d.version,12,">="))||(d.browser==="IE"&&d.verComp(d.version,10,">="))||!!~g.inArray(d.browser,["Chrome","Safari"]))},upload_filesize:u},arguments[2]);c.call(this,w,(arguments[1]||a),v);g.extend(this,{init:function(){this.trigger("Init")},destroy:(function(q){return function(){q.call(x);q=x=null}}(this.destroy))});g.extend(this.getShim(),b)}c.addConstructor(a,f);return b});k("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(g){var f={},b="moxie_"+g.guid();function c(){this.returnValue=false}function d(){this.cancelBubble=true}var a=function(x,B,w,z){var y,A;B=B.toLowerCase();if(x.addEventListener){y=w;x.addEventListener(B,y,false)}else{if(x.attachEvent){y=function(){var q=window.event;if(!q.target){q.target=q.srcElement}q.preventDefault=c;q.stopPropagation=d;w(q)};x.attachEvent("on"+B,y)}}if(!x[b]){x[b]=g.guid()}if(!f.hasOwnProperty(x[b])){f[x[b]]={}}A=f[x[b]];if(!A.hasOwnProperty(B)){A[B]=[]}A[B].push({func:y,orig:w,key:z})};var h=function(y,D,x){var A,B;D=D.toLowerCase();if(y[b]&&f[y[b]]&&f[y[b]][D]){A=f[y[b]][D]}else{return}for(var C=A.length-1;C>=0;C--){if(A[C].orig===x||A[C].key===x){if(y.removeEventListener){y.removeEventListener(D,A[C].func,false)}else{if(y.detachEvent){y.detachEvent("on"+D,A[C].func)}}A[C].orig=null;A[C].func=null;A.splice(C,1);if(x!==B){break}}}if(!A.length){delete f[y[b]][D]}if(g.isEmptyObj(f[y[b]])){delete f[y[b]];try{delete y[b]}catch(z){y[b]=B}}};var e=function(s,t){if(!s||!s[b]){return}g.each(f[s[b]],function(q,r){h(s,r,t)})};return{addEvent:a,removeEvent:h,removeAllEvents:e}});k("moxie/runtime/html5/file/FileInput",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(h,c,f,a,d,b,e){function g(){var r;f.extend(this,{init:function(B){var q=this,D=q.getRuntime(),E,I,H,C,F,G;r=B;H=r.accept.mimes||b.extList2mimes(r.accept,D.can("filter_by_extension"));I=D.getShimContainer();I.innerHTML='<input id="'+D.uid+'" type="file" style="font-size:999px;opacity:0;"'+(r.multiple&&D.can("select_multiple")?"multiple":"")+(r.directory&&D.can("select_folder")?"webkitdirectory directory":"")+(H?' accept="'+H.join(",")+'"':"")+" />";E=a.get(D.uid);f.extend(E.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});C=a.get(r.browse_button);if(D.can("summon_file_dialog")){if(a.getStyle(C,"position")==="static"){C.style.position="relative"}F=parseInt(a.getStyle(C,"z-index"),10)||1;C.style.zIndex=F;I.style.zIndex=F-1;d.addEvent(C,"click",function(s){var t=a.get(D.uid);if(t&&!t.disabled){t.click()}s.preventDefault()},q.uid)}G=D.can("summon_file_dialog")?C:I;d.addEvent(G,"mouseover",function(){q.trigger("mouseenter")},q.uid);d.addEvent(G,"mouseout",function(){q.trigger("mouseleave")},q.uid);d.addEvent(G,"mousedown",function(){q.trigger("mousedown")},q.uid);d.addEvent(a.get(r.container),"mouseup",function(){q.trigger("mouseup")},q.uid);E.onchange=function J(t){q.files=[];f.each(this.files,function(u){var v="";if(r.directory){if(u.name=="."){return true}}if(u.webkitRelativePath){v="/"+u.webkitRelativePath.replace(/^\//,"")}u=new c(D.uid,u);u.relativePath=v;q.files.push(u)});if(e.browser!=="IE"&&e.browser!=="IEMobile"){this.value=""}else{var s=this.cloneNode(true);this.parentNode.replaceChild(s,this);s.onchange=J}if(q.files.length){q.trigger("change")}};q.trigger({type:"ready",async:true});I=null},disable:function(q){var u=this.getRuntime(),v;if((v=a.get(u.uid))){v.disabled=!!q}},destroy:function(){var u=this.getRuntime(),q=u.getShim(),v=u.getShimContainer();d.removeAllEvents(v,this.uid);d.removeAllEvents(r&&a.get(r.container),this.uid);d.removeAllEvents(r&&a.get(r.browse_button),this.uid);if(v){v.innerHTML=""}q.removeInstance(this.uid);r=v=q=null}})}return(h.FileInput=g)});k("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(b,a){function c(){function d(r,f,e){var h;if(window.File.prototype.slice){try{r.slice();return r.slice(f,e)}catch(g){return r.slice(f,e-f)}}else{if((h=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)){return h.call(r,f,e)}else{return null}}}this.slice=function(){return new a(this.getRuntime().uid,d.apply(this,arguments))}}return(b.Blob=c)});k("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(a,d,g,b,e,c){function f(){var h=[],J=[],E,I;g.extend(this,{init:function(r){var s=this,q;E=r;I=s.ruid;J=K(E.accept);q=E.container;e.addEvent(q,"dragover",function(t){if(!L(t)){return}t.preventDefault();t.dataTransfer.dropEffect="copy"},s.uid);e.addEvent(q,"drop",function(t){if(!L(t)){return}t.preventDefault();h=[];if(t.dataTransfer.items&&t.dataTransfer.items[0].webkitGetAsEntry){F(t.dataTransfer.items,function(){s.files=h;s.trigger("drop")})}else{g.each(t.dataTransfer.files,function(u){B(u)});s.files=h;s.trigger("drop")}},s.uid);e.addEvent(q,"dragenter",function(t){s.trigger("dragenter")},s.uid);e.addEvent(q,"dragleave",function(t){s.trigger("dragleave")},s.uid)},destroy:function(){e.removeAllEvents(E&&b.get(E.container),this.uid);I=h=J=E=null}});function L(q){if(!q.dataTransfer||!q.dataTransfer.types){return false}var r=g.toArray(q.dataTransfer.types||[]);return g.inArray("Files",r)!==-1||g.inArray("public.file-url",r)!==-1||g.inArray("application/x-moz-file",r)!==-1}function B(r,s){if(G(r)){var q=new d(I,r);q.relativePath=s||"";h.push(q)}}function K(q){var r=[];for(var s=0;s<q.length;s++){[].push.apply(r,q[s].extensions.split(/\s*,\s*/))}return g.inArray("*",r)===-1?r:[]}function G(r){if(!J.length){return true}var q=c.getFileExtension(r.name);return !q||g.inArray(q,J)!==-1}function F(q,r){var s=[];g.each(q,function(t){var u=t.webkitGetAsEntry();if(u){if(u.isFile){B(t.getAsFile(),u.fullPath)}else{s.push(u)}}});if(s.length){H(s,r)}else{r()}}function H(q,r){var s=[];g.each(q,function(t){s.push(function(u){C(t,u)})});g.inSeries(s,function(){r()})}function C(q,r){if(q.isFile){q.file(function(s){B(s,q.fullPath);r()},function(){r()})}else{if(q.isDirectory){D(q,r)}else{r()}}}function D(q,t){var u=[],r=q.createReader();function s(v){r.readEntries(function(w){if(w.length){[].push.apply(u,w);s(v)}else{v()}},v)}s(function(){H(u,t)})}}return(a.FileDrop=f)});k("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(c,d,a){function b(){var g,f=false;a.extend(this,{read:function(h,s){var t=this;t.result="";g=new window.FileReader();g.addEventListener("progress",function(q){t.trigger(q)});g.addEventListener("load",function(q){t.result=f?e(g.result):g.result;t.trigger(q)});g.addEventListener("error",function(q){t.trigger(q,g.error)});g.addEventListener("loadend",function(q){g=null;t.trigger(q)});if(a.typeOf(g[h])==="function"){f=false;g[h](s.getSource())}else{if(h==="readAsBinaryString"){f=true;g.readAsDataURL(s.getSource())}}},abort:function(){if(g){g.abort()}},destroy:function(){g=null}});function e(h){return d.atob(h.substring(h.indexOf("base64,")+7))}}return(c.FileReader=b)});k("moxie/runtime/html5/xhr/XMLHttpRequest",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Url","moxie/file/File","moxie/file/Blob","moxie/xhr/FormData","moxie/core/Exceptions","moxie/core/utils/Env"],function(d,s,g,t,e,h,a,c,f){function b(){var A=this,D,r;s.extend(this,{send:function(v,y){var w=this,I=(f.browser==="Mozilla"&&f.verComp(f.version,4,">=")&&f.verComp(f.version,7,"<")),H=f.browser==="Android Browser",x=false;r=v.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase();D=q();D.open(v.method,v.url,v.async,v.user,v.password);if(y instanceof h){if(y.isDetached()){x=true}y=y.getSource()}else{if(y instanceof a){if(y.hasBlob()){if(y.getBlob().isDetached()){y=z.call(w,y);x=true}else{if((I||H)&&s.typeOf(y.getBlob().getSource())==="blob"&&window.FileReader){C.call(w,v,y);return}}}if(y instanceof a){var J=new window.FormData();y.each(function(E,F){if(E instanceof h){J.append(F,E.getSource())}else{J.append(F,E)}});y=J}}}if(D.upload){if(v.withCredentials){D.withCredentials=true}D.addEventListener("load",function(E){w.trigger(E)});D.addEventListener("error",function(E){w.trigger(E)});D.addEventListener("progress",function(E){w.trigger(E)});D.upload.addEventListener("progress",function(E){w.trigger({type:"UploadProgress",loaded:E.loaded,total:E.total})})}else{D.onreadystatechange=function u(){switch(D.readyState){case 1:break;case 2:break;case 3:var E,G;try{if(t.hasSameOrigin(v.url)){E=D.getResponseHeader("Content-Length")||0}if(D.responseText){G=D.responseText.length}}catch(F){E=G=0}w.trigger({type:"progress",lengthComputable:!!E,total:parseInt(E,10),loaded:G});break;case 4:D.onreadystatechange=function(){};if(D.status===0){w.trigger("error")}else{w.trigger("load")}break}}}if(!s.isEmptyObj(v.headers)){s.each(v.headers,function(F,E){D.setRequestHeader(E,F)})}if(""!==v.responseType&&"responseType" in D){if("json"===v.responseType&&!f.can("return_response_type","json")){D.responseType="text"}else{D.responseType=v.responseType}}if(!x){D.send(y)}else{if(D.sendAsBinary){D.sendAsBinary(y)}else{(function(){var F=new Uint8Array(y.length);for(var E=0;E<y.length;E++){F[E]=(y.charCodeAt(E)&255)}D.send(F.buffer)}())}}w.trigger("loadstart")},getStatus:function(){try{if(D){return D.status}}catch(u){}return 0},getResponse:function(F){var u=this.getRuntime();try{switch(F){case"blob":var w=new e(u.uid,D.response);var v=D.getResponseHeader("Content-Disposition");if(v){var y=v.match(/filename=([\'\"'])([^\1]+)\1/);if(y){r=y[2]}}w.name=r;if(!w.type){w.type=g.getFileMime(r)}return w;case"json":if(!f.can("return_response_type","json")){return D.status===200&&!!window.JSON?JSON.parse(D.responseText):null}return D.response;case"document":return B(D);default:return D.responseText!==""?D.responseText:null}}catch(x){return null}},getAllResponseHeaders:function(){try{return D.getAllResponseHeaders()}catch(u){}return""},abort:function(){if(D){D.abort()}},destroy:function(){A=r=null}});function C(v,y){var x=this,u,w;u=y.getBlob().getSource();w=new window.FileReader();w.onload=function(){y.append(y.getBlobName(),new h(null,{type:u.type,data:w.result}));A.send.call(x,v,y)};w.readAsBinaryString(u)}function q(){if(window.XMLHttpRequest&&!(f.browser==="IE"&&f.verComp(f.version,8,"<"))){return new window.XMLHttpRequest()}else{return(function(){var v=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"];for(var w=0;w<v.length;w++){try{return new ActiveXObject(v[w])}catch(u){}}})()}}function B(u){var w=u.responseXML;var v=u.responseText;if(f.browser==="IE"&&v&&w&&!w.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(u.getResponseHeader("Content-Type"))){w=new window.ActiveXObject("Microsoft.XMLDOM");w.async=false;w.validateOnParse=false;w.loadXML(v)}if(w){if((f.browser==="IE"&&w.parseError!==0)||!w.documentElement||w.documentElement.tagName==="parsererror"){return null}}return w}function z(F){var v="----moxieboundary"+new Date().getTime(),y="--",w="\r\n",x="",u=this.getRuntime();if(!u.can("send_binary_string")){throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR)}D.setRequestHeader("Content-Type","multipart/form-data; boundary="+v);F.each(function(E,H){if(E instanceof h){x+=y+v+w+'Content-Disposition: form-data; name="'+H+'"; filename="'+unescape(encodeURIComponent(E.name||"blob"))+'"'+w+"Content-Type: "+(E.type||"application/octet-stream")+w+w+E.getSource()+w}else{x+=y+v+w+'Content-Disposition: form-data; name="'+H+'"'+w+w+unescape(encodeURIComponent(E))+w}});x+=y+v+y+w;return x}}return(d.XMLHttpRequest=b)});k("moxie/runtime/html5/utils/BinaryReader",["moxie/core/utils/Basic"],function(b){function c(e){if(e instanceof ArrayBuffer){d.apply(this,arguments)}else{a.apply(this,arguments)}}b.extend(c.prototype,{littleEndian:false,read:function(r,g){var f,e,h;if(r+g>this.length()){throw new Error("You are trying to read outside the source boundaries.")}e=this.littleEndian?0:-8*(g-1);for(h=0,f=0;h<g;h++){f|=(this.readByteAt(r+h)<<Math.abs(e+h*8))}return f},write:function(t,s,g){var e,h,f="";if(t>this.length()){throw new Error("You are trying to write outside the source boundaries.")}e=this.littleEndian?0:-8*(g-1);for(h=0;h<g;h++){this.writeByteAt(t+h,(s>>Math.abs(e+h*8))&255)}},BYTE:function(e){return this.read(e,1)},SHORT:function(e){return this.read(e,2)},LONG:function(e){return this.read(e,4)},SLONG:function(e){var f=this.read(e,4);return(f>2147483647?f-4294967296:f)},CHAR:function(e){return String.fromCharCode(this.read(e,1))},STRING:function(e,f){return this.asArray("CHAR",e,f).join("")},asArray:function(g,e,f){var r=[];for(var h=0;h<f;h++){r[h]=this[g](e+h)}return r}});function d(e){var f=new DataView(e);b.extend(this,{readByteAt:function(g){return f.getUint8(g)},writeByteAt:function(h,g){f.setUint8(h,g)},SEGMENT:function(s,h,g){switch(arguments.length){case 2:return e.slice(s,s+h);case 1:return e.slice(s);case 3:if(g===null){g=new ArrayBuffer()}if(g instanceof ArrayBuffer){var t=new Uint8Array(this.length()-h+g.byteLength);if(s>0){t.set(new Uint8Array(e.slice(0,s)),0)}t.set(new Uint8Array(g),s);t.set(new Uint8Array(e.slice(s+h)),s+g.byteLength);this.clear();e=t.buffer;f=new DataView(e);break}default:return e}},length:function(){return e?e.byteLength:0},clear:function(){f=e=null}})}function a(f){b.extend(this,{readByteAt:function(g){return f.charCodeAt(g)},writeByteAt:function(h,g){e(String.fromCharCode(g),h,1)},SEGMENT:function(r,g,h){switch(arguments.length){case 1:return f.substr(r);case 2:return f.substr(r,g);case 3:e(h!==null?h:"",r,g);break;default:return f}},length:function(){return f?f.length:0},clear:function(){f=null}});function e(g,r,h){h=arguments.length===3?h:f.length-r-1;f=f.substr(0,r)+g+f.substr(h+r)}}return c});k("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(a,c){return function b(h){var f=[],g,e,d,r=0;g=new a(h);if(g.SHORT(0)!==65496){g.clear();throw new c.ImageError(c.ImageError.WRONG_FORMAT)}e=2;while(e<=g.length()){d=g.SHORT(e);if(d>=65488&&d<=65495){e+=2;continue}if(d===65498||d===65497){break}r=g.SHORT(e+2)+2;if(d>=65505&&d<=65519){f.push({hex:d,name:"APP"+(d&15),start:e,length:r,segment:g.SEGMENT(e,r)})}e+=r}g.clear();return{headers:f,restore:function(q){var x,v,w;w=new a(q);e=w.SHORT(2)==65504?4+w.SHORT(4):2;for(v=0,x=f.length;v<x;v++){w.SEGMENT(e,0,f[v].segment);e+=f[v].length}q=w.SEGMENT();w.clear();return q},strip:function(w){var x,q,z,y;z=new b(w);q=z.headers;z.purge();x=new a(w);y=q.length;while(y--){x.SEGMENT(q[y].start,q[y].length,"")}w=x.SEGMENT();x.clear();return w},get:function(w){var q=[];for(var v=0,x=f.length;v<x;v++){if(f[v].name===w.toUpperCase()){q.push(f[v].segment)}}return q},set:function(A,x){var q=[],z,y,B;if(typeof(x)==="string"){q.push(x)}else{q=x}for(z=y=0,B=f.length;z<B;z++){if(f[z].name===A.toUpperCase()){f[z].segment=q[y];f[z].length=q[y].length;y++}if(y>=q.length){break}}},purge:function(){this.headers=f=[]}}}});k("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(a,b,d){function c(g){var A,z,f,h,B,y;b.call(this,g);z={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}};f={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};h={tiffHeader:10};B=h.tiffHeader;A={clear:this.clear};a.extend(this,{read:function(){try{return c.prototype.read.apply(this,arguments)}catch(q){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}},write:function(){try{return c.prototype.write.apply(this,arguments)}catch(q){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}},UNDEFINED:function(){return this.BYTE.apply(this,arguments)},RATIONAL:function(q){return this.LONG(q)/this.LONG(q+4)},SRATIONAL:function(q){return this.SLONG(q)/this.SLONG(q+4)},ASCII:function(q){return this.CHAR(q)},TIFF:function(){return y||null},EXIF:function(){var q=null;if(h.exifIFD){try{q=e.call(this,h.exifIFD,z.exif)}catch(s){return null}if(q.ExifVersion&&a.typeOf(q.ExifVersion)==="array"){for(var t=0,r="";t<q.ExifVersion.length;t++){r+=String.fromCharCode(q.ExifVersion[t])}q.ExifVersion=r}}return q},GPS:function(){var r=null;if(h.gpsIFD){try{r=e.call(this,h.gpsIFD,z.gps)}catch(q){return null}if(r.GPSVersionID&&a.typeOf(r.GPSVersionID)==="array"){r.GPSVersionID=r.GPSVersionID.join(".")}}return r},thumb:function(){if(h.IFD1){try{var r=e.call(this,h.IFD1,z.thumb);if("JPEGInterchangeFormat" in r){return this.SEGMENT(h.tiffHeader+r.JPEGInterchangeFormat,r.JPEGInterchangeFormatLength)}}catch(q){}}return null},setExif:function(r,q){if(r!=="PixelXDimension"&&r!=="PixelYDimension"){return false}return w.call(this,"exif",r,q)},clear:function(){A.clear();g=z=f=y=h=A=null}});if(this.SHORT(0)!==65505||this.STRING(4,5).toUpperCase()!=="EXIF\0"){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}this.littleEndian=(this.SHORT(B)==18761);if(this.SHORT(B+=2)!==42){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}h.IFD0=h.tiffHeader+this.LONG(B+=2);y=e.call(this,h.IFD0,z.tiff);if("ExifIFDPointer" in y){h.exifIFD=h.tiffHeader+y.ExifIFDPointer;delete y.ExifIFDPointer}if("GPSInfoIFDPointer" in y){h.gpsIFD=h.tiffHeader+y.GPSInfoIFDPointer;delete y.GPSInfoIFDPointer}if(a.isEmptyObj(y)){y=null}var x=this.LONG(h.IFD0+this.SHORT(h.IFD0)*12+2);if(x){h.IFD1=h.tiffHeader+x}function e(P,S){var t=this;var N,s,L,T,q,M,v,R,Q=[],u={};var r={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"};var O={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};N=t.SHORT(P);for(s=0;s<N;s++){Q=[];v=P+2+s*12;L=S[t.SHORT(v)];if(L===l){continue}T=r[t.SHORT(v+=2)];q=t.LONG(v+=2);M=O[T];if(!M){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}v+=4;if(M*q>4){v=t.LONG(v)+h.tiffHeader}if(v+M*q>=this.length()){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}if(T==="ASCII"){u[L]=a.trim(t.STRING(v,q).replace(/\0$/,""));continue}else{Q=t.asArray(T,v,q);R=(q==1?Q[0]:Q);if(f.hasOwnProperty(L)&&typeof R!="object"){u[L]=f[L][R]}else{u[L]=R}}}return u}function w(L,J,q){var t,v,H,I=0;if(typeof(J)==="string"){var K=z[L.toLowerCase()];for(var u in K){if(K[u]===J){J=u;break}}}t=h[L.toLowerCase()+"IFD"];v=this.SHORT(t);for(var s=0;s<v;s++){H=t+12*s+2;if(this.SHORT(H)==J){I=H+8;break}}if(!I){return false}try{this.write(I,q,4)}catch(r){return false}return true}}c.prototype=b.prototype;return c});k("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(f,e,c,a,d){function b(y){var h,B,g,z;h=new a(y);if(h.SHORT(0)!==65496){throw new e.ImageError(e.ImageError.WRONG_FORMAT)}B=new c(y);try{g=new d(B.get("app1")[0])}catch(D){}z=A.call(this);f.extend(this,{type:"image/jpeg",size:h.length(),width:z&&z.width||0,height:z&&z.height||0,setExif:function(q,r){if(!g){return false}if(f.typeOf(q)==="object"){f.each(q,function(s,t){g.setExif(t,s)})}else{g.setExif(q,r)}B.set("app1",g.SEGMENT())},writeHeaders:function(){if(!arguments.length){return B.restore(y)}return B.restore(arguments[0])},stripHeaders:function(q){return B.strip(q)},purge:function(){x.call(this)}});if(g){this.meta={tiff:g.TIFF(),exif:g.EXIF(),gps:g.GPS(),thumb:C()}}function A(s){var r=0,t,q;if(!s){s=h}while(r<=s.length()){t=s.SHORT(r+=2);if(t>=65472&&t<=65475){r+=5;return{height:s.SHORT(r),width:s.SHORT(r+=2)}}q=s.SHORT(r+=2);r+=q-2}return null}function C(){var s=g.thumb(),q,r;if(s){q=new a(s);r=A(q);q.clear();if(r){r.data=s;return r}}return null}function x(){if(!g||!B||!h){return}g.clear();B.purge();h.clear();z=B=g=h=null}}return b});k("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(d,a,b){function c(u){var g,x,v,w;g=new b(u);(function(){var s=0,q=0,r=[35152,20039,3338,6666];for(q=0;q<r.length;q++,s+=2){if(r[q]!=g.SHORT(s)){throw new d.ImageError(d.ImageError.WRONG_FORMAT)}}}());function f(){var q,r;q=e.call(this,8);if(q.type=="IHDR"){r=q.start;return{width:g.LONG(r),height:g.LONG(r+=4)}}return null}function h(){if(!g){return}g.clear();u=w=x=v=g=null}w=f.call(this);a.extend(this,{type:"image/png",size:g.length(),width:w.width,height:w.height,purge:function(){h.call(this)}});h.call(this);function e(t){var q,r,z,s;q=g.LONG(t);r=g.STRING(t+=4,4);z=t+=4;s=g.LONG(t+q);return{length:q,type:r,start:z,CRC:s}}}return c});k("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(a,d,b,c){return function(g){var f=[b,c],e;e=(function(){for(var h=0;h<f.length;h++){try{return new f[h](g)}catch(r){}}throw new d.ImageError(d.ImageError.WRONG_FORMAT)}());a.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(h){return h},stripHeaders:function(h){return h},purge:function(){g=null}});a.extend(this,e);this.purge=function(){e.purge();e=null}}});k("moxie/runtime/html5/image/MegaPixel",[],function(){function c(e,W,V){var T=e.naturalWidth,x=e.naturalHeight;var O=V.width,d=V.height;var P=V.x||0,R=V.y||0;var N=W.getContext("2d");if(b(e)){T/=2;x/=2}var h=1024;var X=document.createElement("canvas");X.width=X.height=h;var U=X.getContext("2d");var L=a(e,T,x);var g=0;while(g<x){var f=g+h>x?x-g:h;var S=0;while(S<T){var Q=S+h>T?T-S:h;U.clearRect(0,0,h,h);U.drawImage(e,-S,-g);var K=(S*O/T+P)<<0;var J=Math.ceil(Q*O/T);var M=(g*d/x/L+R)<<0;var y=Math.ceil(f*d/x/L);N.drawImage(X,0,0,Q,f,K,M,J,y);S+=h}g+=h}X=U=null}function b(h){var d=h.naturalWidth,f=h.naturalHeight;if(d*f>1024*1024){var g=document.createElement("canvas");g.width=g.height=1;var e=g.getContext("2d");e.drawImage(h,-d+1,0);return e.getImageData(0,0,1,1).data[3]===0}else{return false}}function a(f,w,z){var x=document.createElement("canvas");x.width=1;x.height=z;var y=x.getContext("2d");y.drawImage(f,0,0);var g=y.getImageData(0,0,1,z).data;var B=0;var e=z;var A=z;while(A>B){var h=g[(A-1)*4+3];if(h===0){e=A}else{B=A}A=(e+B)>>1}x=null;var d=(A/z);return(d===0)?1:d}return{isSubsampled:b,renderTo:c}});k("moxie/runtime/html5/image/Image",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/utils/Encode","moxie/file/Blob","moxie/file/File","moxie/runtime/html5/image/ImageInfo","moxie/runtime/html5/image/MegaPixel","moxie/core/utils/Mime","moxie/core/utils/Env"],function(c,u,b,g,t,e,v,a,h,f){function d(){var q=this,r,S,s,O,W,N=false,U=true;u.extend(this,{loadFromBlob:function(z){var w=this,y=w.getRuntime(),x=arguments.length>1?arguments[1]:true;if(!y.can("access_binary")){throw new b.RuntimeError(b.RuntimeError.NOT_SUPPORTED_ERR)}W=z;if(z.isDetached()){O=z.getSource();K.call(this,O);return}else{T.call(this,z.getSource(),function(A){if(x){O=Q(A)}K.call(w,A)})}},loadFromImage:function(x,w){this.meta=x.meta;W=new e(null,{name:x.name,size:x.size,type:x.type});K.call(this,w?(O=x.getAsBinaryString()):x.getAsDataURL())},getInfo:function(){var x=this.getRuntime(),w;if(!S&&O&&x.can("access_image_binary")){S=new v(O)}w={width:M().width||0,height:M().height||0,type:W.type||h.getFileMime(W.name),size:O&&O.length||W.size||0,name:W.name||"",meta:S&&S.meta||this.meta||{}};return w},downsize:function(){V.apply(this,arguments)},getAsCanvas:function(){if(s){s.id=this.uid+"_canvas"}return s},getAsBlob:function(x,w){if(x!==this.type){V.call(this,this.width,this.height,false)}return new e(null,{name:W.name||"",type:x,data:q.getAsBinaryString.call(this,x,w)})},getAsDataURL:function(w){var y=arguments[1]||90;if(!N){return r.src}if("image/jpeg"!==w){return s.toDataURL("image/png")}else{try{return s.toDataURL("image/jpeg",y/100)}catch(x){return s.toDataURL("image/jpeg")}}},getAsBinaryString:function(w,y){if(!N){if(!O){O=Q(q.getAsDataURL(w,y))}return O}if("image/jpeg"!==w){O=Q(q.getAsDataURL(w,y))}else{var z;if(!y){y=90}try{z=s.toDataURL("image/jpeg",y/100)}catch(x){z=s.toDataURL("image/jpeg")}O=Q(z);if(S){O=S.stripHeaders(O);if(U){if(S.meta&&S.meta.exif){S.setExif({PixelXDimension:this.width,PixelYDimension:this.height})}O=S.writeHeaders(O)}S.purge();S=null}}N=false;return O},destroy:function(){q=null;R.call(this);this.getRuntime().getShim().removeInstance(this.uid)}});function M(){if(!s&&!r){throw new b.ImageError(b.DOMException.INVALID_STATE_ERR)}return s||r}function Q(w){return g.atob(w.substring(w.indexOf("base64,")+7))}function X(w,x){return"data:"+(x||"")+";base64,"+g.btoa(w)}function K(w){var x=this;r=new Image();r.onerror=function(){R.call(this);x.trigger("error",b.ImageError.WRONG_FORMAT)};r.onload=function(){x.trigger("load")};r.src=w.substr(0,5)=="data:"?w:X(w,W.type)}function T(z,y){var w=this,x;if(window.FileReader){x=new FileReader();x.onload=function(){y(this.result)};x.onerror=function(){w.trigger("error",b.ImageError.WRONG_FORMAT)};x.readAsDataURL(z)}else{return y(z.getAsDataURL())}}function V(I,x,C,A){var w=this,F,G,z=0,B=0,D,y,H,J;U=A;J=(this.meta&&this.meta.tiff&&this.meta.tiff.Orientation)||1;if(u.inArray(J,[5,6,7,8])!==-1){var E=I;I=x;x=E}D=M();if(!C){F=Math.min(I/D.width,x/D.height)}else{I=Math.min(I,D.width);x=Math.min(x,D.height);F=Math.max(I/D.width,x/D.height)}if(F>1&&!C&&A){this.trigger("Resize");return}if(!s){s=document.createElement("canvas")}y=Math.round(D.width*F);H=Math.round(D.height*F);if(C){s.width=I;s.height=x;if(y>I){z=Math.round((y-I)/2)}if(H>x){B=Math.round((H-x)/2)}}else{s.width=y;s.height=H}if(!U){L(s.width,s.height,J)}P.call(this,D,s,-z,-B,y,H);this.width=s.width;this.height=s.height;N=true;w.trigger("Resize")}function P(B,A,x,y,C,z){if(f.OS==="iOS"){a.renderTo(B,A,{width:C,height:z,x:x,y:y})}else{var w=A.getContext("2d");w.drawImage(B,x,y,C,z)}}function L(y,x,z){switch(z){case 5:case 6:case 7:case 8:s.width=x;s.height=y;break;default:s.width=y;s.height=x}var w=s.getContext("2d");switch(z){case 2:w.translate(y,0);w.scale(-1,1);break;case 3:w.translate(y,x);w.rotate(Math.PI);break;case 4:w.translate(0,x);w.scale(1,-1);break;case 5:w.rotate(0.5*Math.PI);w.scale(1,-1);break;case 6:w.rotate(0.5*Math.PI);w.translate(0,-x);break;case 7:w.rotate(0.5*Math.PI);w.translate(y,-x);w.scale(-1,1);break;case 8:w.rotate(-0.5*Math.PI);w.translate(-y,0);break}}function R(){if(S){S.purge();S=null}O=r=s=W=null;N=false}}return(c.Image=d)});k("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(t,e,h,b,u){var d="flash",c={};function f(){var s;try{s=navigator.plugins["Shockwave Flash"];s=s.description}catch(q){try{s=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(r){s="0.0"}}s=s.match(/\d+/g);return parseFloat(s[0]+"."+s[1])}function g(q){var r=h.get(q);if(r&&r.nodeName=="OBJECT"){if(e.browser==="IE"){r.style.display="none";(function s(){if(r.readyState==4){v(q)}else{setTimeout(s,10)}})()}else{r.parentNode.removeChild(r)}}}function v(q){var r=h.get(q);if(r){for(var s in r){if(typeof r[s]=="function"){r[s]=null}}r.parentNode.removeChild(r)}}function a(r){var s=this,q;r=t.extend({swf_url:e.swf_url},r);u.call(this,r,d,{access_binary:function(x){return x&&s.mode==="browser"},access_image_binary:function(x){return x&&s.mode==="browser"},display_media:u.capTrue,do_cors:u.capTrue,drag_and_drop:false,report_upload_progress:function(){return s.mode==="client"},resize_image:u.capTrue,return_response_headers:false,return_response_type:function(x){if(x==="json"&&!!window.JSON){return true}return !t.arrayDiff(x,["","text","document"])||s.mode==="browser"},return_status_code:function(x){return s.mode==="browser"||!t.arrayDiff(x,[200,404])},select_file:u.capTrue,select_multiple:u.capTrue,send_binary_string:function(x){return x&&s.mode==="browser"},send_browser_cookies:function(x){return x&&s.mode==="browser"},send_custom_headers:function(x){return x&&s.mode==="browser"},send_multipart:u.capTrue,slice_blob:function(x){return x&&s.mode==="browser"},stream_upload:function(x){return x&&s.mode==="browser"},summon_file_dialog:false,upload_filesize:function(x){return t.parseSizeStr(x)<=2097152||s.mode==="client"},use_http_method:function(x){return !t.arrayDiff(x,["GET","POST"])}},{access_binary:function(x){return x?"browser":"client"},access_image_binary:function(x){return x?"browser":"client"},report_upload_progress:function(x){return x?"browser":"client"},return_response_type:function(x){return t.arrayDiff(x,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(x){return t.arrayDiff(x,[200,404])?"browser":["client","browser"]},send_binary_string:function(x){return x?"browser":"client"},send_browser_cookies:function(x){return x?"browser":"client"},send_custom_headers:function(x){return x?"browser":"client"},stream_upload:function(x){return x?"client":"browser"},upload_filesize:function(x){return t.parseSizeStr(x)>=2097152?"client":"browser"}},"client");if(f()<10){if(MXI_DEBUG&&e.debug.runtime){e.log("\tFlash didn't meet minimal version requirement (10).")}this.mode=false}t.extend(this,{getShim:function(){return h.get(this.uid)},shimExec:function(z,B){var A=[].slice.call(arguments,2);return s.getShim().exec(this.uid,z,B,A)},init:function(){var z,B,A;A=this.getShimContainer();t.extend(A.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});z='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+r.swf_url+'" ';if(e.browser==="IE"){z+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '}z+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+r.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+e.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';if(e.browser==="IE"){B=document.createElement("div");A.appendChild(B);B.outerHTML=z;B=A=null}else{A.innerHTML=z}q=setTimeout(function(){if(s&&!s.initialized){s.trigger("Error",new b.RuntimeError(b.RuntimeError.NOT_INIT_ERR));if(MXI_DEBUG&&e.debug.runtime){e.log("\tFlash failed to initialize within a specified period of time (typically 5s).")}}},5000)},destroy:(function(x){return function(){g(s.uid);x.call(s);clearTimeout(q);r=q=x=s=null}}(this.destroy))},c)}u.addConstructor(d,a);return c});k("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime","moxie/file/File","moxie/core/utils/Basic"],function(c,d,a){var b={init:function(f){var e=this,g=this.getRuntime();this.bind("Change",function(){var h=g.shimExec.call(e,"FileInput","getFiles");e.files=[];a.each(h,function(r){e.files.push(new d(g.uid,r))})},999);this.getRuntime().shimExec.call(this,"FileInput","init",{name:f.name,accept:f.accept,multiple:f.multiple});this.trigger("ready")}};return(c.FileInput=b)});k("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(b,a){var c={slice:function(h,f,e,g){var d=this.getRuntime();if(f<0){f=Math.max(h.size+f,0)}else{if(f>0){f=Math.min(f,h.size)}}if(e<0){e=Math.max(h.size+e,0)}else{if(e>0){e=Math.min(e,h.size)}}h=d.shimExec.call(this,"Blob","slice",f,e,g||"");if(h){h=new a(d.uid,h)}return h}};return(b.Blob=c)});k("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(b,d){function c(e,f){switch(f){case"readAsText":return d.atob(e,"utf8");case"readAsBinaryString":return d.atob(e);case"readAsDataURL":return e}return null}var a={read:function(f,g){var e=this;e.result="";if(f==="readAsDataURL"){e.result="data:"+(g.type||"")+";base64,"}e.bind("Progress",function(h,r){if(r){e.result+=c(r,f)}},999);return e.getRuntime().shimExec.call(this,"FileReader","readAsBase64",g.uid)}};return(b.FileReader=a)});k("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(b,d){function c(e,f){switch(f){case"readAsText":return d.atob(e,"utf8");case"readAsBinaryString":return d.atob(e);case"readAsDataURL":return e}return null}var a={read:function(f,g){var e,h=this.getRuntime();e=h.shimExec.call(this,"FileReaderSync","readAsBase64",g.uid);if(!e){return null}if(f==="readAsDataURL"){e="data:"+(g.type||"")+";base64,"+e}return c(e,f,g.type)}};return(b.FileReaderSync=a)});k("moxie/runtime/flash/xhr/XMLHttpRequest",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/file/File","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/runtime/Transporter"],function(d,a,f,e,g,h,b){var c={send:function(C,H){var F=this,B=F.getRuntime();function z(){C.transport=B.mode;B.shimExec.call(F,"XMLHttpRequest","send",C,H)}function G(q,r){B.shimExec.call(F,"XMLHttpRequest","appendBlob",q,r.uid);H=null;z()}function E(q,r){var s=new b();s.bind("TransportingComplete",function(){r(this.result)});s.transport(q.getSource(),q.type,{ruid:B.uid})}if(!a.isEmptyObj(C.headers)){a.each(C.headers,function(r,q){B.shimExec.call(F,"XMLHttpRequest","setRequestHeader",q,r.toString())})}if(H instanceof h){var D;H.each(function(q,r){if(q instanceof f){D=r}else{B.shimExec.call(F,"XMLHttpRequest","append",r,q)}});if(!H.hasBlob()){H=null;z()}else{var A=H.getBlob();if(A.isDetached()){E(A,function(q){A.destroy();G(D,q)})}else{G(D,A)}}}else{if(H instanceof f){if(H.isDetached()){E(H,function(q){H.destroy();H=q.uid;z()})}else{H=H.uid;z()}}else{z()}}},getResponse:function(u){var x,v,w=this.getRuntime();v=w.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob");if(v){v=new e(w.uid,v);if("blob"===u){return v}try{x=new g();if(!!~a.inArray(u,["","text"])){return x.readAsText(v)}else{if("json"===u&&!!window.JSON){return JSON.parse(x.readAsText(v))}}}finally{v.destroy()}}return null},abort:function(s){var t=this.getRuntime();t.shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}};return(d.XMLHttpRequest=c)});k("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(c,a){var b={getAsBlob:function(f){var d=this.getRuntime(),e=d.shimExec.call(this,"Transporter","getAsBlob",f);if(e){return new a(d.uid,e)}return null}};return(c.Transporter=b)});k("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(d,b,c,f,a){var e={loadFromBlob:function(h){var t=this,u=t.getRuntime();function v(q){u.shimExec.call(t,"Image","loadFromBlob",q.uid);t=u=null}if(h.isDetached()){var g=new c();g.bind("TransportingComplete",function(){v(g.result.getSource())});g.transport(h.getSource(),h.type,{ruid:u.uid})}else{v(h.getSource())}},loadFromImage:function(g){var h=this.getRuntime();return h.shimExec.call(this,"Image","loadFromImage",g.uid)},getAsBlob:function(h,g){var s=this.getRuntime(),t=s.shimExec.call(this,"Image","getAsBlob",h,g);if(t){return new f(s.uid,t)}return null},getAsDataURL:function(){var g=this.getRuntime(),h=g.Image.getAsBlob.apply(this,arguments),r;if(!h){return null}r=new a();return r.readAsDataURL(h)}};return(d.Image=e)});k("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(h,e,f,b,r){var d="silverlight",c={};function a(G){var D=false,K=null,q,N,M,E,L,I=0;try{try{K=new ActiveXObject("AgControl.AgControl");if(K.IsVersionSupported(G)){D=true}K=null}catch(H){var J=navigator.plugins["Silverlight Plug-In"];if(J){q=J.description;if(q==="1.0.30226.2"){q="2.0.30226.2"}N=q.split(".");while(N.length>3){N.pop()}while(N.length<4){N.push(0)}M=G.split(".");while(M.length>4){M.pop()}do{E=parseInt(M[I],10);L=parseInt(N[I],10);I++}while(I<M.length&&E===L);if(E<=L&&!isNaN(E)){D=true}}}}catch(F){D=false}return D}function g(u){var v=this,q;u=h.extend({xap_url:e.xap_url},u);r.call(this,u,d,{access_binary:r.capTrue,access_image_binary:r.capTrue,display_media:r.capTrue,do_cors:r.capTrue,drag_and_drop:false,report_upload_progress:r.capTrue,resize_image:r.capTrue,return_response_headers:function(s){return s&&v.mode==="client"},return_response_type:function(s){if(s!=="json"){return true}else{return !!window.JSON}},return_status_code:function(s){return v.mode==="client"||!h.arrayDiff(s,[200,404])},select_file:r.capTrue,select_multiple:r.capTrue,send_binary_string:r.capTrue,send_browser_cookies:function(s){return s&&v.mode==="browser"},send_custom_headers:function(s){return s&&v.mode==="client"},send_multipart:r.capTrue,slice_blob:r.capTrue,stream_upload:true,summon_file_dialog:false,upload_filesize:r.capTrue,use_http_method:function(s){return v.mode==="client"||!h.arrayDiff(s,["GET","POST"])}},{return_response_headers:function(s){return s?"client":"browser"},return_status_code:function(s){return h.arrayDiff(s,[200,404])?"client":["client","browser"]},send_browser_cookies:function(s){return s?"browser":"client"},send_custom_headers:function(s){return s?"client":"browser"},use_http_method:function(s){return h.arrayDiff(s,["GET","POST"])?"client":["client","browser"]}});if(!a("2.0.31005.0")||e.browser==="Opera"){if(MXI_DEBUG&&e.debug.runtime){e.log("\tSilverlight is not installed or minimal version (2.0.31005.0) requirement not met (not likely).")}this.mode=false}h.extend(this,{getShim:function(){return f.get(this.uid).content.Moxie},shimExec:function(t,s){var x=[].slice.call(arguments,2);return v.getShim().exec(this.uid,t,s,x)},init:function(){var s;s=this.getShimContainer();s.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+u.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+e.global_event_dispatcher+'"/></object>';q=setTimeout(function(){if(v&&!v.initialized){v.trigger("Error",new b.RuntimeError(b.RuntimeError.NOT_INIT_ERR));if(MXI_DEBUG&&e.debug.runtime){e.log("Silverlight failed to initialize within a specified period of time (5-10s).")}}},e.OS!=="Windows"?10000:5000)},destroy:(function(s){return function(){s.call(v);clearTimeout(q);u=q=s=v=null}}(this.destroy))},c)}r.addConstructor(d,g);return c});k("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime","moxie/file/File","moxie/core/utils/Basic"],function(c,d,a){var b={init:function(f){var e=this,g=this.getRuntime();function h(u){var t="";for(var v=0;v<u.length;v++){t+=(t!==""?"|":"")+u[v].title+" | *."+u[v].extensions.replace(/,/g,";*.")}return t}this.bind("Change",function(){var r=g.shimExec.call(e,"FileInput","getFiles");e.files=[];a.each(r,function(q){e.files.push(new d(g.uid,q))})},999);this.getRuntime().shimExec.call(this,"FileInput","init",h(f.accept),f.name,f.multiple);this.trigger("ready")}};return(c.FileInput=b)});k("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(c,b,a){return(c.Blob=b.extend({},a))});k("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(b,c,d){var a={init:function(){var g=this,e=g.getRuntime(),f;f=e.getShimContainer();d.addEvent(f,"dragover",function(h){h.preventDefault();h.stopPropagation();h.dataTransfer.dropEffect="copy"},g.uid);d.addEvent(f,"dragenter",function(h){h.preventDefault();var r=c.get(e.uid).dragEnter(h);if(r){h.stopPropagation()}},g.uid);d.addEvent(f,"drop",function(h){h.preventDefault();var r=c.get(e.uid).dragDrop(h);if(r){h.stopPropagation()}},g.uid);return e.shimExec.call(this,"FileDrop","init")}};return(b.FileDrop=a)});k("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(c,a,b){return(c.FileReader=a.extend({},b))});k("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(c,b,a){return(c.FileReaderSync=b.extend({},a))});k("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(c,a,b){return(c.XMLHttpRequest=a.extend({},b))});k("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(c,a,b){return(c.Transporter=a.extend({},b))});k("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/runtime/flash/image/Image"],function(c,b,a,d){return(c.Image=b.extend({},d,{getInfo:function(){var h=this.getRuntime(),g=["tiff","exif","gps","thumb"],f={meta:{}},e=h.shimExec.call(this,"Image","getInfo");if(e.meta){b.each(g,function(A){var w=e.meta[A],B,z,y,x;if(w&&w.keys){f.meta[A]={};for(z=0,y=w.keys.length;z<y;z++){B=w.keys[z];x=w[B];if(x){if(/^(\d|[1-9]\d+)$/.test(x)){x=parseInt(x,10)}else{if(/^\d*\.\d+$/.test(x)){x=parseFloat(x)}}f.meta[A][B]=x}}}})}f.width=parseInt(e.width,10);f.height=parseInt(e.height,10);f.size=parseInt(e.size,10);f.type=e.type;f.name=e.name;return f}}))});k("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(f,e,b,c){var g="html4",a={};function d(u){var v=this,h=b.capTest,t=b.capTrue;b.call(this,u,g,{access_binary:h(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:false,display_media:h(a.Image&&(c.can("create_canvas")||c.can("use_data_uri_over32kb"))),do_cors:false,drag_and_drop:false,filter_by_extension:h(function(){return(c.browser==="Chrome"&&c.verComp(c.version,28,">="))||(c.browser==="IE"&&c.verComp(c.version,10,">="))||(c.browser==="Safari"&&c.verComp(c.version,7,">="))}()),resize_image:function(){return a.Image&&v.can("access_binary")&&c.can("create_canvas")},report_upload_progress:false,return_response_headers:false,return_response_type:function(q){if(q==="json"&&!!window.JSON){return true}return !!~f.inArray(q,["text","document",""])},return_status_code:function(q){return !f.arrayDiff(q,[200,404])},select_file:function(){return c.can("use_fileinput")},select_multiple:false,send_binary_string:false,send_custom_headers:false,send_multipart:true,slice_blob:false,stream_upload:function(){return v.can("select_file")},summon_file_dialog:function(){return v.can("select_file")&&((c.browser==="Firefox"&&c.verComp(c.version,4,">="))||(c.browser==="Opera"&&c.verComp(c.version,12,">="))||(c.browser==="IE"&&c.verComp(c.version,10,">="))||!!~f.inArray(c.browser,["Chrome","Safari"]))},upload_filesize:t,use_http_method:function(q){return !f.arrayDiff(q,["GET","POST"])}});f.extend(this,{init:function(){this.trigger("Init")},destroy:(function(q){return function(){q.call(v);q=v=null}}(this.destroy))});f.extend(this.getShim(),a)}b.addConstructor(g,d);return a});k("moxie/runtime/html4/file/FileInput",["moxie/runtime/html4/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(h,c,f,a,d,b,e){function g(){var v,u=[],x;function w(){var s=this,D=s.getRuntime(),F,r,C,E,t,q;q=f.guid("uid_");F=D.getShimContainer();if(v){C=a.get(v+"_form");if(C){f.extend(C.style,{top:"100%"})}}E=document.createElement("form");E.setAttribute("id",q+"_form");E.setAttribute("method","post");E.setAttribute("enctype","multipart/form-data");E.setAttribute("encoding","multipart/form-data");f.extend(E.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});t=document.createElement("input");t.setAttribute("id",q);t.setAttribute("type","file");t.setAttribute("name",x.name||"Filedata");t.setAttribute("accept",u.join(","));f.extend(t.style,{fontSize:"999px",opacity:0});E.appendChild(t);F.appendChild(E);f.extend(t.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});if(e.browser==="IE"&&e.verComp(e.version,10,"<")){f.extend(t.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"})}t.onchange=function(){var y;if(!this.value){return}if(this.files){y=this.files[0];if(y.size===0){E.parentNode.removeChild(E);return}}else{y={name:this.value}}y=new c(D.uid,y);this.onchange=function(){};w.call(s);s.files=[y];t.setAttribute("id",y.uid);E.setAttribute("id",y.uid+"_form");s.trigger("change");t=E=null};if(D.can("summon_file_dialog")){r=a.get(x.browse_button);d.removeEvent(r,"click",s.uid);d.addEvent(r,"click",function(y){if(t&&!t.disabled){t.click()}y.preventDefault()},s.uid)}v=q;F=C=r=null}f.extend(this,{init:function(q){var t=this,r=t.getRuntime(),s;x=q;u=q.accept.mimes||b.extList2mimes(q.accept,r.can("filter_by_extension"));s=r.getShimContainer();(function(){var D,B,C;D=a.get(q.browse_button);if(r.can("summon_file_dialog")){if(a.getStyle(D,"position")==="static"){D.style.position="relative"}B=parseInt(a.getStyle(D,"z-index"),10)||1;D.style.zIndex=B;s.style.zIndex=B-1}C=r.can("summon_file_dialog")?D:s;d.addEvent(C,"mouseover",function(){t.trigger("mouseenter")},t.uid);d.addEvent(C,"mouseout",function(){t.trigger("mouseleave")},t.uid);d.addEvent(C,"mousedown",function(){t.trigger("mousedown")},t.uid);d.addEvent(a.get(q.container),"mouseup",function(){t.trigger("mouseup")},t.uid);D=null}());w.call(this);s=null;t.trigger({type:"ready",async:true})},disable:function(q){var r;if((r=a.get(v))){r.disabled=!!q}},destroy:function(){var r=this.getRuntime(),q=r.getShim(),s=r.getShimContainer();d.removeAllEvents(s,this.uid);d.removeAllEvents(x&&a.get(x.container),this.uid);d.removeAllEvents(x&&a.get(x.browse_button),this.uid);if(s){s.innerHTML=""}q.removeInstance(this.uid);v=u=x=s=q=null}})}return(h.FileInput=g)});k("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(b,a){return(b.FileReader=a)});k("moxie/runtime/html4/xhr/XMLHttpRequest",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Url","moxie/core/Exceptions","moxie/core/utils/Events","moxie/file/Blob","moxie/xhr/FormData"],function(e,h,f,r,d,b,g,a){function c(){var v,x,q;function w(C){var t=this,F,D,u,s,E=false;if(!q){return}F=q.id.replace(/_iframe$/,"");D=f.get(F+"_form");if(D){u=D.getElementsByTagName("input");s=u.length;while(s--){switch(u[s].getAttribute("type")){case"hidden":u[s].parentNode.removeChild(u[s]);break;case"file":E=true;break}}u=[];if(!E){D.parentNode.removeChild(D)}D=null}setTimeout(function(){b.removeEvent(q,"load",t.uid);if(q.parentNode){q.parentNode.removeChild(q)}var y=t.getRuntime().getShimContainer();if(!y.children.length){y.parentNode.removeChild(y)}y=q=null;C()},1)}h.extend(this,{send:function(s,H){var F=this,t=F.getRuntime(),G,I,u,J;v=x=null;function E(){var z=t.getShimContainer()||document.body,y=document.createElement("div");y.innerHTML='<iframe id="'+G+'_iframe" name="'+G+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';q=y.firstChild;z.appendChild(q);b.addEvent(q,"load",function(){var A;try{A=q.contentWindow.document||q.contentDocument||window.frames[q.id].document;if(/^4(0[0-9]|1[0-7]|2[2346])\s/.test(A.title)){v=A.title.replace(/^(\d+).*$/,"$1")}else{v=200;x=h.trim(A.body.innerHTML);F.trigger({type:"progress",loaded:x.length,total:x.length});if(J){F.trigger({type:"uploadprogress",loaded:J.size||1025,total:J.size||1025})}}}catch(B){if(r.hasSameOrigin(s.url)){v=404}else{w.call(F,function(){F.trigger("error")});return}}w.call(F,function(){F.trigger("load")})},F.uid)}if(H instanceof a&&H.hasBlob()){J=H.getBlob();G=J.uid;u=f.get(G);I=f.get(G+"_form");if(!I){throw new d.DOMException(d.DOMException.NOT_FOUND_ERR)}}else{G=h.guid("uid_");I=document.createElement("form");I.setAttribute("id",G+"_form");I.setAttribute("method",s.method);I.setAttribute("enctype","multipart/form-data");I.setAttribute("encoding","multipart/form-data");t.getShimContainer().appendChild(I)}I.setAttribute("target",G+"_iframe");if(H instanceof a){H.each(function(y,A){if(y instanceof g){if(u){u.setAttribute("name",A)}}else{var z=document.createElement("input");h.extend(z,{type:"hidden",name:A,value:y});if(u){I.insertBefore(z,u)}else{I.appendChild(z)}}})}I.setAttribute("action",s.url);E();I.submit();F.trigger("loadstart")},getStatus:function(){return v},getResponse:function(t){if("json"===t){if(h.typeOf(x)==="string"&&!!window.JSON){try{return JSON.parse(x.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(s){return null}}}else{if("document"===t){}}return x},abort:function(){var s=this;if(q&&q.contentWindow){if(q.contentWindow.stop){q.contentWindow.stop()}else{if(q.contentWindow.document.execCommand){q.contentWindow.document.execCommand("Stop")}else{q.src="about:blank"}}}w.call(this,function(){s.dispatchEvent("abort")})}})}return(e.XMLHttpRequest=c)});k("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(a,b){return(a.Image=b)});j(["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/I18n","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/file/FileInput","moxie/core/utils/Encode","moxie/file/Blob","moxie/file/File","moxie/file/FileDrop","moxie/file/FileReader","moxie/core/utils/Url","moxie/runtime/RuntimeTarget","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/xhr/XMLHttpRequest","moxie/runtime/Transporter","moxie/image/Image","moxie/core/utils/Events"])})(this);(function(f){var g={},h=f.moxie.core.utils.Basic.inArray;(function e(b){var c,a;for(c in b){a=typeof(b[c]);if(a==="object"&&!~h(c,["Exceptions","Env","Mime"])){e(b[c])}else{if(a==="function"){g[c]=b[c]}}}})(f.moxie);g.Env=f.moxie.core.utils.Env;g.Mime=f.moxie.core.utils.Mime;g.Exceptions=f.moxie.core.Exceptions;f.mOxie=g;if(!f.o){f.o=g}return g})(this);