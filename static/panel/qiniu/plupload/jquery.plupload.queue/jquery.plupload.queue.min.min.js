(function(d,b){function c(g){return plupload.translate(g)||g}function a(e,g){g.contents().each(function(h,i){i=d(i),i.is(".plupload")||i.remove()}),g.prepend('<div class="plupload_wrapper plupload_scroll"><div id="'+e+'_container" class="plupload_container"><div class="plupload"><div class="plupload_header"><div class="plupload_header_content"><div class="plupload_header_title">'+c("Select files")+'</div><div class="plupload_header_text">'+c("Add files to the upload queue and click the start button.")+'</div></div></div><div class="plupload_content"><div class="plupload_filelist_header"><div class="plupload_file_name">'+c("Filename")+'</div><div class="plupload_file_action">&nbsp;</div><div class="plupload_file_status"><span>'+c("Status")+'</span></div><div class="plupload_file_size">'+c("Size")+'</div><div class="plupload_clearer">&nbsp;</div></div><ul id="'+e+'_filelist" class="plupload_filelist"></ul><div class="plupload_filelist_footer"><div class="plupload_file_name"><div class="plupload_buttons"><a href="#" class="plupload_button plupload_add" id="'+e+'_browse">'+c("Add Files")+'</a><a href="#" class="plupload_button plupload_start">'+c("Start Upload")+'</a></div><span class="plupload_upload_status"></span></div><div class="plupload_file_action"></div><div class="plupload_file_status"><span class="plupload_total_status">0%</span></div><div class="plupload_file_size"><span class="plupload_total_file_size">0 b</span></div><div class="plupload_progress"><div class="plupload_progress_container"><div class="plupload_progress_bar"></div></div></div><div class="plupload_clearer">&nbsp;</div></div></div></div></div><input type="hidden" id="'+e+'_count" name="'+e+'_count" value="0" /></div>')}var f={};d.fn.pluploadQueue=function(e){return e?(this.each(function(){function q(h){var p;h.status==plupload.DONE&&(p="plupload_done"),h.status==plupload.FAILED&&(p="plupload_failed"),h.status==plupload.QUEUED&&(p="plupload_delete"),h.status==plupload.UPLOADING&&(p="plupload_uploading");var l=d("#"+h.id).attr("class",p).find("a").css("display","block");h.hint&&l.attr("title",h.hint)}function k(){d("span.plupload_total_status",i).html(j.total.percent+"%"),d("div.plupload_progress_bar",i).css("width",j.total.percent+"%"),d("span.plupload_upload_status",i).html(b.sprintf(c("Uploaded %d/%d files"),j.total.uploaded,j.files.length))}function n(){var p=d("ul.plupload_filelist",i).html(""),h=0,l;d.each(j.files,function(s,u){l="",u.status==plupload.DONE&&(u.target_name&&(l+='<input type="hidden" name="'+m+"_"+h+'_tmpname" value="'+plupload.xmlEncode(u.target_name)+'" />'),l+='<input type="hidden" name="'+m+"_"+h+'_name" value="'+plupload.xmlEncode(u.name)+'" />',l+='<input type="hidden" name="'+m+"_"+h+'_status" value="'+(u.status==plupload.DONE?"done":"failed")+'" />',h++,d("#"+m+"_count").val(h)),p.append('<li id="'+u.id+'"><div class="plupload_file_name"><span>'+u.name+'</span></div><div class="plupload_file_action"><a href="#"></a></div><div class="plupload_file_status">'+u.percent+'%</div><div class="plupload_file_size">'+plupload.formatSize(u.size)+'</div><div class="plupload_clearer">&nbsp;</div>'+l+"</li>"),q(u),d("#"+u.id+".plupload_delete a").click(function(r){d("#"+u.id).remove(),j.removeFile(u),r.preventDefault()})}),d("span.plupload_total_file_size",i).html(plupload.formatSize(j.total.size)),j.total.queued===0?d("span.plupload_add_text",i).html(c("Add Files")):d("span.plupload_add_text",i).html(b.sprintf(c("%d files queued"),j.total.queued)),d("a.plupload_start",i).toggleClass("plupload_disabled",j.files.length==j.total.uploaded+j.total.failed),p[0].scrollTop=p[0].scrollHeight,k(),!j.files.length&&j.features.dragdrop&&j.settings.dragdrop&&d("#"+m+"_filelist").append('<li class="plupload_droptext">'+c("Drag files here.")+"</li>")}function o(){delete f[m],j.destroy(),i.html(g),j=i=g=null}var j,i,m,g;i=d(this),m=i.attr("id"),m||(m=plupload.guid(),i.attr("id",m)),g=i.html(),a(m,i),e=d.extend({dragdrop:!0,browse_button:m+"_browse",container:m},e),e.dragdrop&&(e.drop_element=m+"_filelist"),j=new plupload.Uploader(e),f[m]=j,j.bind("UploadFile",function(h,l){d("#"+l.id).addClass("plupload_current_file")}),j.bind("Init",function(h,l){!e.unique_names&&e.rename&&i.on("click","#"+m+"_filelist div.plupload_file_name span",function(y){var w=d(y.target),t,v,x,p="";t=h.getFile(w.parents("li")[0].id),x=t.name,v=/^(.+)(\.[^.]+)$/.exec(x),v&&(x=v[1],p=v[2]),w.hide().after('<input type="text" />'),w.next().val(x).focus().blur(function(){w.show().next().remove()}).keydown(function(r){var s=d(this);r.keyCode==13&&(r.preventDefault(),t.name=s.val()+p,w.html(t.name),s.blur())})}),d("#"+m+"_container").attr("title","Using runtime: "+l.runtime),d("a.plupload_start",i).click(function(p){d(this).hasClass("plupload_disabled")||j.start(),p.preventDefault()}),d("a.plupload_stop",i).click(function(p){p.preventDefault(),j.stop()}),d("a.plupload_start",i).addClass("plupload_disabled")}),j.bind("Error",function(l,r){var h=r.file,p;h&&(p=r.message,r.details&&(p+=" ("+r.details+")"),r.code==plupload.FILE_SIZE_ERROR&&alert(c("Error: File too large:")+" "+h.name),r.code==plupload.FILE_EXTENSION_ERROR&&alert(c("Error: Invalid file extension:")+" "+h.name),h.hint=p,d("#"+h.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",p)),r.code===plupload.INIT_ERROR&&setTimeout(function(){o()},1)}),j.bind("PostInit",function(h){h.settings.dragdrop&&h.features.dragdrop&&d("#"+m+"_filelist").append('<li class="plupload_droptext">'+c("Drag files here.")+"</li>")}),j.init(),j.bind("StateChanged",function(){j.state===plupload.STARTED?(d("li.plupload_delete a,div.plupload_buttons",i).hide(),j.disableBrowse(!0),d("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",i).css("display","block"),d("span.plupload_upload_status",i).html("Uploaded "+j.total.uploaded+"/"+j.files.length+" files"),e.multiple_queues&&d("span.plupload_total_status,span.plupload_total_file_size",i).show()):(n(),d("a.plupload_stop,div.plupload_progress",i).hide(),d("a.plupload_delete",i).css("display","block"),e.multiple_queues&&j.total.uploaded+j.total.failed==j.files.length&&(d(".plupload_buttons,.plupload_upload_status",i).css("display","inline"),j.disableBrowse(!1),d(".plupload_start",i).addClass("plupload_disabled"),d("span.plupload_total_status,span.plupload_total_file_size",i).hide()))}),j.bind("FilesAdded",n),j.bind("FilesRemoved",function(){var h=d("#"+m+"_filelist").scrollTop();n(),d("#"+m+"_filelist").scrollTop(h)}),j.bind("FileUploaded",function(l,h){q(h)}),j.bind("UploadProgress",function(h,l){d("#"+l.id+" div.plupload_file_status",i).html(l.percent+"%"),q(l),k()}),e.setup&&e.setup(j)}),this):f[d(this[0]).attr("id")]}})(jQuery,mOxie);