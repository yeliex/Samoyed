$(function(){currentArgs.district=currentArgs.area;if(currentArgs.target==="search"){displayList(doSearch(currentArgs))}else{displayList(doList(currentArgs))}});function doList(e){var f={};var d=$.ajax("http://api.mzapp.info/plist",{method:"GET",async:false,data:{protocol:"json",city:"0571",district:getDistrict(e.district,1),size:getSize(e.size,1),price:getPrice(e.price,1)}});d.complete(function(a){f=$.parseJSON(a.responseText)});return f.overview}function doSearch(b){}function displayList(g){var f=g.length;for(var e=0;e<f;e++){var h=g[e];displayItem(h)}}function displayItem(l){var m=new BuildingData(l);var k=location.origin+"/detail?id="+m.id;var i=m.name+"-觅知空间-"+m.area+"-"+m.district;var j="<a href='"+k+"' target='_blank'>";j+="<div class='card cardLink' id='"+m.id+"'>";j+="<div class='ui move left reveal image'>";j+="<img src='"+m.image+"' class='visible content'>";j+="<div class='hidden content'><div class='unit list'>";j+="<table class='ui small celled striped table'>";j+="<thead class='full-width'><tr>";j+="<th colspan='4'>共有<span>"+m.units.length+"</span>个户型";j+="</th></tr></thead>";j+="<tbody>";for(var h=0;h<m.units.length&&h<5;h++){var n=new UnitData(m.units[h]);j+="<tr><td>"+n.name+"</td><td>"+n.price+"元</td><td>"+n.size+"平</td><td>"+n.deco+"</td></tr>"}j+="</tbody>";j+="<tfoot class='full-width'>";j+="<tr><th colspan='4'><div class='right floated'>";j+="<a><i class='angle double right icon'></i>更多</a>";j+="</div></th></tr></tfoot></table></div></div></div>";j+="<div class='content'>";j+="<span class='header'>"+m.name+"</span>";j+="<div class='meta'>";j+="<span class='date'>"+m.dadd+"</span>";j+="<a class='right floated'><span>"+m.size+"</span> 平</a>";j+="</div></div>";j+="<div class='extra content'>";j+="<span class='left floated like'>";j+="<i class='users icon'></i>2 人关注</span>";j+="<a onclick='addFavourite(this)' data-link='"+k+"' data-page='"+i+"'><span class='right floated star'><i class='star icon'></i> 立即收藏 </span></a>";j+="</div>";j+="<div class='ui bottom teal button'><i class='pointing right icon'> </i> <span>"+m.price+"</span> 元起</div>";j+="</div>";j+="</a>";$(".building.list .cards").append(j)}function BuildingData(b){this.id=b.dog_id;this.name=b.dog_name;this.area=b.dog_area;this.district=b.dog_district;this.add=b.dog_add;this.image=b.dog_pic;this.price=b.dog_price.split("|")[0];this.size=b.dog_size.split("|").join("-");this.units_num=b.units_num;this.units=getUnits(this.id);this.dadd=this.district+"-"+this.area+"-"+this.add}function UnitData(b){this.name=b.unit_name;this.id=b.unit_id;this.price=b.unit_price;this.size=b.unit_size;this.pic=b.unit_pic;this.deco=b.unit_deco}function getUnits(e){var f={};var d=$.ajax("http://api.mzapp.info/item/units",{method:"GET",async:false,data:{protocol:"json",id:e}});d.complete(function(a){f=$.parseJSON(a.responseText)});return f.overview}function addFavourite(i){var e=$(i).attr("data-link");var k=$(i).attr("data-page");var l=(navigator.userAgent.toLowerCase()).indexOf("mac")!=-1?"Command/Cmd":"CTRL";try{window.external.AddFavorite(e,k)}catch(h){try{window.sidebar.addPanel(k,e)}catch(j){alert("很抱歉您使用的浏览器不支持此功能\n\n您可以按下 "+l+"+ D 手动添加")}}};