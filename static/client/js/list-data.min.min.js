$(function(){currentArgs.district=currentArgs.area;if(currentArgs.target==="search"){displayList(doSearch(currentArgs))}else{displayList(doList(currentArgs))}});function doList(b){var a={};var c=$.ajax("http://api.mzapp.info/plist",{method:"GET",async:false,data:{protocol:"json",city:"0571",district:getDistrict(b.district,1),size:getSize(b.size,1),price:getPrice(b.price,1)}});c.complete(function(d){a=$.parseJSON(d.responseText)});return a.overview}function doSearch(a){}function displayList(b){var c=b.length;for(var d=0;d<c;d++){var a=b[d];displayItem(a)}}function displayItem(b){var a=new BuildingData(b);var c=location.origin+"/detail?id="+a.id;var e=a.name+"-觅知空间-"+a.area+"-"+a.district;var d="<a href='"+c+"' target='_blank'>";d+="<div class='card cardLink' id='"+a.id+"'>";d+="<div class='ui move left reveal image'>";d+="<img src='"+a.image+"' class='visible content'>";d+="<div class='hidden content'><div class='unit list'>";d+="<table class='ui small celled striped table'>";d+="<thead class='full-width'><tr>";d+="<th colspan='4'>共有<span>"+a.units.length+"</span>个户型";d+="</th></tr></thead>";d+="<tbody>";for(var f=0;f<a.units.length&&f<5;f++){var g=new UnitData(a.units[f]);d+="<tr><td>"+g.name+"</td><td>"+g.price+"元</td><td>"+g.size+"平</td><td>"+g.deco+"</td></tr>"}d+="</tbody>";d+="<tfoot class='full-width'>";d+="<tr><th colspan='4'><div class='right floated'>";d+="<a><i class='angle double right icon'></i>更多</a>";d+="</div></th></tr></tfoot></table></div></div></div>";d+="<div class='content'>";d+="<span class='header'>"+a.name+"</span>";d+="<div class='meta'>";d+="<span class='date'>"+a.dadd+"</span>";d+="<a class='right floated'><span>"+a.size+"</span> 平</a>";d+="</div></div>";d+="<div class='extra content'>";d+="<span class='left floated like'>";d+="<i class='users icon'></i>2 人关注</span>";d+="<a onclick='addFavourite(this)' data-link='"+c+"' data-page='"+e+"'><span class='right floated star'><i class='star icon'></i> 立即收藏 </span></a>";d+="</div>";d+="<div class='ui bottom teal button'><i class='pointing right icon'> </i> <span>"+a.price+"</span> 元起</div>";d+="</div>";d+="</a>";$(".building.list .cards").append(d)}function BuildingData(a){this.id=a.dog_id;this.name=a.dog_name;this.area=a.dog_area;this.district=a.dog_district;this.add=a.dog_add;this.image=a.dog_pic;this.price=a.dog_price.split("|")[0];this.size=a.dog_size.split("|").join("-");this.units_num=a.units_num;this.units=getUnits(this.id);this.dadd=this.district+"-"+this.area+"-"+this.add}function UnitData(a){this.name=a.unit_name;this.id=a.unit_id;this.price=a.unit_price;this.size=a.unit_size;this.pic=a.unit_pic;this.deco=a.unit_deco}function getUnits(b){var a={};var c=$.ajax("http://api.mzapp.info/item/units",{method:"GET",async:false,data:{protocol:"json",id:b}});c.complete(function(d){a=$.parseJSON(d.responseText)});return a.overview}function addFavourite(d){var g=$(d).attr("data-link");var b=$(d).attr("data-page");var a=(navigator.userAgent.toLowerCase()).indexOf("mac")!=-1?"Command/Cmd":"CTRL";try{window.external.AddFavorite(g,b)}catch(f){try{window.sidebar.addPanel(b,g)}catch(c){alert("很抱歉您使用的浏览器不支持此功能\n\n您可以按下 "+a+"+ D 手动添加")}}};