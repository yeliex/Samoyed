/*!
 * # Semantic UI x.x - Progress
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;(function(h,e,f,g){h.fn.progress=function(a){var c=h(this),o=c.selector||"",q=new Date().getTime(),d=[],n=arguments[0],r=(typeof n=="string"),b=[].slice.call(arguments,1),p;c.each(function(){var l=(h.isPlainObject(a))?h.extend(true,{},h.fn.progress.settings,a):h.extend({},h.fn.progress.settings),M=l.className,G=l.metadata,j=l.namespace,P=l.selector,K=l.error,k="."+j,N="module-"+j,I=h(this),E=h(this).find(P.bar),L=h(this).find(P.progress),J=h(this).find(P.label),O=this,m=I.data(N),i=false,H,F;F={initialize:function(){F.debug("Initializing progress bar",l);F.set.duration();F.set.transitionEvent();F.read.metadata();F.read.settings();F.instantiate()},instantiate:function(){F.verbose("Storing instance of progress",F);m=F;I.data(N,F)},destroy:function(){F.verbose("Destroying previous progress for",I);clearInterval(m.interval);F.remove.state();I.removeData(N);m=g},reset:function(){F.set.percent(0)},complete:function(){if(F.percent===g||F.percent<100){F.set.percent(100)}},read:{metadata:function(){var s={percent:I.data(G.percent),total:I.data(G.total),value:I.data(G.value)};if(s.percent){F.debug("Current percent value set from metadata",s.percent);F.set.percent(s.percent)}if(s.total){F.debug("Total value set from metadata",s.total);F.set.total(s.total)}if(s.value){F.debug("Current value set from metadata",s.value);F.set.value(s.value);F.set.progress(s.value)}},settings:function(){if(l.total!==false){F.debug("Current total set in settings",l.total);F.set.total(l.total)}if(l.value!==false){F.debug("Current value set in settings",l.value);F.set.value(l.value);F.set.progress(F.value)}if(l.percent!==false){F.debug("Current percent set in settings",l.percent);F.set.percent(l.percent)}}},increment:function(u){var s,v,t;if(F.has.total()){v=F.get.value();u=u||1;t=v+u;s=F.get.total();F.debug("Incrementing value",v,t,s);if(t>s){F.debug("Value cannot increment above total",s);t=s}}else{v=F.get.percent();u=u||F.get.randomValue();t=v+u;s=100;F.debug("Incrementing percentage by",v,t);if(t>s){F.debug("Value cannot increment above 100 percent");t=s}}F.set.progress(t)},decrement:function(u){var t=F.get.total(),v,s;if(t){v=F.get.value();u=u||1;s=v-u;F.debug("Decrementing value by",u,v)}else{v=F.get.percent();u=u||F.get.randomValue();s=v-u;F.debug("Decrementing percentage by",u,v)}if(s<0){F.debug("Value cannot decrement below 0");s=0}F.set.progress(s)},has:{total:function(){return(F.get.total()!==false)}},get:{text:function(t){var u=F.value||0,v=F.total||0,w=(i)?F.get.displayPercent():F.percent||0,s=(F.total>0)?(v-u):(100-w);t=t||"";t=t.replace("{value}",u).replace("{total}",v).replace("{left}",s).replace("{percent}",w);F.debug("Adding variables to progress bar text",t);return t},randomValue:function(){F.debug("Generating random increment percentage");return Math.floor((Math.random()*l.random.max)+l.random.min)},numericValue:function(s){return(typeof s==="string")?(s.replace(/[^\d.]/g,"")!=="")?+(s.replace(/[^\d.]/g,"")):false:s},transitionEnd:function(){var u=f.createElement("element"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"},s;for(s in t){if(u.style[s]!==g){return t[s]}}},displayPercent:function(){var s=E.width(),v=I.width(),t=parseInt(E.css("min-width"),10),u=(s>t)?(s/v*100):F.percent;return(l.precision>0)?Math.round(u*(10*l.precision))/(10*l.precision):Math.round(u)},percent:function(){return F.percent||0},value:function(){return F.value||0},total:function(){return F.total||false}},is:{success:function(){return I.hasClass(M.success)},warning:function(){return I.hasClass(M.warning)},error:function(){return I.hasClass(M.error)},active:function(){return I.hasClass(M.active)},visible:function(){return I.is(":visible")}},remove:{state:function(){F.verbose("Removing stored state");delete F.total;delete F.percent;delete F.value},active:function(){F.verbose("Removing active state");I.removeClass(M.active)},success:function(){F.verbose("Removing success state");I.removeClass(M.success)},warning:function(){F.verbose("Removing warning state");I.removeClass(M.warning)},error:function(){F.verbose("Removing error state");I.removeClass(M.error)}},set:{barWidth:function(s){if(s>100){F.error(K.tooHigh,s)}else{if(s<0){F.error(K.tooLow,s)}else{E.css("width",s+"%");I.attr("data-percent",parseInt(s,10))}}},duration:function(s){s=s||l.duration;s=(typeof s=="number")?s+"ms":s;F.verbose("Setting progress bar transition duration",s);E.css({"transition-duration":s})},percent:function(s){s=(typeof s=="string")?+(s.replace("%","")):s;s=(l.precision>0)?Math.round(s*(10*l.precision))/(10*l.precision):Math.round(s);F.percent=s;if(!F.has.total()){F.value=(l.precision>0)?Math.round((s/100)*F.total*(10*l.precision))/(10*l.precision):Math.round((s/100)*F.total*10)/10;if(l.limitValues){F.value=(F.value>100)?100:(F.value<0)?0:F.value}}F.set.barWidth(s);F.set.labelInterval();F.set.labels();l.onChange.call(O,s,F.value,F.total)},labelInterval:function(){var s=function(){F.verbose("Bar finished animating, removing continuous label updates");clearInterval(F.interval);i=false;F.set.labels()};clearInterval(F.interval);E.one(H+k,s);F.timer=setTimeout(s,l.duration+100);i=true;F.interval=setInterval(F.set.labels,l.framerate)},labels:function(){F.verbose("Setting both bar progress and outer label text");F.set.barLabel();F.set.state()},label:function(s){s=s||"";if(s){s=F.get.text(s);F.debug("Setting label to text",s);J.text(s)}},state:function(s){s=(s!==g)?s:F.percent;if(s===100){if(l.autoSuccess&&!(F.is.warning()||F.is.error())){F.set.success();F.debug("Automatically triggering success at 100%")}else{F.verbose("Reached 100% removing active state");F.remove.active()}}else{if(s>0){F.verbose("Adjusting active progress bar label",s);F.set.active()}else{F.remove.active();F.set.label(l.text.active)}}},barLabel:function(s){if(s!==g){L.text(F.get.text(s))}else{if(l.label=="ratio"&&F.total){F.debug("Adding ratio to bar label");L.text(F.get.text(l.text.ratio))}else{if(l.label=="percent"){F.debug("Adding percentage to bar label");L.text(F.get.text(l.text.percent))}}}},active:function(s){s=s||l.text.active;F.debug("Setting active state");if(l.showActivity&&!F.is.active()){I.addClass(M.active)}F.remove.warning();F.remove.error();F.remove.success();if(s){F.set.label(s)}l.onActive.call(O,F.value,F.total)},success:function(s){s=s||l.text.success;F.debug("Setting success state");I.addClass(M.success);F.remove.active();F.remove.warning();F.remove.error();F.complete();if(s){F.set.label(s)}l.onSuccess.call(O,F.total)},warning:function(s){s=s||l.text.warning;F.debug("Setting warning state");I.addClass(M.warning);F.remove.active();F.remove.success();F.remove.error();F.complete();if(s){F.set.label(s)}l.onWarning.call(O,F.value,F.total)},error:function(s){s=s||l.text.error;F.debug("Setting error state");I.addClass(M.error);F.remove.active();F.remove.success();F.remove.warning();F.complete();if(s){F.set.label(s)}l.onError.call(O,F.value,F.total)},transitionEvent:function(){H=F.get.transitionEnd()},total:function(s){F.total=s},value:function(s){F.value=s},progress:function(t){var s=F.get.numericValue(t),u;if(s===false){F.error(K.nonNumeric,t)}if(F.has.total()){F.set.value(s);u=(s/F.total)*100;F.debug("Calculating percent complete from total",u);F.set.percent(u)}else{u=s;F.debug("Setting value to exact percentage value",u);F.set.percent(u)}}},setting:function(t,s){F.debug("Changing setting",t,s);if(h.isPlainObject(t)){h.extend(true,l,t)}else{if(s!==g){l[t]=s}else{return l[t]}}},internal:function(t,s){if(h.isPlainObject(t)){h.extend(true,F,t)}else{if(s!==g){F[t]=s}else{return F[t]}}},debug:function(){if(l.debug){if(l.performance){F.performance.log(arguments)}else{F.debug=Function.prototype.bind.call(console.info,console,l.name+":");F.debug.apply(console,arguments)}}},verbose:function(){if(l.verbose&&l.debug){if(l.performance){F.performance.log(arguments)}else{F.verbose=Function.prototype.bind.call(console.info,console,l.name+":");F.verbose.apply(console,arguments)}}},error:function(){F.error=Function.prototype.bind.call(console.error,console,l.name+":");F.error.apply(console,arguments)},performance:{log:function(t){var u,s,v;if(l.performance){u=new Date().getTime();v=q||u;s=u-v;q=u;d.push({Name:t[0],Arguments:[].slice.call(t,1)||"",Element:O,"Execution Time":s})}clearTimeout(F.performance.timer);F.performance.timer=setTimeout(F.performance.display,500)},display:function(){var s=l.name+":",t=0;q=false;clearTimeout(F.performance.timer);h.each(d,function(v,u){t+=u["Execution Time"]});s+=" "+t+"ms";if(o){s+=" '"+o+"'"}if((console.group!==g||console.table!==g)&&d.length>0){console.groupCollapsed(s);if(console.table){console.table(d)}else{h.each(d,function(v,u){console.log(u.Name+": "+u["Execution Time"]+"ms")})}console.groupEnd()}d=[]}},invoke:function(t,x,v){var w=m,s,u,y;x=x||b;v=O||v;if(typeof t=="string"&&w!==g){t=t.split(/[\. ]/);s=t.length-1;h.each(t,function(A,B){var z=(A!=s)?B+t[A+1].charAt(0).toUpperCase()+t[A+1].slice(1):t;if(h.isPlainObject(w[z])&&(A!=s)){w=w[z]}else{if(w[z]!==g){u=w[z];return false}else{if(h.isPlainObject(w[B])&&(A!=s)){w=w[B]}else{if(w[B]!==g){u=w[B];return false}else{F.error(K.method,t);return false}}}}})}if(h.isFunction(u)){y=u.apply(v,x)}else{if(u!==g){y=u}}if(h.isArray(p)){p.push(y)}else{if(p!==g){p=[p,y]}else{if(y!==g){p=y}}}return u}};if(r){if(m===g){F.initialize()}F.invoke(n)}else{if(m!==g){m.invoke("destroy")}F.initialize()}});return(p!==g)?p:this};h.fn.progress.settings={name:"Progress",namespace:"progress",debug:false,verbose:false,performance:true,random:{min:2,max:5},duration:300,autoSuccess:true,showActivity:true,limitValues:true,label:"percent",precision:0,framerate:(1000/30),percent:false,total:false,value:false,onChange:function(b,a,c){},onSuccess:function(a){},onActive:function(a,b){},onError:function(a,b){},onWarning:function(a,b){},error:{method:"The method you called is not defined.",nonNumeric:"Progress value is non numeric",tooHigh:"Value specified is above 100%",tooLow:"Value specified is below 0%"},regExp:{variable:/\{\$*[A-z0-9]+\}/g},metadata:{percent:"percent",total:"total",value:"value"},selector:{bar:"> .bar",label:"> .label",progress:".bar > .progress"},text:{active:false,error:false,success:false,warning:false,percent:"{percent}%",ratio:"{value} of {total}"},className:{active:"active",error:"error",success:"success",warning:"warning"}}})(jQuery,window,document);