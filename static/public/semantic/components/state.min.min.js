/*!
 * # Semantic UI x.x - State
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;(function(h,e,f,g){h.fn.state=function(a){var c=h(this),p=c.selector||"",q=("ontouchstart" in f.documentElement),s=new Date().getTime(),d=[],o=arguments[0],t=(typeof o=="string"),b=[].slice.call(arguments,1),r;c.each(function(){var k=(h.isPlainObject(a))?h.extend(true,{},h.fn.state.settings,a):h.extend({},h.fn.state.settings),F=k.error,D=k.metadata,G=k.className,j=k.namespace,n=k.states,B=k.text,m="."+j,H=j+"-module",E=h(this),i=this,C=E.data(H),l;l={initialize:function(){l.verbose("Initializing module");if(k.automatic){l.add.defaults()}if(k.context&&p!==""){h(k.context).on(p,"mouseenter"+m,l.change.text).on(p,"mouseleave"+m,l.reset.text).on(p,"click"+m,l.toggle.state)}else{E.on("mouseenter"+m,l.change.text).on("mouseleave"+m,l.reset.text).on("click"+m,l.toggle.state)}l.instantiate()},instantiate:function(){l.verbose("Storing instance of module",l);C=l;E.data(H,l)},destroy:function(){l.verbose("Destroying previous module",C);E.off(m).removeData(H)},refresh:function(){l.verbose("Refreshing selector cache");E=h(i)},add:{defaults:function(){var u=a&&h.isPlainObject(a.states)?a.states:{};h.each(k.defaults,function(v,w){if(l.is[v]!==g&&l.is[v]()){l.verbose("Adding default states",v,i);h.extend(k.states,w,u)}})}},is:{active:function(){return E.hasClass(G.active)},loading:function(){return E.hasClass(G.loading)},inactive:function(){return !(E.hasClass(G.active))},state:function(u){if(G[u]===g){return false}return E.hasClass(G[u])},enabled:function(){return !(E.is(k.filter.active))},disabled:function(){return(E.is(k.filter.active))},textEnabled:function(){return !(E.is(k.filter.text))},button:function(){return E.is(".button:not(a, .submit)")},input:function(){return E.is("input")},progress:function(){return E.is(".ui.progress")}},allow:function(u){l.debug("Now allowing state",u);n[u]=true},disallow:function(u){l.debug("No longer allowing",u);n[u]=false},allows:function(u){return n[u]||false},enable:function(){E.removeClass(G.disabled)},disable:function(){E.addClass(G.disabled)},setState:function(u){if(l.allows(u)){E.addClass(G[u])}},removeState:function(u){if(l.allows(u)){E.removeClass(G[u])}},toggle:{state:function(){var v,u;if(l.allows("active")&&l.is.enabled()){l.refresh();if(h.fn.api!==g){v=E.api("get request");u=E.api("was cancelled");if(u){l.debug("API Request cancelled by beforesend");k.activateTest=function(){return false};k.deactivateTest=function(){return false}}else{if(v){l.listenTo(v);return}}}l.change.state()}}},listenTo:function(u){l.debug("API request detected, waiting for state signal",u);if(u){if(B.loading){l.update.text(B.loading)}h.when(u).then(function(){if(u.state()=="resolved"){l.debug("API request succeeded");k.activateTest=function(){return true};k.deactivateTest=function(){return true}}else{l.debug("API request failed");k.activateTest=function(){return false};k.deactivateTest=function(){return false}}l.change.state()})}},change:{state:function(){l.debug("Determining state change direction");if(l.is.inactive()){l.activate()}else{l.deactivate()}if(k.sync){l.sync()}k.onChange.call(i)},text:function(){if(l.is.textEnabled()){if(l.is.disabled()){l.verbose("Changing text to disabled text",B.hover);l.update.text(B.disabled)}else{if(l.is.active()){if(B.hover){l.verbose("Changing text to hover text",B.hover);l.update.text(B.hover)}else{if(B.deactivate){l.verbose("Changing text to deactivating text",B.deactivate);l.update.text(B.deactivate)}}}else{if(B.hover){l.verbose("Changing text to hover text",B.hover);l.update.text(B.hover)}else{if(B.activate){l.verbose("Changing text to activating text",B.activate);l.update.text(B.activate)}}}}}}},activate:function(){if(k.activateTest.call(i)){l.debug("Setting state to active");E.addClass(G.active);l.update.text(B.active);k.onActivate.call(i)}},deactivate:function(){if(k.deactivateTest.call(i)){l.debug("Setting state to inactive");E.removeClass(G.active);l.update.text(B.inactive);k.onDeactivate.call(i)}},sync:function(){l.verbose("Syncing other buttons to current state");if(l.is.active()){c.not(E).state("activate")}else{c.not(E).state("deactivate")}},get:{text:function(){return(k.selector.text)?E.find(k.selector.text).text():E.html()},textFor:function(u){return B[u]||false}},flash:{text:function(v,w,u){var x=l.get.text();l.debug("Flashing text message",v,w);v=v||k.text.flash;w=w||k.flashDuration;u=u||function(){};l.update.text(v);setTimeout(function(){l.update.text(x);u.call(i)},w)}},reset:{text:function(){var v=B.active||E.data(D.storedText),u=B.inactive||E.data(D.storedText);if(l.is.textEnabled()){if(l.is.active()&&v){l.verbose("Resetting active text",v);l.update.text(v)}else{if(u){l.verbose("Resetting inactive text",v);l.update.text(u)}}}}},update:{text:function(u){var v=l.get.text();if(u&&u!==v){l.debug("Updating text",u);if(k.selector.text){E.data(D.storedText,u).find(k.selector.text).text(u)}else{E.data(D.storedText,u).html(u)}}else{l.debug("Text is already set, ignoring update",u)}}},setting:function(v,u){l.debug("Changing setting",v,u);if(h.isPlainObject(v)){h.extend(true,k,v)}else{if(u!==g){k[v]=u}else{return k[v]}}},internal:function(v,u){if(h.isPlainObject(v)){h.extend(true,l,v)}else{if(u!==g){l[v]=u}else{return l[v]}}},debug:function(){if(k.debug){if(k.performance){l.performance.log(arguments)}else{l.debug=Function.prototype.bind.call(console.info,console,k.name+":");l.debug.apply(console,arguments)}}},verbose:function(){if(k.verbose&&k.debug){if(k.performance){l.performance.log(arguments)}else{l.verbose=Function.prototype.bind.call(console.info,console,k.name+":");l.verbose.apply(console,arguments)}}},error:function(){l.error=Function.prototype.bind.call(console.error,console,k.name+":");l.error.apply(console,arguments)},performance:{log:function(v){var w,u,x;if(k.performance){w=new Date().getTime();x=s||w;u=w-x;s=w;d.push({Name:v[0],Arguments:[].slice.call(v,1)||"",Element:i,"Execution Time":u})}clearTimeout(l.performance.timer);l.performance.timer=setTimeout(l.performance.display,500)},display:function(){var u=k.name+":",v=0;s=false;clearTimeout(l.performance.timer);h.each(d,function(x,w){v+=w["Execution Time"]});u+=" "+v+"ms";if(p){u+=" '"+p+"'"}if((console.group!==g||console.table!==g)&&d.length>0){console.groupCollapsed(u);if(console.table){console.table(d)}else{h.each(d,function(x,w){console.log(w.Name+": "+w["Execution Time"]+"ms")})}console.groupEnd()}d=[]}},invoke:function(v,z,x){var y=C,u,w,A;z=z||b;x=i||x;if(typeof v=="string"&&y!==g){v=v.split(/[\. ]/);u=v.length-1;h.each(v,function(L,M){var N=(L!=u)?M+v[L+1].charAt(0).toUpperCase()+v[L+1].slice(1):v;if(h.isPlainObject(y[N])&&(L!=u)){y=y[N]}else{if(y[N]!==g){w=y[N];return false}else{if(h.isPlainObject(y[M])&&(L!=u)){y=y[M]}else{if(y[M]!==g){w=y[M];return false}else{l.error(F.method,v);return false}}}}})}if(h.isFunction(w)){A=w.apply(x,z)}else{if(w!==g){A=w}}if(h.isArray(r)){r.push(A)}else{if(r!==g){r=[r,A]}else{if(A!==g){r=A}}}return w}};if(t){if(C===g){l.initialize()}l.invoke(o)}else{if(C!==g){C.invoke("destroy")}l.initialize()}});return(r!==g)?r:this};h.fn.state.settings={name:"State",debug:false,verbose:false,namespace:"state",performance:true,onActivate:function(){},onDeactivate:function(){},onChange:function(){},activateTest:function(){return true},deactivateTest:function(){return true},automatic:true,sync:false,flashDuration:1000,filter:{text:".loading, .disabled",active:".disabled"},context:false,error:{beforeSend:"The before send function has cancelled state change",method:"The method you called is not defined."},metadata:{promise:"promise",storedText:"stored-text"},className:{active:"active",disabled:"disabled",error:"error",loading:"loading",success:"success",warning:"warning"},selector:{text:false},defaults:{input:{disabled:true,loading:true,active:true},button:{disabled:true,loading:true,active:true},progress:{active:true,success:true,warning:true,error:true}},states:{active:true,disabled:true,error:true,loading:true,success:true,warning:true},text:{disabled:false,flash:false,hover:false,active:false,inactive:false,activate:false,deactivate:false}}})(jQuery,window,document);