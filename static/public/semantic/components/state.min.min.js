/*!
 * # Semantic UI x.x - State
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;!function(d,c,f,b){d.fn.state=function(n){var h,e=d(this),p=e.selector||"",a=("ontouchstart" in f.documentElement,(new Date).getTime()),k=[],m=arguments[0],g="string"==typeof m,j=[].slice.call(arguments,1);return e.each(function(){var o,u=d.isPlainObject(n)?d.extend(!0,{},d.fn.state.settings,n):d.extend({},d.fn.state.settings),t=u.error,E=u.metadata,A=u.className,q=u.namespace,B=u.states,l=u.text,s="."+q,r=q+"-module",z=d(this),D=this,i=z.data(r);o={initialize:function(){o.verbose("Initializing module"),u.automatic&&o.add.defaults(),u.context&&""!==p?d(u.context).on(p,"mouseenter"+s,o.change.text).on(p,"mouseleave"+s,o.reset.text).on(p,"click"+s,o.toggle.state):z.on("mouseenter"+s,o.change.text).on("mouseleave"+s,o.reset.text).on("click"+s,o.toggle.state),o.instantiate()},instantiate:function(){o.verbose("Storing instance of module",o),i=o,z.data(r,o)},destroy:function(){o.verbose("Destroying previous module",i),z.off(s).removeData(r)},refresh:function(){o.verbose("Refreshing selector cache"),z=d(D)},add:{defaults:function(){var v=n&&d.isPlainObject(n.states)?n.states:{};d.each(u.defaults,function(w,x){o.is[w]!==b&&o.is[w]()&&(o.verbose("Adding default states",w,D),d.extend(u.states,x,v))})}},is:{active:function(){return z.hasClass(A.active)},loading:function(){return z.hasClass(A.loading)},inactive:function(){return !z.hasClass(A.active)},state:function(v){return A[v]===b?!1:z.hasClass(A[v])},enabled:function(){return !z.is(u.filter.active)},disabled:function(){return z.is(u.filter.active)},textEnabled:function(){return !z.is(u.filter.text)},button:function(){return z.is(".button:not(a, .submit)")},input:function(){return z.is("input")},progress:function(){return z.is(".ui.progress")}},allow:function(v){o.debug("Now allowing state",v),B[v]=!0},disallow:function(v){o.debug("No longer allowing",v),B[v]=!1},allows:function(v){return B[v]||!1},enable:function(){z.removeClass(A.disabled)},disable:function(){z.addClass(A.disabled)},setState:function(v){o.allows(v)&&z.addClass(A[v])},removeState:function(v){o.allows(v)&&z.removeClass(A[v])},toggle:{state:function(){var w,v;if(o.allows("active")&&o.is.enabled()){if(o.refresh(),d.fn.api!==b){if(w=z.api("get request"),v=z.api("was cancelled")){o.debug("API Request cancelled by beforesend"),u.activateTest=function(){return !1},u.deactivateTest=function(){return !1}}else{if(w){return void o.listenTo(w)}}}o.change.state()}}},listenTo:function(v){o.debug("API request detected, waiting for state signal",v),v&&(l.loading&&o.update.text(l.loading),d.when(v).then(function(){"resolved"==v.state()?(o.debug("API request succeeded"),u.activateTest=function(){return !0},u.deactivateTest=function(){return !0}):(o.debug("API request failed"),u.activateTest=function(){return !1},u.deactivateTest=function(){return !1}),o.change.state()}))},change:{state:function(){o.debug("Determining state change direction"),o.is.inactive()?o.activate():o.deactivate(),u.sync&&o.sync(),u.onChange.call(D)},text:function(){o.is.textEnabled()&&(o.is.disabled()?(o.verbose("Changing text to disabled text",l.hover),o.update.text(l.disabled)):o.is.active()?l.hover?(o.verbose("Changing text to hover text",l.hover),o.update.text(l.hover)):l.deactivate&&(o.verbose("Changing text to deactivating text",l.deactivate),o.update.text(l.deactivate)):l.hover?(o.verbose("Changing text to hover text",l.hover),o.update.text(l.hover)):l.activate&&(o.verbose("Changing text to activating text",l.activate),o.update.text(l.activate)))}},activate:function(){u.activateTest.call(D)&&(o.debug("Setting state to active"),z.addClass(A.active),o.update.text(l.active),u.onActivate.call(D))},deactivate:function(){u.deactivateTest.call(D)&&(o.debug("Setting state to inactive"),z.removeClass(A.active),o.update.text(l.inactive),u.onDeactivate.call(D))},sync:function(){o.verbose("Syncing other buttons to current state"),e.not(z).state(o.is.active()?"activate":"deactivate")},get:{text:function(){return u.selector.text?z.find(u.selector.text).text():z.html()},textFor:function(v){return l[v]||!1}},flash:{text:function(y,x,v){var w=o.get.text();o.debug("Flashing text message",y,x),y=y||u.text.flash,x=x||u.flashDuration,v=v||function(){},o.update.text(y),setTimeout(function(){o.update.text(w),v.call(D)},x)}},reset:{text:function(){var w=l.active||z.data(E.storedText),v=l.inactive||z.data(E.storedText);o.is.textEnabled()&&(o.is.active()&&w?(o.verbose("Resetting active text",w),o.update.text(w)):v&&(o.verbose("Resetting inactive text",w),o.update.text(v)))}},update:{text:function(w){var v=o.get.text();w&&w!==v?(o.debug("Updating text",w),u.selector.text?z.data(E.storedText,w).find(u.selector.text).text(w):z.data(E.storedText,w).html(w)):o.debug("Text is already set, ignoring update",w)}},setting:function(w,v){if(o.debug("Changing setting",w,v),d.isPlainObject(w)){d.extend(!0,u,w)}else{if(v===b){return u[w]}u[w]=v}},internal:function(w,v){if(d.isPlainObject(w)){d.extend(!0,o,w)}else{if(v===b){return o[w]}o[w]=v}},debug:function(){u.debug&&(u.performance?o.performance.log(arguments):(o.debug=Function.prototype.bind.call(console.info,console,u.name+":"),o.debug.apply(console,arguments)))},verbose:function(){u.verbose&&u.debug&&(u.performance?o.performance.log(arguments):(o.verbose=Function.prototype.bind.call(console.info,console,u.name+":"),o.verbose.apply(console,arguments)))},error:function(){o.error=Function.prototype.bind.call(console.error,console,u.name+":"),o.error.apply(console,arguments)},performance:{log:function(y){var x,v,w;u.performance&&(x=(new Date).getTime(),w=a||x,v=x-w,a=x,k.push({Name:y[0],Arguments:[].slice.call(y,1)||"",Element:D,"Execution Time":v})),clearTimeout(o.performance.timer),o.performance.timer=setTimeout(o.performance.display,500)},display:function(){var w=u.name+":",v=0;a=!1,clearTimeout(o.performance.timer),d.each(k,function(y,x){v+=x["Execution Time"]}),w+=" "+v+"ms",p&&(w+=" '"+p+"'"),(console.group!==b||console.table!==b)&&k.length>0&&(console.groupCollapsed(w),console.table?console.table(k):d.each(k,function(y,x){console.log(x.Name+": "+x["Execution Time"]+"ms")}),console.groupEnd()),k=[]}},invoke:function(x,F,y){var C,G,w,v=i;return F=F||j,y=D||y,"string"==typeof x&&v!==b&&(x=x.split(/[\. ]/),C=x.length-1,d.each(x,function(H,J){var I=H!=C?J+x[H+1].charAt(0).toUpperCase()+x[H+1].slice(1):x;if(d.isPlainObject(v[I])&&H!=C){v=v[I]}else{if(v[I]!==b){return G=v[I],!1}if(!d.isPlainObject(v[J])||H==C){return v[J]!==b?(G=v[J],!1):(o.error(t.method,x),!1)}v=v[J]}})),d.isFunction(G)?w=G.apply(y,F):G!==b&&(w=G),d.isArray(h)?h.push(w):h!==b?h=[h,w]:w!==b&&(h=w),G}},g?(i===b&&o.initialize(),o.invoke(m)):(i!==b&&i.invoke("destroy"),o.initialize())}),h!==b?h:this},d.fn.state.settings={name:"State",debug:!1,verbose:!1,namespace:"state",performance:!0,onActivate:function(){},onDeactivate:function(){},onChange:function(){},activateTest:function(){return !0},deactivateTest:function(){return !0},automatic:!0,sync:!1,flashDuration:1000,filter:{text:".loading, .disabled",active:".disabled"},context:!1,error:{beforeSend:"The before send function has cancelled state change",method:"The method you called is not defined."},metadata:{promise:"promise",storedText:"stored-text"},className:{active:"active",disabled:"disabled",error:"error",loading:"loading",success:"success",warning:"warning"},selector:{text:!1},defaults:{input:{disabled:!0,loading:!0,active:!0},button:{disabled:!0,loading:!0,active:!0},progress:{active:!0,success:!0,warning:!0,error:!0}},states:{active:!0,disabled:!0,error:!0,loading:!0,success:!0,warning:!0},text:{disabled:!1,flash:!1,hover:!1,active:!1,inactive:!1,activate:!1,deactivate:!1}}}(jQuery,window,document);