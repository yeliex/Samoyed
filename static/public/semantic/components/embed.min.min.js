/*!
 * # Semantic UI x.x - Video
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;(function(h,e,f,g){h.fn.embed=function(a){var c=h(this),o=c.selector||"",q=new Date().getTime(),d=[],n=arguments[0],r=(typeof n=="string"),b=[].slice.call(arguments,1),p;c.each(function(){var J=(h.isPlainObject(a))?h.extend(true,{},h.fn.embed.settings,a):h.extend({},h.fn.embed.settings),K=J.selector,L=J.className,R=J.sources,M=J.error,m=J.metadata,l=J.namespace,I=J.templates,P="."+l,k="module-"+l,j=h(e),H=h(this),F=H.find(K.placeholder),Q=H.find(K.icon),i=H.find(K.embed),N=this,G=H.data(k),O;O={initialize:function(){O.debug("Initializing embed");O.determine.autoplay();O.create();O.bind.events();O.instantiate()},instantiate:function(){O.verbose("Storing instance of module",O);G=O;H.data(k,O)},destroy:function(){O.verbose("Destroying previous instance of embed");O.reset();H.removeData(k).off(P)},refresh:function(){O.verbose("Refreshing selector cache");F=H.find(K.placeholder);Q=H.find(K.icon);i=H.find(K.embed)},bind:{events:function(){if(O.has.placeholder()){O.debug("Adding placeholder events");console.log(H,K.placeholder);H.on("click"+P,K.placeholder,O.createAndShow).on("click"+P,K.icon,O.createAndShow)}}},create:function(){var s=O.get.placeholder();if(s){O.createPlaceholder()}else{O.createAndShow()}},createPlaceholder:function(t){var u=O.get.icon(),v=O.get.url(),s=O.generate.embed(v);t=t||O.get.placeholder();H.html(I.placeholder(t,u));O.debug("Creating placeholder for embed",t,u)},createEmbed:function(s){O.refresh();s=s||O.get.url();console.log(s);i=h("<div/>").addClass(L.embed).html(O.generate.embed(s)).appendTo(H);J.onCreate.call(N,s);O.debug("Creating embed object",i)},createAndShow:function(){console.log("cands");O.createEmbed();O.show()},change:function(t,s,u){O.debug("Changing video to ",t,s,u);H.data(m.source,t).data(m.id,s).data(m.url,u);O.create()},reset:function(){O.debug("Clearing embed and showing placeholder");O.remove.active();O.remove.embed();O.showPlaceholder();J.onReset.call(N)},show:function(){O.debug("Showing embed");O.set.active();J.onDisplay.call(N)},hide:function(){O.debug("Hiding embed");O.showPlaceholder()},showPlaceholder:function(){O.debug("Showing placeholder image");O.remove.active();J.onPlaceholderDisplay.call(N)},get:{id:function(){return J.id||H.data(m.id)},placeholder:function(){return J.placeholder||H.data(m.placeholder)},icon:function(){return(J.icon)?J.icon:(H.data(m.icon)!==g)?H.data(m.icon):O.determine.icon()},source:function(s){return(J.source)?J.source:(H.data(m.source)!==g)?H.data(m.source):O.determine.source()},type:function(){var s=O.get.source();return(R[s]!==g)?R[s].type:false},url:function(){return(J.url)?J.url:(H.data(m.url)!==g)?H.data(m.url):O.determine.url()}},determine:{autoplay:function(){if(O.should.autoplay()){J.autoplay=true}},source:function(t){var s=false;t=t||O.get.url();if(t){h.each(R,function(v,u){if(t.search(u.domain)!==-1){s=v;return false}})}return s},icon:function(){var s=O.get.source();return(R[s]!==g)?R[s].icon:false},url:function(){var s=J.id||H.data(m.id),t=J.source||H.data(m.source),u;u=(R[t]!==g)?R[t].url.replace("{id}",s):false;if(u){H.data(m.url,u)}return u}},set:{active:function(){H.addClass(L.active)}},remove:{active:function(){H.removeClass(L.active)},embed:function(){i.empty()}},encode:{parameters:function(t){var s=[],u;for(u in t){s.push(encodeURIComponent(u)+"="+encodeURIComponent(t[u]))}return s.join("&amp;")}},generate:{embed:function(v){O.debug("Generating embed html");var s=O.get.source(),u,t;v=O.get.url(v);if(v){t=O.generate.parameters(s);u=I.iframe(v,t)}else{O.error(M.noURL,H)}return u},parameters:function(t,s){var u=(R[t]&&R[t].parameters!==g)?R[t].parameters(J):{};s=s||J.parameters;if(s){u=h.extend({},u,s)}u=J.onEmbed(u);return O.encode.parameters(u)}},has:{placeholder:function(){return J.placeholder||H.data(m.placeholder)}},should:{autoplay:function(){return(J.autoplay==="auto")?(J.placeholder||H.data(m.placeholder)!==g):J.autoplay}},is:{video:function(){return O.get.type()=="video"}},setting:function(t,s){O.debug("Changing setting",t,s);if(h.isPlainObject(t)){h.extend(true,J,t)}else{if(s!==g){J[t]=s}else{return J[t]}}},internal:function(t,s){if(h.isPlainObject(t)){h.extend(true,O,t)}else{if(s!==g){O[t]=s}else{return O[t]}}},debug:function(){if(J.debug){if(J.performance){O.performance.log(arguments)}else{O.debug=Function.prototype.bind.call(console.info,console,J.name+":");O.debug.apply(console,arguments)}}},verbose:function(){if(J.verbose&&J.debug){if(J.performance){O.performance.log(arguments)}else{O.verbose=Function.prototype.bind.call(console.info,console,J.name+":");O.verbose.apply(console,arguments)}}},error:function(){O.error=Function.prototype.bind.call(console.error,console,J.name+":");O.error.apply(console,arguments)},performance:{log:function(t){var u,s,v;if(J.performance){u=new Date().getTime();v=q||u;s=u-v;q=u;d.push({Name:t[0],Arguments:[].slice.call(t,1)||"",Element:N,"Execution Time":s})}clearTimeout(O.performance.timer);O.performance.timer=setTimeout(O.performance.display,500)},display:function(){var s=J.name+":",t=0;q=false;clearTimeout(O.performance.timer);h.each(d,function(v,u){t+=u["Execution Time"]});s+=" "+t+"ms";if(o){s+=" '"+o+"'"}if(c.length>1){s+=" ("+c.length+")"}if((console.group!==g||console.table!==g)&&d.length>0){console.groupCollapsed(s);if(console.table){console.table(d)}else{h.each(d,function(v,u){console.log(u.Name+": "+u["Execution Time"]+"ms")})}console.groupEnd()}d=[]}},invoke:function(t,x,v){var w=G,s,u,y;x=x||b;v=N||v;if(typeof t=="string"&&w!==g){t=t.split(/[\. ]/);s=t.length-1;h.each(t,function(z,A){var B=(z!=s)?A+t[z+1].charAt(0).toUpperCase()+t[z+1].slice(1):t;if(h.isPlainObject(w[B])&&(z!=s)){w=w[B]}else{if(w[B]!==g){u=w[B];return false}else{if(h.isPlainObject(w[A])&&(z!=s)){w=w[A]}else{if(w[A]!==g){u=w[A];return false}else{O.error(M.method,t);return false}}}}})}if(h.isFunction(u)){y=u.apply(v,x)}else{if(u!==g){y=u}}if(h.isArray(p)){p.push(y)}else{if(p!==g){p=[p,y]}else{if(y!==g){p=y}}}return u}};if(r){if(G===g){O.initialize()}O.invoke(n)}else{if(G!==g){G.invoke("destroy")}O.initialize()}});return(p!==g)?p:this};h.fn.embed.settings={name:"Embed",namespace:"embed",debug:false,verbose:false,performance:true,icon:false,source:false,url:false,id:false,autoplay:"auto",color:"#444444",hd:true,brandedUI:false,parameters:false,onDisplay:function(){},onPlaceholderDisplay:function(){},onReset:function(){},onCreate:function(a){},onEmbed:function(a){return a},metadata:{id:"id",icon:"icon",placeholder:"placeholder",source:"source",url:"url"},error:{noURL:"No URL specified",method:"The method you called is not defined"},className:{active:"active",embed:"embed"},selector:{embed:".embed",placeholder:".placeholder",icon:".icon"},sources:{youtube:{name:"youtube",type:"video",icon:"video play",domain:"youtube.com",url:"//www.youtube.com/embed/{id}",parameters:function(a){return{autohide:!a.brandedUI,autoplay:a.autoplay,color:a.colors||g,hq:a.hd,jsapi:a.api,modestbranding:!a.brandedUI}}},vimeo:{name:"vimeo",type:"video",icon:"video play",domain:"vimeo.com",url:"//player.vimeo.com/video/{id}",parameters:function(a){return{api:a.api,autoplay:a.autoplay,byline:a.brandedUI,color:a.colors||g,portrait:a.brandedUI,title:a.brandedUI}}}},templates:{iframe:function(b,a){return'<iframe src="'+b+"?="+a+'" width="100%" height="100%" frameborder="0" scrolling="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},placeholder:function(a,b){var c="";if(b){c+='<i class="'+b+' icon"></i>'}if(a){c+='<img class="placeholder" src="'+a+'">'}return c}},api:true,onPause:function(){},onPlay:function(){},onStop:function(){}}})(jQuery,window,document);