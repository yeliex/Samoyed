/*!
 * # Semantic UI x.x - Sticky
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;!function(b,a,c,d){b.fn.sticky=function(g){var k,t=b(this),e=t.selector||"",p=(new Date).getTime(),j=[],q=arguments[0],h="string"==typeof q,n=[].slice.call(arguments,1);return t.each(function(){var K,J,B,r,A=b.isPlainObject(g)?b.extend(!0,{},b.fn.sticky.settings,g):b.extend({},b.fn.sticky.settings),F=A.className,i=A.namespace,I=A.error,G="."+i,f="module-"+i,o=b(this),E=b(a),m=b(A.scrollContext),H=(o.selector||"",o.data(f)),l=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame||function(s){setTimeout(s,0)},D=this;r={initialize:function(){r.determineContainer(),r.determineContext(),r.verbose("Initializing sticky",A,K),r.save.positions(),r.checkErrors(),r.bind.events(),A.observeChanges&&r.observeChanges(),r.instantiate()},instantiate:function(){r.verbose("Storing instance of module",r),H=r,o.data(f,r)},destroy:function(){r.verbose("Destroying previous instance"),r.reset(),B&&B.disconnect(),E.off("load"+G,r.event.load).off("resize"+G,r.event.resize),m.off("scrollchange"+G,r.event.scrollchange),o.removeData(f)},observeChanges:function(){var s=J[0];"MutationObserver" in a&&(B=new MutationObserver(function(u){clearTimeout(r.timer),r.timer=setTimeout(function(){r.verbose("DOM tree modified, updating sticky menu",u),r.refresh()},100)}),B.observe(D,{childList:!0,subtree:!0}),B.observe(s,{childList:!0,subtree:!0}),r.debug("Setting up mutation observer",B))},determineContainer:function(){K=o.offsetParent()},determineContext:function(){return J=A.context?b(A.context):K,0===J.length?void r.error(I.invalidContext,A.context,o):void 0},checkErrors:function(){return r.is.hidden()&&r.error(I.visible,o),r.cache.element.height>r.cache.context.height?(r.reset(),void r.error(I.elementSize,o)):void 0},bind:{events:function(){E.on("load"+G,r.event.load).on("resize"+G,r.event.resize),m.off("scroll"+G).on("scroll"+G,r.event.scroll).on("scrollchange"+G,r.event.scrollchange)}},event:{load:function(){r.verbose("Page contents finished loading"),l(r.refresh)},resize:function(){r.verbose("Window resized"),l(r.refresh)},scroll:function(){l(function(){m.triggerHandler("scrollchange"+G,m.scrollTop())})},scrollchange:function(u,s){r.stick(s),A.onScroll.call(D)}},refresh:function(s){r.reset(),A.context||r.determineContext(),s&&r.determineContainer(),r.save.positions(),r.stick(),A.onReposition.call(D)},supports:{sticky:function(){var s=b("<div/>");s[0];return s.addClass(F.supported),s.css("position").match("sticky")}},save:{lastScroll:function(s){r.lastScroll=s},elementScroll:function(s){r.elementScroll=s},positions:function(){var u={height:E.height()},s={margin:{top:parseInt(o.css("margin-top"),10),bottom:parseInt(o.css("margin-bottom"),10)},offset:o.offset(),width:o.outerWidth(),height:o.outerHeight()},v={offset:J.offset(),height:J.outerHeight(),bottomPadding:parseInt(J.css("padding-bottom"),10)};({height:K.outerHeight()});r.cache={fits:s.height<u.height,window:{height:u.height},element:{margin:s.margin,top:s.offset.top-s.margin.top,left:s.offset.left,width:s.width,height:s.height,bottom:s.offset.top+s.height},context:{top:v.offset.top,height:v.height,bottomPadding:v.bottomPadding,bottom:v.offset.top+v.height-v.bottomPadding}},r.set.containerSize(),r.set.size(),r.stick(),r.debug("Caching element positions",r.cache)}},get:{direction:function(u){var s="down";return u=u||m.scrollTop(),r.lastScroll!==d&&(r.lastScroll<u?s="down":r.lastScroll>u&&(s="up")),s},scrollChange:function(s){return s=s||m.scrollTop(),r.lastScroll?s-r.lastScroll:0},currentElementScroll:function(){return r.elementScroll?r.elementScroll:r.is.top()?Math.abs(parseInt(o.css("top"),10))||0:Math.abs(parseInt(o.css("bottom"),10))||0},elementScroll:function(y){y=y||m.scrollTop();var v=r.cache.element,z=r.cache.window,C=r.get.scrollChange(y),u=v.height-z.height+A.offset,w=r.get.currentElementScroll(),x=w+C;return w=r.cache.fits||0>x?0:x>u?u:x}},remove:{lastScroll:function(){delete r.lastScroll},elementScroll:function(s){delete r.elementScroll},offset:function(){o.css("margin-top","")}},set:{offset:function(){r.verbose("Setting offset on element",A.offset),o.css("margin-top",A.offset)},containerSize:function(){var s=K.get(0).tagName;"HTML"===s||"body"==s?r.determineContainer():Math.abs(K.outerHeight()-r.cache.context.height)>A.jitter&&(r.debug("Context has padding, specifying exact height for container",r.cache.context.height),K.css({height:r.cache.context.height}))},minimumSize:function(){var s=r.cache.element;K.css("min-height",s.height)},scroll:function(s){r.debug("Setting scroll on element",s),r.elementScroll!=s&&(r.is.top()&&o.css("bottom","").css("top",-s),r.is.bottom()&&o.css("top","").css("bottom",s))},size:function(){0!==r.cache.element.height&&0!==r.cache.element.width&&o.css({width:r.cache.element.width,height:r.cache.element.height})}},is:{top:function(){return o.hasClass(F.top)},bottom:function(){return o.hasClass(F.bottom)},initialPosition:function(){return !r.is.fixed()&&!r.is.bound()},hidden:function(){return !o.is(":visible")},bound:function(){return o.hasClass(F.bound)},fixed:function(){return o.hasClass(F.fixed)}},stick:function(C){var N=C||m.scrollTop(),v=r.cache,w=v.fits,z=v.element,O=v.window,u=v.context,L=r.is.bottom()&&A.pushing?A.bottomOffset:A.offset,C={top:N+L,bottom:N+L+O.height},y=(r.get.direction(C.top),w?0:r.get.elementScroll(C.top)),M=!w,x=0!==z.height;x&&(r.is.initialPosition()?C.top>u.bottom?(r.debug("Element bottom of container"),r.bindBottom()):C.top>z.top&&(r.debug("Element passed, fixing element to page"),r.fixTop()):r.is.fixed()?r.is.top()?C.top<z.top?(r.debug("Fixed element reached top of container"),r.setInitialPosition()):z.height+C.top-y>u.bottom?(r.debug("Fixed element reached bottom of container"),r.bindBottom()):M&&r.set.scroll(y):r.is.bottom()&&(C.bottom-z.height<z.top?(r.debug("Bottom fixed rail has reached top of container"),r.setInitialPosition()):C.bottom>u.bottom?(r.debug("Bottom fixed rail has reached bottom of container"),r.bindBottom()):M&&r.set.scroll(y)):r.is.bottom()&&(A.pushing?r.is.bound()&&C.bottom<u.bottom&&(r.debug("Fixing bottom attached element to bottom of browser."),r.fixBottom()):r.is.bound()&&C.top<u.bottom-z.height&&(r.debug("Fixing bottom attached element to top of browser."),r.fixTop()))),r.save.lastScroll(C.top),r.save.elementScroll(y)},bindTop:function(){r.debug("Binding element to top of parent container"),r.remove.offset(),o.css({left:"",top:"",marginBottom:""}).removeClass(F.fixed).removeClass(F.bottom).addClass(F.bound).addClass(F.top),A.onTop.call(D),A.onUnstick.call(D)},bindBottom:function(){r.debug("Binding element to bottom of parent container"),r.remove.offset(),o.css({left:"",top:"",marginBottom:r.cache.context.bottomPadding}).removeClass(F.fixed).removeClass(F.top).addClass(F.bound).addClass(F.bottom),A.onBottom.call(D),A.onUnstick.call(D)},setInitialPosition:function(){r.unfix(),r.unbind()},fixTop:function(){r.debug("Fixing element to top of page"),r.set.minimumSize(),r.set.offset(),o.css({left:r.cache.element.left,bottom:"",marginBottom:""}).removeClass(F.bound).removeClass(F.bottom).addClass(F.fixed).addClass(F.top),A.onStick.call(D)},fixBottom:function(){r.debug("Sticking element to bottom of page"),r.set.minimumSize(),r.set.offset(),o.css({left:r.cache.element.left,bottom:"",marginBottom:""}).removeClass(F.bound).removeClass(F.top).addClass(F.fixed).addClass(F.bottom),A.onStick.call(D)},unbind:function(){r.debug("Removing absolute position on element"),r.remove.offset(),o.removeClass(F.bound).removeClass(F.top).removeClass(F.bottom)},unfix:function(){r.debug("Removing fixed position on element"),r.remove.offset(),o.removeClass(F.fixed).removeClass(F.top).removeClass(F.bottom),A.onUnstick.call(D)},reset:function(){r.debug("Reseting elements position"),r.unbind(),r.unfix(),r.resetCSS(),r.remove.offset(),r.remove.lastScroll()},resetCSS:function(){o.css({width:"",height:""}),K.css({height:""})},setting:function(s,u){if(b.isPlainObject(s)){b.extend(!0,A,s)}else{if(u===d){return A[s]}A[s]=u}},internal:function(s,u){if(b.isPlainObject(s)){b.extend(!0,r,s)}else{if(u===d){return r[s]}r[s]=u}},debug:function(){A.debug&&(A.performance?r.performance.log(arguments):(r.debug=Function.prototype.bind.call(console.info,console,A.name+":"),r.debug.apply(console,arguments)))},verbose:function(){A.verbose&&A.debug&&(A.performance?r.performance.log(arguments):(r.verbose=Function.prototype.bind.call(console.info,console,A.name+":"),r.verbose.apply(console,arguments)))},error:function(){r.error=Function.prototype.bind.call(console.error,console,A.name+":"),r.error.apply(console,arguments)},performance:{log:function(u){var s,v,w;A.performance&&(s=(new Date).getTime(),w=p||s,v=s-w,p=s,j.push({Name:u[0],Arguments:[].slice.call(u,1)||"",Element:D,"Execution Time":v})),clearTimeout(r.performance.timer),r.performance.timer=setTimeout(r.performance.display,0)},display:function(){var s=A.name+":",u=0;p=!1,clearTimeout(r.performance.timer),b.each(j,function(w,v){u+=v["Execution Time"]}),s+=" "+u+"ms",e&&(s+=" '"+e+"'"),(console.group!==d||console.table!==d)&&j.length>0&&(console.groupCollapsed(s),console.table?console.table(j):b.each(j,function(w,v){console.log(v.Name+": "+v["Execution Time"]+"ms")}),console.groupEnd()),j=[]}},invoke:function(w,z,x){var y,C,v,u=H;return z=z||n,x=D||x,"string"==typeof w&&u!==d&&(w=w.split(/[\. ]/),y=w.length-1,b.each(w,function(N,L){var M=N!=y?L+w[N+1].charAt(0).toUpperCase()+w[N+1].slice(1):w;if(b.isPlainObject(u[M])&&N!=y){u=u[M]}else{if(u[M]!==d){return C=u[M],!1}if(!b.isPlainObject(u[L])||N==y){return u[L]!==d?(C=u[L],!1):!1}u=u[L]}})),b.isFunction(C)?v=C.apply(x,z):C!==d&&(v=C),b.isArray(k)?k.push(v):k!==d?k=[k,v]:v!==d&&(k=v),C}},h?(H===d&&r.initialize(),r.invoke(q)):(H!==d&&H.invoke("destroy"),r.initialize())}),k!==d?k:this},b.fn.sticky.settings={name:"Sticky",namespace:"sticky",debug:!1,verbose:!0,performance:!0,pushing:!1,context:!1,scrollContext:a,offset:0,bottomOffset:0,jitter:5,observeChanges:!1,onReposition:function(){},onScroll:function(){},onStick:function(){},onUnstick:function(){},onTop:function(){},onBottom:function(){},error:{container:"Sticky element must be inside a relative container",visible:"Element is hidden, you must call refresh after element becomes visible",method:"The method you called is not defined.",invalidContext:"Context specified does not exist",elementSize:"Sticky element is larger than its container, cannot create sticky."},className:{bound:"bound",fixed:"fixed",supported:"native",top:"top",bottom:"bottom"}}}(jQuery,window,document);