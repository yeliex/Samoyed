/*!
 * # Semantic UI x.x - Visibility
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;!function(b,c,d,a){b.fn.visibility=function(h){var p,m=b(this),e=m.selector||"",n=(new Date).getTime(),g=[],o=arguments[0],k="string"==typeof o,j=[].slice.call(arguments,1);return m.each(function(){var D,F,q,A=b.isPlainObject(h)?b.extend(!0,{},b.fn.visibility.settings,h):b.extend({},b.fn.visibility.settings),i=A.className,H=A.namespace,w=A.error,z=A.metadata,G="."+H,f="module-"+H,E=b(c),l=b(this),u=b(A.context),t=(l.selector||"",l.data(f)),s=c.requestAnimationFrame||c.mozRequestAnimationFrame||c.webkitRequestAnimationFrame||c.msRequestAnimationFrame||function(v){setTimeout(v,0)},r=this,B=!1;q={initialize:function(){q.debug("Initializing",A),q.setup.cache(),q.should.trackChanges()&&("image"==A.type&&q.setup.image(),"fixed"==A.type&&q.setup.fixed(),A.observeChanges&&q.observeChanges(),q.bind.events()),q.save.position(),q.is.visible()||q.error(w.visible,l),A.initialCheck&&q.checkVisibility(),q.instantiate()},instantiate:function(){q.debug("Storing instance",q),l.data(f,q),t=q},destroy:function(){q.verbose("Destroying previous module"),F&&F.disconnect(),E.off("load"+G,q.event.load).off("resize"+G,q.event.resize),u.off("scrollchange"+G,q.event.scrollchange),l.off(G).removeData(f)},observeChanges:function(){"MutationObserver" in c&&(F=new MutationObserver(function(v){q.verbose("DOM tree modified, updating visibility calculations"),q.timer=setTimeout(function(){q.verbose("DOM tree modified, updating sticky menu"),q.refresh()},100)}),F.observe(r,{childList:!0,subtree:!0}),q.debug("Setting up mutation observer",F))},bind:{events:function(){q.verbose("Binding visibility events to scroll and resize"),A.refreshOnLoad&&E.on("load"+G,q.event.load),E.on("resize"+G,q.event.resize),u.off("scroll"+G).on("scroll"+G,q.event.scroll).on("scrollchange"+G,q.event.scrollchange)}},event:{resize:function(){q.debug("Window resized"),A.refreshOnResize&&s(q.refresh)},load:function(){q.debug("Page finished loading"),s(q.refresh)},scroll:function(){A.throttle?(clearTimeout(q.timer),q.timer=setTimeout(function(){u.triggerHandler("scrollchange"+G,[u.scrollTop()])},A.throttle)):s(function(){u.triggerHandler("scrollchange"+G,[u.scrollTop()])})},scrollchange:function(v,x){q.checkVisibility(x)}},precache:function(J,y){J instanceof Array||(J=[J]);for(var x=J.length,C=0,K=[],I=d.createElement("img"),v=function(){C++,C>=J.length&&b.isFunction(y)&&y()};x--;){I=d.createElement("img"),I.onload=v,I.onerror=v,I.src=J[x],K.push(I)}},enableCallbacks:function(){q.debug("Allowing callbacks to occur"),B=!1},disableCallbacks:function(){q.debug("Disabling all callbacks temporarily"),B=!0},should:{trackChanges:function(){return k?(q.debug("One time query, no need to bind events"),!1):(q.debug("Callbacks being attached"),!0)}},setup:{cache:function(){q.cache={occurred:{},screen:{},element:{}}},image:function(){var v=l.data(z.src);v&&(q.verbose("Lazy loading image",v),A.once=!0,A.observeChanges=!1,A.onOnScreen=function(){q.debug("Image on screen",r),q.precache(v,function(){q.set.image(v)})})},fixed:function(){q.debug("Setting up fixed"),A.once=!1,A.observeChanges=!1,A.initialCheck=!0,A.refreshOnLoad=!0,h.transition||(A.transition=!1),q.create.placeholder(),q.debug("Added placeholder",D),A.onTopPassed=function(){q.debug("Element passed, adding fixed position",l),q.show.placeholder(),q.set.fixed(),A.transition&&b.fn.transition!==a&&l.transition(A.transition,A.duration)},A.onTopPassedReverse=function(){q.debug("Element returned to position, removing fixed",l),q.hide.placeholder(),q.remove.fixed()}}},create:{placeholder:function(){q.verbose("Creating fixed position placeholder"),D=l.clone(!1).css("display","none").addClass(i.placeholder).insertAfter(l)}},show:{placeholder:function(){q.verbose("Showing placeholder"),D.css("display","block").css("visibility","hidden")}},hide:{placeholder:function(){q.verbose("Hiding placeholder"),D.css("display","none").css("visibility","")}},set:{fixed:function(){q.verbose("Setting element to fixed position"),l.addClass(i.fixed).css({position:"fixed",top:A.offset+"px",left:"auto",zIndex:"1"})},image:function(v){l.attr("src",v),A.transition?b.fn.transition!==a?l.transition(A.transition,A.duration):l.fadeIn(A.duration):l.show()}},is:{onScreen:function(){var v=q.get.elementCalculations();return v.onScreen},offScreen:function(){var v=q.get.elementCalculations();return v.offScreen},visible:function(){return q.cache&&q.cache.element?!(0===q.cache.element.width&&0===q.cache.element.offset.top):!1}},refresh:function(){q.debug("Refreshing constants (width/height)"),"fixed"==A.type&&(q.remove.fixed(),q.remove.occurred()),q.reset(),q.save.position(),A.checkOnRefresh&&q.checkVisibility(),A.onRefresh.call(r)},reset:function(){q.verbose("Reseting all cached values"),b.isPlainObject(q.cache)&&(q.cache.screen={},q.cache.element={})},checkVisibility:function(v){q.verbose("Checking visibility of element",q.cache.element),!B&&q.is.visible()&&(q.save.scroll(v),q.save.calculations(),q.passed(),q.passingReverse(),q.topVisibleReverse(),q.bottomVisibleReverse(),q.topPassedReverse(),q.bottomPassedReverse(),q.onScreen(),q.offScreen(),q.passing(),q.topVisible(),q.bottomVisible(),q.topPassed(),q.bottomPassed(),A.onUpdate&&A.onUpdate.call(r,q.get.elementCalculations()))},passed:function(x,y){var v=q.get.elementCalculations();if(x&&y){A.onPassed[x]=y}else{if(x!==a){return q.get.pixelsPassed(x)>v.pixelsPassed}v.passing&&b.each(A.onPassed,function(C,I){v.bottomVisible||v.pixelsPassed>q.get.pixelsPassed(C)?q.execute(I,C):A.once||q.remove.occurred(I)})}},onScreen:function(x){var y=q.get.elementCalculations(),C=x||A.onOnScreen,v="onScreen";return x&&(q.debug("Adding callback for onScreen",x),A.onOnScreen=x),y.onScreen?q.execute(C,v):A.once||q.remove.occurred(v),x!==a?y.onOnScreen:void 0},offScreen:function(x){var y=q.get.elementCalculations(),C=x||A.onOffScreen,v="offScreen";return x&&(q.debug("Adding callback for offScreen",x),A.onOffScreen=x),y.offScreen?q.execute(C,v):A.once||q.remove.occurred(v),x!==a?y.onOffScreen:void 0},passing:function(x){var y=q.get.elementCalculations(),C=x||A.onPassing,v="passing";return x&&(q.debug("Adding callback for passing",x),A.onPassing=x),y.passing?q.execute(C,v):A.once||q.remove.occurred(v),x!==a?y.passing:void 0},topVisible:function(x){var y=q.get.elementCalculations(),C=x||A.onTopVisible,v="topVisible";return x&&(q.debug("Adding callback for top visible",x),A.onTopVisible=x),y.topVisible?q.execute(C,v):A.once||q.remove.occurred(v),x===a?y.topVisible:void 0},bottomVisible:function(x){var y=q.get.elementCalculations(),C=x||A.onBottomVisible,v="bottomVisible";return x&&(q.debug("Adding callback for bottom visible",x),A.onBottomVisible=x),y.bottomVisible?q.execute(C,v):A.once||q.remove.occurred(v),x===a?y.bottomVisible:void 0},topPassed:function(x){var y=q.get.elementCalculations(),C=x||A.onTopPassed,v="topPassed";return x&&(q.debug("Adding callback for top passed",x),A.onTopPassed=x),y.topPassed?q.execute(C,v):A.once||q.remove.occurred(v),x===a?y.topPassed:void 0},bottomPassed:function(x){var y=q.get.elementCalculations(),C=x||A.onBottomPassed,v="bottomPassed";return x&&(q.debug("Adding callback for bottom passed",x),A.onBottomPassed=x),y.bottomPassed?q.execute(C,v):A.once||q.remove.occurred(v),x===a?y.bottomPassed:void 0},passingReverse:function(x){var y=q.get.elementCalculations(),C=x||A.onPassingReverse,v="passingReverse";return x&&(q.debug("Adding callback for passing reverse",x),A.onPassingReverse=x),y.passing?A.once||q.remove.occurred(v):q.get.occurred("passing")&&q.execute(C,v),x!==a?!y.passing:void 0},topVisibleReverse:function(x){var y=q.get.elementCalculations(),C=x||A.onTopVisibleReverse,v="topVisibleReverse";return x&&(q.debug("Adding callback for top visible reverse",x),A.onTopVisibleReverse=x),y.topVisible?A.once||q.remove.occurred(v):q.get.occurred("topVisible")&&q.execute(C,v),x===a?!y.topVisible:void 0},bottomVisibleReverse:function(x){var y=q.get.elementCalculations(),C=x||A.onBottomVisibleReverse,v="bottomVisibleReverse";return x&&(q.debug("Adding callback for bottom visible reverse",x),A.onBottomVisibleReverse=x),y.bottomVisible?A.once||q.remove.occurred(v):q.get.occurred("bottomVisible")&&q.execute(C,v),x===a?!y.bottomVisible:void 0},topPassedReverse:function(x){var y=q.get.elementCalculations(),C=x||A.onTopPassedReverse,v="topPassedReverse";return x&&(q.debug("Adding callback for top passed reverse",x),A.onTopPassedReverse=x),y.topPassed?A.once||q.remove.occurred(v):q.get.occurred("topPassed")&&q.execute(C,v),x===a?!y.onTopPassed:void 0},bottomPassedReverse:function(x){var y=q.get.elementCalculations(),C=x||A.onBottomPassedReverse,v="bottomPassedReverse";return x&&(q.debug("Adding callback for bottom passed reverse",x),A.onBottomPassedReverse=x),y.bottomPassed?A.once||q.remove.occurred(v):q.get.occurred("bottomPassed")&&q.execute(C,v),x===a?!y.bottomPassed:void 0},execute:function(x,y){var C=q.get.elementCalculations(),v=q.get.screenCalculations();x=x||!1,x&&(A.continuous?(q.debug("Callback being called continuously",y,C),x.call(r,C,v)):q.get.occurred(y)||(q.debug("Conditions met",y,C),x.call(r,C,v))),q.save.occurred(y)},remove:{fixed:function(){q.debug("Removing fixed position"),l.removeClass(i.fixed).css({position:"",top:"",left:"",zIndex:""})},occurred:function(v){if(v){var x=q.cache.occurred;x[v]!==a&&x[v]===!0&&(q.debug("Callback can now be called again",v),q.cache.occurred[v]=!1)}else{q.cache.occurred={}}}},save:{calculations:function(){q.verbose("Saving all calculations necessary to determine positioning"),q.save.direction(),q.save.screenCalculations(),q.save.elementCalculations()},occurred:function(v){v&&(q.cache.occurred[v]===a||q.cache.occurred[v]!==!0)&&(q.verbose("Saving callback occurred",v),q.cache.occurred[v]=!0)},scroll:function(v){v=v+A.offset||u.scrollTop()+A.offset,q.cache.scroll=v},direction:function(){var v,x=q.get.scroll(),y=q.get.lastScroll();return v=x>y&&y?"down":y>x&&y?"up":"static",q.cache.direction=v,q.cache.direction},elementPosition:function(){var v=q.cache.element,x=q.get.screenSize();return q.verbose("Saving element position"),v.fits=v.height<x.height,v.offset=l.offset(),v.width=l.outerWidth(),v.height=l.outerHeight(),q.cache.element=v,v},elementCalculations:function(){var v=q.get.screenCalculations(),x=q.get.elementPosition();return A.includeMargin?(x.margin={},x.margin.top=parseInt(l.css("margin-top"),10),x.margin.bottom=parseInt(l.css("margin-bottom"),10),x.top=x.offset.top-x.margin.top,x.bottom=x.offset.top+x.height+x.margin.bottom):(x.top=x.offset.top,x.bottom=x.offset.top+x.height),x.topVisible=v.bottom>=x.top,x.topPassed=v.top>=x.top,x.bottomVisible=v.bottom>=x.bottom,x.bottomPassed=v.top>=x.bottom,x.pixelsPassed=0,x.percentagePassed=0,x.onScreen=x.topVisible&&!x.bottomPassed,x.passing=x.topPassed&&!x.bottomPassed,x.offScreen=!x.onScreen,x.passing&&(x.pixelsPassed=v.top-x.top,x.percentagePassed=(v.top-x.top)/x.height),q.cache.element=x,q.verbose("Updated element calculations",x),x},screenCalculations:function(){var v=q.get.scroll();return q.save.direction(),q.cache.screen.top=v,q.cache.screen.bottom=v+q.cache.screen.height,q.cache.screen},screenSize:function(){q.verbose("Saving window position"),q.cache.screen={height:u.height()}},position:function(){q.save.screenSize(),q.save.elementPosition()}},get:{pixelsPassed:function(v){var x=q.get.elementCalculations();return v.search("%")>-1?x.height*(parseInt(v,10)/100):parseInt(v,10)},occurred:function(v){return q.cache.occurred!==a?q.cache.occurred[v]||!1:!1},direction:function(){return q.cache.direction===a&&q.save.direction(),q.cache.direction},elementPosition:function(){return q.cache.element===a&&q.save.elementPosition(),q.cache.element},elementCalculations:function(){return q.cache.element===a&&q.save.elementCalculations(),q.cache.element},screenCalculations:function(){return q.cache.screen===a&&q.save.screenCalculations(),q.cache.screen},screenSize:function(){return q.cache.screen===a&&q.save.screenSize(),q.cache.screen},scroll:function(){return q.cache.scroll===a&&q.save.scroll(),q.cache.scroll},lastScroll:function(){return q.cache.screen===a?(q.debug("First scroll event, no last scroll could be found"),!1):q.cache.screen.top}},setting:function(v,x){if(b.isPlainObject(v)){b.extend(!0,A,v)}else{if(x===a){return A[v]}A[v]=x}},internal:function(v,x){if(b.isPlainObject(v)){b.extend(!0,q,v)}else{if(x===a){return q[v]}q[v]=x}},debug:function(){A.debug&&(A.performance?q.performance.log(arguments):(q.debug=Function.prototype.bind.call(console.info,console,A.name+":"),q.debug.apply(console,arguments)))},verbose:function(){A.verbose&&A.debug&&(A.performance?q.performance.log(arguments):(q.verbose=Function.prototype.bind.call(console.info,console,A.name+":"),q.verbose.apply(console,arguments)))},error:function(){q.error=Function.prototype.bind.call(console.error,console,A.name+":"),q.error.apply(console,arguments)},performance:{log:function(x){var y,C,v;A.performance&&(y=(new Date).getTime(),v=n||y,C=y-v,n=y,g.push({Name:x[0],Arguments:[].slice.call(x,1)||"",Element:r,"Execution Time":C})),clearTimeout(q.performance.timer),q.performance.timer=setTimeout(q.performance.display,500)},display:function(){var v=A.name+":",x=0;n=!1,clearTimeout(q.performance.timer),b.each(g,function(y,C){x+=C["Execution Time"]}),v+=" "+x+"ms",e&&(v+=" '"+e+"'"),(console.group!==a||console.table!==a)&&g.length>0&&(console.groupCollapsed(v),console.table?console.table(g):b.each(g,function(y,C){console.log(C.Name+": "+C["Execution Time"]+"ms")}),console.groupEnd()),g=[]}},invoke:function(I,K,y){var J,C,x,v=t;return K=K||j,y=r||y,"string"==typeof I&&v!==a&&(I=I.split(/[\. ]/),J=I.length-1,b.each(I,function(N,L){var M=N!=J?L+I[N+1].charAt(0).toUpperCase()+I[N+1].slice(1):I;if(b.isPlainObject(v[M])&&N!=J){v=v[M]}else{if(v[M]!==a){return C=v[M],!1}if(!b.isPlainObject(v[L])||N==J){return v[L]!==a?(C=v[L],!1):(q.error(w.method,I),!1)}v=v[L]}})),b.isFunction(C)?x=C.apply(y,K):C!==a&&(x=C),b.isArray(p)?p.push(x):p!==a?p=[p,x]:x!==a&&(p=x),C}},k?(t===a&&q.initialize(),t.save.scroll(),t.save.calculations(),q.invoke(o)):(t!==a&&t.invoke("destroy"),q.initialize())}),p!==a?p:this},b.fn.visibility.settings={name:"Visibility",namespace:"visibility",debug:!1,verbose:!1,performance:!0,observeChanges:!0,refreshOnLoad:!0,once:!0,continuous:!1,offset:0,includeMargin:!1,context:c,initialCheck:!0,throttle:!1,type:!1,transition:"fade in",duration:1000,onPassed:{},checkOnRefresh:!0,onOnScreen:!1,onOffScreen:!1,onPassing:!1,onTopVisible:!1,onBottomVisible:!1,onTopPassed:!1,onBottomPassed:!1,onPassingReverse:!1,onTopVisibleReverse:!1,onBottomVisibleReverse:!1,onTopPassedReverse:!1,onBottomPassedReverse:!1,onUpdate:!1,onRefresh:function(){},metadata:{src:"src"},className:{fixed:"fixed",placeholder:"placeholder"},error:{method:"The method you called is not defined.",visible:"Element is hidden, you must call refresh after element becomes visible"}}}(jQuery,window,document);