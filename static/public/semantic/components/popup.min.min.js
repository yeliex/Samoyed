/*!
 * # Semantic UI x.x - Popup
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;!function(a,b,c,d){a.fn.popup=function(o){var e,y=a(this),A=a(c),j=a(b),n=a("body"),z=y.selector||"",x="ontouchstart" in c.documentElement,w=(new Date).getTime(),v=[],t=arguments[0],q="string"==typeof t,k=[].slice.call(arguments,1);return y.each(function(){var N,W,B,V,u,m=a.isPlainObject(o)?a.extend(!0,{},a.fn.popup.settings,o):a.extend({},a.fn.popup.settings),f=m.selector,i=m.className,L=m.error,Q=m.metadata,r=m.namespace,g="."+m.namespace,J="module-"+r,K=a(this),l=a(m.context),U=m.target?a(m.target):K,M=0,h=!1,G=!1,s=this,p=K.data(J);u={initialize:function(){u.debug("Initializing",K),u.createID(),u.bind.events(),!u.exists()&&m.preserve&&u.create(),u.instantiate()},instantiate:function(){u.verbose("Storing instance",u),p=u,K.data(J,p)},refresh:function(){m.popup?N=a(m.popup).eq(0):m.inline&&(N=U.next(f.popup).eq(0),m.popup=N),m.popup?(N.addClass(i.loading),W=u.get.offsetParent(),N.removeClass(i.loading),m.movePopup&&u.has.popup()&&u.get.offsetParent(N)[0]!==W[0]&&(u.debug("Moving popup to the same offset parent as activating element"),N.detach().appendTo(W))):W=m.inline?u.get.offsetParent(U):u.has.popup()?u.get.offsetParent(N):n,W.is("html")&&(u.debug("Setting page as offset parent"),W=n)},reposition:function(){u.refresh(),u.set.position()},destroy:function(){u.debug("Destroying previous module"),N&&!m.preserve&&u.removePopup(),clearTimeout(u.hideTimer),clearTimeout(u.showTimer),j.off(B),K.off(g).removeData(J)},event:{start:function(C){var D=a.isPlainObject(m.delay)?m.delay.show:m.delay;clearTimeout(u.hideTimer),u.showTimer=setTimeout(u.show,D)},end:function(){var C=a.isPlainObject(m.delay)?m.delay.hide:m.delay;clearTimeout(u.showTimer),u.hideTimer=setTimeout(u.hide,C)},touchstart:function(C){G=!0,u.event.start()},resize:function(){u.is.visible()&&u.set.position()},hideGracefully:function(C){C&&0===a(C.target).closest(f.popup).length?(u.debug("Click occurred outside popup hiding popup"),u.hide()):u.debug("Click was inside popup, keeping popup open")}},create:function(){var E=u.get.html(),F=u.get.variation(),C=u.get.title(),D=u.get.content();E||D||C?(u.debug("Creating pop-up html"),E||(E=m.templates.popup({title:C,content:D})),N=a("<div/>").addClass(i.popup).addClass(F).data(Q.activator,K).html(E),F&&N.addClass(F),m.inline?(u.verbose("Inserting popup element inline",N),N.insertAfter(K)):(u.verbose("Appending popup element to body",N),N.appendTo(l)),u.refresh(),m.hoverable&&u.bind.popup(),m.onCreate.call(N,s)):0!==U.next(f.popup).length?(u.verbose("Pre-existing popup found"),m.inline=!0,m.popups=U.next(f.popup).data(Q.activator,K),u.refresh(),m.hoverable&&u.bind.popup()):m.popup?(a(m.popup).data(Q.activator,K),u.verbose("Used popup specified in settings"),u.refresh(),m.hoverable&&u.bind.popup()):u.debug("No content specified skipping display",s)},createID:function(){V=(Math.random().toString(16)+"000000000").substr(2,8),B="."+V,u.verbose("Creating unique id for element",V)},toggle:function(){u.debug("Toggling pop-up"),u.is.hidden()?(u.debug("Popup is hidden, showing pop-up"),u.unbind.close(),u.show()):(u.debug("Popup is visible, hiding pop-up"),u.hide())},show:function(C){if(C=C||function(){},u.debug("Showing pop-up",m.transition),u.is.hidden()&&(!u.is.active()||!u.is.dropdown())){if(u.exists()||u.create(),m.onShow.call(N,s)===!1){return void u.debug("onShow callback returned false, cancelling popup animation")}m.preserve||m.popup||u.refresh(),N&&u.set.position()&&(u.save.conditions(),m.exclusive&&u.hideAll(),u.animate.show(C))}},hide:function(C){if(C=C||function(){},u.is.visible()||u.is.animating()){if(m.onHide.call(N,s)===!1){return void u.debug("onHide callback returned false, cancelling popup animation")}u.remove.visible(),u.unbind.close(),u.restore.conditions(),u.animate.hide(C)}},hideAll:function(){a(f.popup).filter("."+i.visible).each(function(){a(this).data(Q.activator).popup("hide")})},exists:function(){return N?m.inline||m.popup?u.has.popup():N.closest(l).length>=1?!0:!1:!1},removePopup:function(){u.debug("Removing popup",N),u.has.popup()&&!m.popup&&(N.remove(),N=d),m.onRemove.call(N,s)},save:{conditions:function(){u.cache={title:K.attr("title")},u.cache.title&&K.removeAttr("title"),u.verbose("Saving original attributes",u.cache.title)}},restore:{conditions:function(){return u.cache&&u.cache.title&&(K.attr("title",u.cache.title),u.verbose("Restoring original attributes",u.cache.title)),!0}},animate:{show:function(C){C=a.isFunction(C)?C:function(){},m.transition&&a.fn.transition!==d&&K.transition("is supported")?(u.set.visible(),N.transition({animation:m.transition+" in",queue:!1,debug:m.debug,verbose:m.verbose,duration:m.duration,onComplete:function(){u.bind.close(),C.call(N,s),m.onVisible.call(N,s)}})):u.error(L.noTransition)},hide:function(C){return C=a.isFunction(C)?C:function(){},u.debug("Hiding pop-up"),m.onShow.call(N,s)===!1?void u.debug("onShow callback returned false, cancelling popup animation"):void (m.transition&&a.fn.transition!==d&&K.transition("is supported")?N.transition({animation:m.transition+" out",queue:!1,duration:m.duration,debug:m.debug,verbose:m.verbose,onComplete:function(){u.reset(),C.call(N,s),m.onHidden.call(N,s)}}):u.error(L.noTransition))}},get:{html:function(){return K.removeData(Q.html),K.data(Q.html)||m.html},title:function(){return K.removeData(Q.title),K.data(Q.title)||m.title},content:function(){return K.removeData(Q.content),K.data(Q.content)||K.attr("title")||m.content},variation:function(){return K.removeData(Q.variation),K.data(Q.variation)||m.variation},calculations:function(){var D,F=U[0],C=m.inline||m.popup?U.position():U.offset(),E={};return E={target:{element:U[0],width:U.outerWidth(),height:U.outerHeight(),top:C.top,left:C.left,margin:{}},popup:{width:N.outerWidth(),height:N.outerHeight()},parent:{width:W.outerWidth(),height:W.outerHeight()},screen:{scroll:{top:j.scrollTop(),left:j.scrollLeft()},width:j.width(),height:j.height()}},E.target.margin.top=m.inline?parseInt(b.getComputedStyle(F).getPropertyValue("margin-top"),10):0,E.target.margin.left=m.inline?u.is.rtl()?parseInt(b.getComputedStyle(F).getPropertyValue("margin-right"),10):parseInt(b.getComputedStyle(F).getPropertyValue("margin-left"),10):0,D=E.screen,E.boundary={top:D.scroll.top,bottom:D.scroll.top+D.height,left:D.scroll.left,right:D.scroll.left+D.width},E},id:function(){return V},startEvent:function(){return"hover"==m.on?"mouseenter":"focus"==m.on?"focus":!1},scrollEvent:function(){return"scroll"},endEvent:function(){return"hover"==m.on?"mouseleave":"focus"==m.on?"blur":!1},offsetParent:function(I){var O=I!==d?I[0]:K[0],D=O.parentNode,F=a(D);if(D){for(var C="none"===F.css("transform"),E="static"===F.css("position"),H=F.is("html");D&&!H&&E&&C;){D=D.parentNode,F=a(D),C="none"===F.css("transform"),E="static"===F.css("position"),H=F.is("html")}}return F&&F.length>0?F:a()},offstagePosition:function(I,O){var D,F,C=N.offset(),E={},H=[];return I=I||!1,O=O||u.get.calculations(),D=O.popup,F=O.boundary,C&&I&&(E={top:C.top<F.top,bottom:C.top+D.height>F.bottom,right:C.left+D.width>F.right,left:C.left<F.left},u.verbose("Offstage positions determined",C,E)),a.each(E,function(P,R){R&&H.push(P)}),H.length>0?H.join(" "):!1},positions:function(){return{"top left":!1,"top center":!1,"top right":!1,"bottom left":!1,"bottom center":!1,"bottom right":!1,"left center":!1,"right center":!1}},nextPosition:function(S){var O=S.split(" "),E=O[0],F=O[1],I={top:"bottom",bottom:"top",left:"right",right:"left"},C={left:"center",center:"right",right:"left"},P={"top left":"top center","top center":"top right","top right":"right center","right center":"bottom right","bottom right":"bottom center","bottom center":"bottom left","bottom left":"left center","left center":"top left"},T="top"==E||"bottom"==E,D=!1,H=!1,R=!1;return h||(u.verbose("All available positions available"),h=u.get.positions()),u.debug("Recording last position tried",S),h[S]=!0,"opposite"===m.prefer&&(R=[I[E],F],R=R.join(" "),D=h[R]===!0,u.debug("Trying opposite strategy",R)),"adjacent"===m.prefer&&T&&(R=[E,C[F]],R=R.join(" "),H=h[R]===!0,u.debug("Trying adjacent strategy",R)),(H||D)&&(u.debug("Using backup position",R),R=P[S]),R}},set:{position:function(P,H){if(0===U.length||0===N.length){return void u.error(L.notFound)}var F,C,I,R,D,E,O;if(H=H||u.get.calculations(),P=P||K.data(Q.position)||m.position,F=K.data(Q.offset)||m.offset,C=m.distanceAway,I=H.target,R=H.popup,D=H.parent,0===I.width&&0===I.height){return u.debug("Popup target is hidden, no action taken"),!1}switch(m.inline&&(u.debug("Adding margin to calculation",I.margin),"left center"==P||"right center"==P?(F+=I.margin.top,C+=-I.margin.left):"top left"==P||"top center"==P||"top right"==P?(F+=I.margin.left,C-=I.margin.top):(F+=I.margin.left,C+=I.margin.top)),u.debug("Determining popup position from calculations",P,H),u.is.rtl()&&(P=P.replace(/left|right/g,function(S){return"left"==S?"right":"left"}),u.debug("RTL: Popup position updated",P)),M==m.maxSearchDepth&&m.lastResort&&(u.debug('Using "last resort" position to display',m.lastResort),P=m.lastResort),P){case"top left":E={top:"auto",bottom:D.height-I.top+C,left:I.left+F,right:"auto"};break;case"top center":E={bottom:D.height-I.top+C,left:I.left+I.width/2-R.width/2+F,top:"auto",right:"auto"};break;case"top right":E={bottom:D.height-I.top+C,right:D.width-I.left-I.width-F,top:"auto",left:"auto"};break;case"left center":E={top:I.top+I.height/2-R.height/2+F,right:D.width-I.left+C,left:"auto",bottom:"auto"};break;case"right center":E={top:I.top+I.height/2-R.height/2+F,left:I.left+I.width+C,bottom:"auto",right:"auto"};break;case"bottom left":E={top:I.top+I.height+C,left:I.left+F,bottom:"auto",right:"auto"};break;case"bottom center":E={top:I.top+I.height+C,left:I.left+I.width/2-R.width/2+F,bottom:"auto",right:"auto"};break;case"bottom right":E={top:I.top+I.height+C,right:D.width-I.left-I.width-F,left:"auto",bottom:"auto"}}if(E===d&&u.error(L.invalidPosition,P),u.debug("Calculated popup positioning values",E),N.css(E).removeClass(i.position).addClass(P).addClass(i.loading),O=u.get.offstagePosition(P,H)){if(u.debug("Popup cant fit into viewport",P,O),M<m.maxSearchDepth){return M++,P=u.get.nextPosition(P),u.debug("Trying new position",P),N?u.set.position(P,H):!1}if(!m.lastResort){return u.debug("Popup could not find a position in view",N),u.remove.attempts(),u.remove.loading(),u.reset(),!1}}return u.debug("Position is on stage",P),u.remove.attempts(),u.set.fluidWidth(H),u.remove.loading(),!0},fluidWidth:function(C){C=C||u.get.calculations(),m.setFluidWidth&&N.hasClass(i.fluid)&&N.css("width",C.parent.width)},visible:function(){K.addClass(i.visible)}},remove:{loading:function(){N.removeClass(i.loading)},visible:function(){K.removeClass(i.visible)},attempts:function(){u.verbose("Resetting all searched positions"),M=0,h=!1}},bind:{events:function(){u.debug("Binding popup events to module"),"click"==m.on&&K.on("click"+g,u.toggle),"hover"==m.on&&x?K.on("touchstart"+g,u.event.touchstart):u.get.startEvent()&&K.on(u.get.startEvent()+g,u.event.start).on(u.get.endEvent()+g,u.event.end),m.target&&u.debug("Target set to element",U),j.on("resize"+B,u.event.resize)},popup:function(){u.verbose("Allowing hover events on popup to prevent closing"),N&&u.has.popup()&&N.on("mouseenter"+g,u.event.start).on("mouseleave"+g,u.event.end)},close:function(){(m.hideOnScroll===!0||"auto"==m.hideOnScroll&&"click"!=m.on)&&(A.one(u.get.scrollEvent()+B,u.event.hideGracefully),l.one(u.get.scrollEvent()+B,u.event.hideGracefully)),"hover"==m.on&&G&&(u.verbose("Binding popup close event to document"),A.on("touchstart"+B,function(C){u.verbose("Touched away from popup"),u.event.hideGracefully.call(s,C)})),"click"==m.on&&m.closable&&(u.verbose("Binding popup close event to document"),A.on("click"+B,function(C){u.verbose("Clicked away from popup"),u.event.hideGracefully.call(s,C)}))}},unbind:{close:function(){(m.hideOnScroll===!0||"auto"==m.hideOnScroll&&"click"!=m.on)&&(A.off("scroll"+B,u.hide),l.off("scroll"+B,u.hide)),"hover"==m.on&&G&&(A.off("touchstart"+B),G=!1),"click"==m.on&&m.closable&&(u.verbose("Removing close event from document"),A.off("click"+B))}},has:{popup:function(){return N&&N.length>0}},is:{active:function(){return K.hasClass(i.active)},animating:function(){return N&&N.hasClass(i.animating)},visible:function(){return N&&N.hasClass(i.visible)},dropdown:function(){return K.hasClass(i.dropdown)},hidden:function(){return !u.is.visible()},rtl:function(){return"rtl"==K.css("direction")}},reset:function(){u.remove.visible(),m.preserve?a.fn.transition!==d&&N.transition("remove transition"):u.removePopup()},setting:function(C,D){if(a.isPlainObject(C)){a.extend(!0,m,C)}else{if(D===d){return m[C]}m[C]=D}},internal:function(C,D){if(a.isPlainObject(C)){a.extend(!0,u,C)}else{if(D===d){return u[C]}u[C]=D}},debug:function(){m.debug&&(m.performance?u.performance.log(arguments):(u.debug=Function.prototype.bind.call(console.info,console,m.name+":"),u.debug.apply(console,arguments)))},verbose:function(){m.verbose&&m.debug&&(m.performance?u.performance.log(arguments):(u.verbose=Function.prototype.bind.call(console.info,console,m.name+":"),u.verbose.apply(console,arguments)))},error:function(){u.error=Function.prototype.bind.call(console.error,console,m.name+":"),u.error.apply(console,arguments)},performance:{log:function(C){var D,E,F;m.performance&&(D=(new Date).getTime(),F=w||D,E=D-F,w=D,v.push({Name:C[0],Arguments:[].slice.call(C,1)||"",Element:s,"Execution Time":E})),clearTimeout(u.performance.timer),u.performance.timer=setTimeout(u.performance.display,500)},display:function(){var C=m.name+":",D=0;w=!1,clearTimeout(u.performance.timer),a.each(v,function(E,F){D+=F["Execution Time"]}),C+=" "+D+"ms",z&&(C+=" '"+z+"'"),(console.group!==d||console.table!==d)&&v.length>0&&(console.groupCollapsed(C),console.table?console.table(v):a.each(v,function(E,F){console.log(F.Name+": "+F["Execution Time"]+"ms")}),console.groupEnd()),v=[]}},invoke:function(I,O,E){var D,F,H,C=p;return O=O||k,E=s||E,"string"==typeof I&&C!==d&&(I=I.split(/[\. ]/),D=I.length-1,a.each(I,function(S,P){var R=S!=D?P+I[S+1].charAt(0).toUpperCase()+I[S+1].slice(1):I;if(a.isPlainObject(C[R])&&S!=D){C=C[R]}else{if(C[R]!==d){return F=C[R],!1}if(!a.isPlainObject(C[P])||S==D){return C[P]!==d?(F=C[P],!1):!1}C=C[P]}})),a.isFunction(F)?H=F.apply(E,O):F!==d&&(H=F),a.isArray(e)?e.push(H):e!==d?e=[e,H]:H!==d&&(e=H),F}},q?(p===d&&u.initialize(),u.invoke(t)):(p!==d&&p.invoke("destroy"),u.initialize())}),e!==d?e:this},a.fn.popup.settings={name:"Popup",debug:!1,verbose:!1,performance:!0,namespace:"popup",onCreate:function(){},onRemove:function(){},onShow:function(){},onVisible:function(){},onHide:function(){},onHidden:function(){},on:"hover",addTouchEvents:!0,position:"top left",variation:"",movePopup:!0,target:!1,popup:!1,inline:!1,preserve:!0,hoverable:!1,content:!1,html:!1,title:!1,closable:!0,hideOnScroll:"auto",exclusive:!1,context:"body",prefer:"opposite",lastResort:!1,delay:{show:50,hide:70},setFluidWidth:!0,duration:200,transition:"scale",distanceAway:0,offset:0,maxSearchDepth:20,error:{invalidPosition:"The position you specified is not a valid position",cannotPlace:"No visible position could be found for the popup",method:"The method you called is not defined.",noTransition:"This module requires ui transitions <https://github.com/Semantic-Org/UI-Transition>",notFound:"The target or popup you specified does not exist on the page"},metadata:{activator:"activator",content:"content",html:"html",offset:"offset",position:"position",title:"title",variation:"variation"},className:{active:"active",animating:"animating",dropdown:"dropdown",fluid:"fluid",loading:"loading",popup:"ui popup",position:"top left center bottom right",visible:"visible"},selector:{popup:".ui.popup"},templates:{escape:function(g){var h=/[&<>"'`]/g,j=/[&<>"'`]/,k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},f=function(e){return k[e]};return j.test(g)?g.replace(h,f):g},popup:function(g){var h="",f=a.fn.popup.settings.templates.escape;return typeof g!==d&&(typeof g.title!==d&&g.title&&(g.title=f(g.title),h+='<div class="header">'+g.title+"</div>"),typeof g.content!==d&&g.content&&(g.content=f(g.content),h+='<div class="content">'+g.content+"</div>")),h}}}}(jQuery,window,document);