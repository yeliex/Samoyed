/*!
 * # Semantic UI x.x - Rating
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;(function(h,e,f,g){h.fn.rating=function(a){var c=h(this),o=c.selector||"",q=new Date().getTime(),d=[],n=arguments[0],r=(typeof n=="string"),b=[].slice.call(arguments,1),p;c.each(function(){var l=(h.isPlainObject(a))?h.extend(true,{},h.fn.rating.settings,a):h.extend({},h.fn.rating.settings),k=l.namespace,F=l.className,C=l.metadata,j=l.selector,E=l.error,A="."+k,H="module-"+k,i=this,B=h(this).data(H),D=h(this),G=D.find(j.icon),m;m={initialize:function(){m.verbose("Initializing rating module",l);if(G.length===0){m.setup.layout()}if(l.interactive){m.enable()}else{m.disable()}m.set.rating(m.get.initialRating());m.instantiate()},instantiate:function(){m.verbose("Instantiating module",l);B=m;D.data(H,m)},destroy:function(){m.verbose("Destroying previous instance",B);m.remove.events();D.removeData(H)},refresh:function(){G=D.find(j.icon)},setup:{layout:function(){var s=m.get.maxRating(),t=h.fn.rating.settings.templates.icon(s);m.debug("Generating icon html dynamically");D.html(t);m.refresh()}},event:{mouseenter:function(){var s=h(this);s.nextAll().removeClass(F.selected);D.addClass(F.selected);s.addClass(F.selected).prevAll().addClass(F.selected)},mouseleave:function(){D.removeClass(F.selected);G.removeClass(F.selected)},click:function(){var t=h(this),u=m.get.rating(),v=G.index(t)+1,s=(l.clearable=="auto")?(G.length===1):l.clearable;if(s&&u==v){m.clearRating()}else{m.set.rating(v)}}},clearRating:function(){m.debug("Clearing current rating");m.set.rating(0)},bind:{events:function(){m.verbose("Binding events");D.on("mouseenter"+A,j.icon,m.event.mouseenter).on("mouseleave"+A,j.icon,m.event.mouseleave).on("click"+A,j.icon,m.event.click)}},remove:{events:function(){m.verbose("Removing events");D.off(A)}},enable:function(){m.debug("Setting rating to interactive mode");m.bind.events();D.removeClass(F.disabled)},disable:function(){m.debug("Setting rating to read-only mode");m.remove.events();D.addClass(F.disabled)},get:{initialRating:function(){if(D.data(C.rating)!==g){D.removeData(C.rating);return D.data(C.rating)}return l.initialRating},maxRating:function(){if(D.data(C.maxRating)!==g){D.removeData(C.maxRating);return D.data(C.maxRating)}return l.maxRating},rating:function(){var s=G.filter("."+F.active).length;m.verbose("Current rating retrieved",s);return s}},set:{rating:function(s){var t=(s-1>=0)?(s-1):0,u=G.eq(t);D.removeClass(F.selected);G.removeClass(F.selected).removeClass(F.active);if(s>0){m.verbose("Setting current rating to",s);u.prevAll().andSelf().addClass(F.active)}l.onRate.call(i,s)}},setting:function(s,t){m.debug("Changing setting",s,t);if(h.isPlainObject(s)){h.extend(true,l,s)}else{if(t!==g){l[s]=t}else{return l[s]}}},internal:function(s,t){if(h.isPlainObject(s)){h.extend(true,m,s)}else{if(t!==g){m[s]=t}else{return m[s]}}},debug:function(){if(l.debug){if(l.performance){m.performance.log(arguments)}else{m.debug=Function.prototype.bind.call(console.info,console,l.name+":");m.debug.apply(console,arguments)}}},verbose:function(){if(l.verbose&&l.debug){if(l.performance){m.performance.log(arguments)}else{m.verbose=Function.prototype.bind.call(console.info,console,l.name+":");m.verbose.apply(console,arguments)}}},error:function(){m.error=Function.prototype.bind.call(console.error,console,l.name+":");m.error.apply(console,arguments)},performance:{log:function(u){var v,t,s;if(l.performance){v=new Date().getTime();s=q||v;t=v-s;q=v;d.push({Name:u[0],Arguments:[].slice.call(u,1)||"",Element:i,"Execution Time":t})}clearTimeout(m.performance.timer);m.performance.timer=setTimeout(m.performance.display,500)},display:function(){var t=l.name+":",s=0;q=false;clearTimeout(m.performance.timer);h.each(d,function(v,u){s+=u["Execution Time"]});t+=" "+s+"ms";if(o){t+=" '"+o+"'"}if(c.length>1){t+=" ("+c.length+")"}if((console.group!==g||console.table!==g)&&d.length>0){console.groupCollapsed(t);if(console.table){console.table(d)}else{h.each(d,function(v,u){console.log(u.Name+": "+u["Execution Time"]+"ms")})}console.groupEnd()}d=[]}},invoke:function(u,y,w){var x=B,t,v,s;y=y||b;w=i||w;if(typeof u=="string"&&x!==g){u=u.split(/[\. ]/);t=u.length-1;h.each(u,function(z,K){var L=(z!=t)?K+u[z+1].charAt(0).toUpperCase()+u[z+1].slice(1):u;if(h.isPlainObject(x[L])&&(z!=t)){x=x[L]}else{if(x[L]!==g){v=x[L];return false}else{if(h.isPlainObject(x[K])&&(z!=t)){x=x[K]}else{if(x[K]!==g){v=x[K];return false}else{return false}}}}})}if(h.isFunction(v)){s=v.apply(w,y)}else{if(v!==g){s=v}}if(h.isArray(p)){p.push(s)}else{if(p!==g){p=[p,s]}else{if(s!==g){p=s}}}return v}};if(r){if(B===g){m.initialize()}m.invoke(n)}else{if(B!==g){B.invoke("destroy")}m.initialize()}});return(p!==g)?p:this};h.fn.rating.settings={name:"Rating",namespace:"rating",debug:false,verbose:false,performance:true,initialRating:0,interactive:true,maxRating:4,clearable:"auto",onRate:function(a){},error:{method:"The method you called is not defined",noMaximum:"No maximum rating specified. Cannot generate HTML automatically"},metadata:{rating:"rating",maxRating:"maxRating"},className:{active:"active",disabled:"disabled",selected:"selected",loading:"loading"},selector:{icon:".icon"},templates:{icon:function(c){var a=1,b="";while(a<=c){b+='<i class="icon"></i>';a++}return b}}}})(jQuery,window,document);