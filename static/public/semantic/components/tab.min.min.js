/*!
 * # Semantic UI x.x - Tab
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;!function(d,c,b,f){d.fn.tab=function(j){var e,a=d(d.isFunction(this)?c:this),t=a.selector||"",n=(new Date).getTime(),h=[],m=arguments[0],q="string"==typeof m,p=[].slice.call(arguments,1),k=!1;return a.each(function(){var R,Q,K,M,B,r,g=d.isPlainObject(j)?d.extend(!0,{},d.fn.tab.settings,j):d.extend({},d.fn.tab.settings),o=g.className,u=g.metadata,J=g.selector,l=g.error,H="."+g.namespace,D="module-"+g.namespace,i=d(this),G={},O=!0,N=0,z=this,s=i.data(D);B={initialize:function(){B.debug("Initializing tab menu item",i),B.fix.callbacks(),B.determineTabs(),B.debug("Determining tabs",g.context,Q),g.auto&&B.set.auto(),B.bind.events(),g.history&&!k&&(B.initializeHistory(),k=!0),B.instantiate()},instantiate:function(){B.verbose("Storing instance of module",B),s=B,i.data(D,B)},destroy:function(){B.debug("Destroying tabs",i),i.removeData(D).off(H)},bind:{events:function(){d.isWindow(z)||(B.debug("Attaching tab activation events to element",i),i.on("click"+H,B.event.click))}},determineTabs:function(){var v;"parent"===g.context?(i.closest(J.ui).length>0?(v=i.closest(J.ui),B.verbose("Using closest UI element as parent",v)):v=i,R=v.parent(),B.verbose("Determined parent element for creating context",R)):g.context?(R=d(g.context),B.verbose("Using selector for tab context",g.context,R)):R=d("body"),g.childrenOnly?(Q=R.children(J.tabs),B.debug("Searching tab context children for tabs",R,Q)):(Q=R.find(J.tabs),B.debug("Searching tab context for tabs",R,Q))},fix:{callbacks:function(){d.isPlainObject(j)&&(j.onTabLoad||j.onTabInit)&&(j.onTabLoad&&(j.onLoad=j.onTabLoad,delete j.onTabLoad,B.error(l.legacyLoad,j.onLoad)),j.onTabInit&&(j.onFirstLoad=j.onTabInit,delete j.onTabInit,B.error(l.legacyInit,j.onFirstLoad)),g=d.extend(!0,{},d.fn.tab.settings,j))}},initializeHistory:function(){if(B.debug("Initializing page state"),d.address===f){return B.error(l.state),!1}if("state"==g.historyType){if(B.debug("Using HTML5 to manage state"),g.path===!1){return B.error(l.path),!1}d.address.history(!0).state(g.path)}d.address.bind("change",B.event.history.change)},event:{click:function(w){var v=d(this).data(u.tab);v!==f?(g.history?(B.verbose("Updating page state",w),d.address.value(v)):(B.verbose("Changing tab",w),B.changeTab(v)),w.preventDefault()):B.debug("No tab specified")},history:{change:function(x){var v=x.pathNames.join("/")||B.get.initialPath(),w=g.templates.determineTitle(v)||!1;B.performance.display(),B.debug("History change event",v,x),r=x,v!==f&&B.changeTab(v),w&&d.address.title(w)}}},refresh:function(){K&&(B.debug("Refreshing tab",K),B.changeTab(K))},cache:{read:function(v){return v!==f?G[v]:!1},add:function(w,v){w=w||K,B.debug("Adding cached content for",w),G[w]=v},remove:function(v){v=v||K,B.debug("Removing cached content for",v),delete G[v]}},set:{auto:function(){var v="string"==typeof g.path?g.path.replace(/\/$/,"")+"/{$tab}":"/{$tab}";B.verbose("Setting up automatic tab retrieval from server",v),d.isPlainObject(g.apiSettings)?g.apiSettings.url=v:g.apiSettings={url:v}},loading:function(x){var w=B.get.tabElement(x),v=w.hasClass(o.loading);v||(B.verbose("Setting loading state for",w),w.addClass(o.loading).siblings(Q).removeClass(o.active+" "+o.loading),w.length>0&&g.onRequest.call(w[0],x))},state:function(v){d.address.value(v)}},changeTab:function(v){var A=c.history&&c.history.pushState,w=A&&g.ignoreFirstLoad&&O,y=g.auto||d.isPlainObject(g.apiSettings),x=y&&!w?B.utilities.pathToArray(v):B.get.defaultPathArray(v);v=B.utilities.arrayToPath(x),d.each(x,function(V,C){var W,P,E,L,U=x.slice(0,V+1),S=B.utilities.arrayToPath(U),I=B.is.tab(S),F=V+1==x.length,T=B.get.tabElement(S);if(B.verbose("Looking for tab",C),I){if(B.verbose("Tab was found",C),K=S,M=B.utilities.filterArray(x,U),F?L=!0:(P=x.slice(0,V+2),E=B.utilities.arrayToPath(P),L=!B.is.tab(E),L&&B.verbose("Tab parameters found",P)),L&&y){return w?(B.debug("Ignoring remote content on first tab load",S),O=!1,B.cache.add(v,T.html()),B.activate.all(S),g.onFirstLoad.call(T[0],S,M,r),g.onLoad.call(T[0],S,M,r)):(B.activate.navigation(S),B.fetch.content(S,v)),!1}B.debug("Opened local tab",S),B.activate.all(S),B.cache.read(S)||(B.cache.add(S,!0),B.debug("First time tab loaded calling tab init"),g.onFirstLoad.call(T[0],S,M,r)),g.onLoad.call(T[0],S,M,r)}else{if(-1!=v.search("/")||""===v){return B.error(l.missingTab,i,R,S),!1}if(W=d("#"+v+', a[name="'+v+'"]'),S=W.closest("[data-tab]").data("tab"),T=B.get.tabElement(S),W&&W.length>0&&S){return B.debug("Anchor link used, opening parent tab",T,W),T.hasClass(o.active)||setTimeout(function(){B.scrollTo(W)},0),B.activate.all(S),B.cache.read(S)||(B.cache.add(S,!0),B.debug("First time tab loaded calling tab init"),g.onFirstLoad.call(T[0],S,M,r)),g.onLoad.call(T[0],S,M,r),!1}}})},scrollTo:function(v){var w=v&&v.length>0?v.offset().top:!1;w!==!1&&(B.debug("Forcing scroll to an in-page link in a hidden tab",w,v),d(b).scrollTop(w))},update:{content:function(y,x,v){var w=B.get.tabElement(y),A=w[0];v=v!==f?v:g.evaluateScripts,v?(B.debug("Updating HTML and evaluating inline scripts",y,x),w.html(x)):(B.debug("Updating HTML",y,x),A.innerHTML=x)}},fetch:{content:function(y,w){var x,E,C=B.get.tabElement(y),A={dataType:"html",on:"now",cache:g.alwaysRefresh,headers:{"X-Remote":!0},onSuccess:function(I){B.cache.add(w,I),B.update.content(y,I),y==K?(B.debug("Content loaded",y),B.activate.tab(y)):B.debug("Content loaded in background",y),g.onFirstLoad.call(C[0],y,M,r),g.onLoad.call(C[0],y,M,r)},urlData:{tab:w}},F=C.api("get request")||!1,v=F&&"pending"===F.state();w=w||y,E=B.cache.read(w),g.cache&&E?(B.activate.tab(y),B.debug("Adding cached content",w),"once"==g.evaluateScripts?B.update.content(y,E,!1):B.update.content(y,E),g.onLoad.call(C[0],y,M,r)):v?(B.set.loading(y),B.debug("Content is already loading",w)):d.api!==f?(x=d.extend(!0,{},g.apiSettings,A),B.debug("Retrieving remote content",w,x),B.set.loading(y),C.api(x)):B.error(l.api)}},activate:{all:function(v){B.activate.tab(v),B.activate.navigation(v)},tab:function(x){var w=B.get.tabElement(x),v=w.hasClass(o.active);B.verbose("Showing tab content for",w),v||(w.addClass(o.active).siblings(Q).removeClass(o.active+" "+o.loading),w.length>0&&g.onVisible.call(w[0],x))},navigation:function(x){var w=B.get.navElement(x),v=w.hasClass(o.active);B.verbose("Activating tab navigation for",w,x),v||w.addClass(o.active).siblings(a).removeClass(o.active+" "+o.loading)}},deactivate:{all:function(){B.deactivate.navigation(),B.deactivate.tabs()},navigation:function(){a.removeClass(o.active)},tabs:function(){Q.removeClass(o.active+" "+o.loading)}},is:{tab:function(v){return v!==f?B.get.tabElement(v).length>0:!1}},get:{initialPath:function(){return a.eq(0).data(u.tab)||Q.eq(0).data(u.tab)},path:function(){return d.address.value()},defaultPathArray:function(v){return B.utilities.pathToArray(B.get.defaultPath(v))},defaultPath:function(x){var w=a.filter("[data-"+u.tab+'^="'+x+'/"]').eq(0),v=w.data(u.tab)||!1;if(v){if(B.debug("Found default tab",v),N<g.maxDepth){return N++,B.get.defaultPath(v)}B.error(l.recursion)}else{B.debug("No default tabs found for",x,Q)}return N=0,x},navElement:function(v){return v=v||K,a.filter("[data-"+u.tab+'="'+v+'"]')},tabElement:function(y){var x,v,A,w;return y=y||K,A=B.utilities.pathToArray(y),w=B.utilities.last(A),x=Q.filter("[data-"+u.tab+'="'+w+'"]'),v=Q.filter("[data-"+u.tab+'="'+y+'"]'),x.length>0?x:v},tab:function(){return K}},utilities:{filterArray:function(w,v){return d.grep(w,function(x){return -1==d.inArray(x,v)})},last:function(v){return d.isArray(v)?v[v.length-1]:!1},pathToArray:function(v){return v===f&&(v=K),"string"==typeof v?v.split("/"):[v]},arrayToPath:function(v){return d.isArray(v)?v.join("/"):!1}},setting:function(w,v){if(B.debug("Changing setting",w,v),d.isPlainObject(w)){d.extend(!0,g,w)}else{if(v===f){return g[w]}g[w]=v}},internal:function(w,v){if(d.isPlainObject(w)){d.extend(!0,B,w)}else{if(v===f){return B[w]}B[w]=v}},debug:function(){g.debug&&(g.performance?B.performance.log(arguments):(B.debug=Function.prototype.bind.call(console.info,console,g.name+":"),B.debug.apply(console,arguments)))},verbose:function(){g.verbose&&g.debug&&(g.performance?B.performance.log(arguments):(B.verbose=Function.prototype.bind.call(console.info,console,g.name+":"),B.verbose.apply(console,arguments)))},error:function(){B.error=Function.prototype.bind.call(console.error,console,g.name+":"),B.error.apply(console,arguments)},performance:{log:function(x){var w,v,y;g.performance&&(w=(new Date).getTime(),y=n||w,v=w-y,n=w,h.push({Name:x[0],Arguments:[].slice.call(x,1)||"",Element:z,"Execution Time":v})),clearTimeout(B.performance.timer),B.performance.timer=setTimeout(B.performance.display,500)},display:function(){var w=g.name+":",v=0;n=!1,clearTimeout(B.performance.timer),d.each(h,function(y,x){v+=x["Execution Time"]}),w+=" "+v+"ms",t&&(w+=" '"+t+"'"),(console.group!==f||console.table!==f)&&h.length>0&&(console.groupCollapsed(w),console.table?console.table(h):d.each(h,function(y,x){console.log(x.Name+": "+x["Execution Time"]+"ms")}),console.groupEnd()),h=[]}},invoke:function(y,w,x){var C,A,E,v=s;return w=w||p,x=z||x,"string"==typeof y&&v!==f&&(y=y.split(/[\. ]/),C=y.length-1,d.each(y,function(F,I){var L=F!=C?I+y[F+1].charAt(0).toUpperCase()+y[F+1].slice(1):y;if(d.isPlainObject(v[L])&&F!=C){v=v[L]}else{if(v[L]!==f){return A=v[L],!1}if(!d.isPlainObject(v[I])||F==C){return v[I]!==f?(A=v[I],!1):(B.error(l.method,y),!1)}v=v[I]}})),d.isFunction(A)?E=A.apply(x,w):A!==f&&(E=A),d.isArray(e)?e.push(E):e!==f?e=[e,E]:E!==f&&(e=E),A}},q?(s===f&&B.initialize(),B.invoke(m)):(s!==f&&s.invoke("destroy"),B.initialize())}),e!==f?e:this},d.tab=function(){d(c).tab.apply(this,arguments)},d.fn.tab.settings={name:"Tab",namespace:"tab",debug:!1,verbose:!1,performance:!0,auto:!1,history:!1,historyType:"hash",path:!1,context:!1,childrenOnly:!1,maxDepth:25,alwaysRefresh:!1,cache:!0,ignoreFirstLoad:!1,apiSettings:!1,evaluateScripts:"once",onFirstLoad:function(i,h,g){},onLoad:function(i,h,g){},onVisible:function(i,h,g){},onRequest:function(i,h,g){},templates:{determineTitle:function(a){}},error:{api:"You attempted to load content without API module",method:"The method you called is not defined",missingTab:"Activated tab cannot be found. Tabs are case-sensitive.",noContent:"The tab you specified is missing a content url.",path:"History enabled, but no path was specified",recursion:"Max recursive depth reached",legacyInit:"onTabInit has been renamed to onFirstLoad in 2.0, please adjust your code.",legacyLoad:"onTabLoad has been renamed to onLoad in 2.0. Please adjust your code",state:"History requires Asual's Address library <https://github.com/asual/jquery-address>"},metadata:{tab:"tab",loaded:"loaded",promise:"promise"},className:{loading:"loading",active:"active"},selector:{tabs:".ui.tab",ui:".ui"}}}(jQuery,window,document);