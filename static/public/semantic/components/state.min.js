/*!
 * # Semantic UI x.x - State
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;(function(c,b,a,d){c.fn.state=function(n){var l=c(this),i=l.selector||"",h=("ontouchstart" in a.documentElement),f=new Date().getTime(),k=[],j=arguments[0],e=(typeof j=="string"),m=[].slice.call(arguments,1),g;l.each(function(){var p=(c.isPlainObject(n))?c.extend(true,{},c.fn.state.settings,n):c.extend({},c.fn.state.settings),u=p.error,w=p.metadata,t=p.className,q=p.namespace,z=p.states,y=p.text,A="."+q,s=q+"-module",v=c(this),r=this,x=v.data(s),o;o={initialize:function(){o.verbose("Initializing module");if(p.automatic){o.add.defaults()}if(p.context&&i!==""){c(p.context).on(i,"mouseenter"+A,o.change.text).on(i,"mouseleave"+A,o.reset.text).on(i,"click"+A,o.toggle.state)}else{v.on("mouseenter"+A,o.change.text).on("mouseleave"+A,o.reset.text).on("click"+A,o.toggle.state)}o.instantiate()},instantiate:function(){o.verbose("Storing instance of module",o);x=o;v.data(s,o)},destroy:function(){o.verbose("Destroying previous module",x);v.off(A).removeData(s)},refresh:function(){o.verbose("Refreshing selector cache");v=c(r)},add:{defaults:function(){var B=n&&c.isPlainObject(n.states)?n.states:{};c.each(p.defaults,function(D,C){if(o.is[D]!==d&&o.is[D]()){o.verbose("Adding default states",D,r);c.extend(p.states,C,B)}})}},is:{active:function(){return v.hasClass(t.active)},loading:function(){return v.hasClass(t.loading)},inactive:function(){return !(v.hasClass(t.active))},state:function(B){if(t[B]===d){return false}return v.hasClass(t[B])},enabled:function(){return !(v.is(p.filter.active))},disabled:function(){return(v.is(p.filter.active))},textEnabled:function(){return !(v.is(p.filter.text))},button:function(){return v.is(".button:not(a, .submit)")},input:function(){return v.is("input")},progress:function(){return v.is(".ui.progress")}},allow:function(B){o.debug("Now allowing state",B);z[B]=true},disallow:function(B){o.debug("No longer allowing",B);z[B]=false},allows:function(B){return z[B]||false},enable:function(){v.removeClass(t.disabled)},disable:function(){v.addClass(t.disabled)},setState:function(B){if(o.allows(B)){v.addClass(t[B])}},removeState:function(B){if(o.allows(B)){v.removeClass(t[B])}},toggle:{state:function(){var B,C;if(o.allows("active")&&o.is.enabled()){o.refresh();if(c.fn.api!==d){B=v.api("get request");C=v.api("was cancelled");if(C){o.debug("API Request cancelled by beforesend");p.activateTest=function(){return false};p.deactivateTest=function(){return false}}else{if(B){o.listenTo(B);return}}}o.change.state()}}},listenTo:function(B){o.debug("API request detected, waiting for state signal",B);if(B){if(y.loading){o.update.text(y.loading)}c.when(B).then(function(){if(B.state()=="resolved"){o.debug("API request succeeded");p.activateTest=function(){return true};p.deactivateTest=function(){return true}}else{o.debug("API request failed");p.activateTest=function(){return false};p.deactivateTest=function(){return false}}o.change.state()})}},change:{state:function(){o.debug("Determining state change direction");if(o.is.inactive()){o.activate()}else{o.deactivate()}if(p.sync){o.sync()}p.onChange.call(r)},text:function(){if(o.is.textEnabled()){if(o.is.disabled()){o.verbose("Changing text to disabled text",y.hover);o.update.text(y.disabled)}else{if(o.is.active()){if(y.hover){o.verbose("Changing text to hover text",y.hover);o.update.text(y.hover)}else{if(y.deactivate){o.verbose("Changing text to deactivating text",y.deactivate);o.update.text(y.deactivate)}}}else{if(y.hover){o.verbose("Changing text to hover text",y.hover);o.update.text(y.hover)}else{if(y.activate){o.verbose("Changing text to activating text",y.activate);o.update.text(y.activate)}}}}}}},activate:function(){if(p.activateTest.call(r)){o.debug("Setting state to active");v.addClass(t.active);o.update.text(y.active);p.onActivate.call(r)}},deactivate:function(){if(p.deactivateTest.call(r)){o.debug("Setting state to inactive");v.removeClass(t.active);o.update.text(y.inactive);p.onDeactivate.call(r)}},sync:function(){o.verbose("Syncing other buttons to current state");if(o.is.active()){l.not(v).state("activate")}else{l.not(v).state("deactivate")}},get:{text:function(){return(p.selector.text)?v.find(p.selector.text).text():v.html()},textFor:function(B){return y[B]||false}},flash:{text:function(D,C,E){var B=o.get.text();o.debug("Flashing text message",D,C);D=D||p.text.flash;C=C||p.flashDuration;E=E||function(){};o.update.text(D);setTimeout(function(){o.update.text(B);E.call(r)},C)}},reset:{text:function(){var B=y.active||v.data(w.storedText),C=y.inactive||v.data(w.storedText);if(o.is.textEnabled()){if(o.is.active()&&B){o.verbose("Resetting active text",B);o.update.text(B)}else{if(C){o.verbose("Resetting inactive text",B);o.update.text(C)}}}}},update:{text:function(C){var B=o.get.text();if(C&&C!==B){o.debug("Updating text",C);if(p.selector.text){v.data(w.storedText,C).find(p.selector.text).text(C)}else{v.data(w.storedText,C).html(C)}}else{o.debug("Text is already set, ignoring update",C)}}},setting:function(B,C){o.debug("Changing setting",B,C);if(c.isPlainObject(B)){c.extend(true,p,B)}else{if(C!==d){p[B]=C}else{return p[B]}}},internal:function(B,C){if(c.isPlainObject(B)){c.extend(true,o,B)}else{if(C!==d){o[B]=C}else{return o[B]}}},debug:function(){if(p.debug){if(p.performance){o.performance.log(arguments)}else{o.debug=Function.prototype.bind.call(console.info,console,p.name+":");o.debug.apply(console,arguments)}}},verbose:function(){if(p.verbose&&p.debug){if(p.performance){o.performance.log(arguments)}else{o.verbose=Function.prototype.bind.call(console.info,console,p.name+":");o.verbose.apply(console,arguments)}}},error:function(){o.error=Function.prototype.bind.call(console.error,console,p.name+":");o.error.apply(console,arguments)},performance:{log:function(D){var C,E,B;if(p.performance){C=new Date().getTime();B=f||C;E=C-B;f=C;k.push({Name:D[0],Arguments:[].slice.call(D,1)||"",Element:r,"Execution Time":E})}clearTimeout(o.performance.timer);o.performance.timer=setTimeout(o.performance.display,500)},display:function(){var C=p.name+":",B=0;f=false;clearTimeout(o.performance.timer);c.each(k,function(D,E){B+=E["Execution Time"]});C+=" "+B+"ms";if(i){C+=" '"+i+"'"}if((console.group!==d||console.table!==d)&&k.length>0){console.groupCollapsed(C);if(console.table){console.table(k)}else{c.each(k,function(D,E){console.log(E.Name+": "+E["Execution Time"]+"ms")})}console.groupEnd()}k=[]}},invoke:function(G,C,E){var D=x,H,F,B;C=C||m;E=r||E;if(typeof G=="string"&&D!==d){G=G.split(/[\. ]/);H=G.length-1;c.each(G,function(K,J){var I=(K!=H)?J+G[K+1].charAt(0).toUpperCase()+G[K+1].slice(1):G;if(c.isPlainObject(D[I])&&(K!=H)){D=D[I]}else{if(D[I]!==d){F=D[I];return false}else{if(c.isPlainObject(D[J])&&(K!=H)){D=D[J]}else{if(D[J]!==d){F=D[J];return false}else{o.error(u.method,G);return false}}}}})}if(c.isFunction(F)){B=F.apply(E,C)}else{if(F!==d){B=F}}if(c.isArray(g)){g.push(B)}else{if(g!==d){g=[g,B]}else{if(B!==d){g=B}}}return F}};if(e){if(x===d){o.initialize()}o.invoke(j)}else{if(x!==d){x.invoke("destroy")}o.initialize()}});return(g!==d)?g:this};c.fn.state.settings={name:"State",debug:false,verbose:false,namespace:"state",performance:true,onActivate:function(){},onDeactivate:function(){},onChange:function(){},activateTest:function(){return true},deactivateTest:function(){return true},automatic:true,sync:false,flashDuration:1000,filter:{text:".loading, .disabled",active:".disabled"},context:false,error:{beforeSend:"The before send function has cancelled state change",method:"The method you called is not defined."},metadata:{promise:"promise",storedText:"stored-text"},className:{active:"active",disabled:"disabled",error:"error",loading:"loading",success:"success",warning:"warning"},selector:{text:false},defaults:{input:{disabled:true,loading:true,active:true},button:{disabled:true,loading:true,active:true},progress:{active:true,success:true,warning:true,error:true}},states:{active:true,disabled:true,error:true,loading:true,success:true,warning:true},text:{disabled:false,flash:false,hover:false,active:false,inactive:false,activate:false,deactivate:false}}})(jQuery,window,document);