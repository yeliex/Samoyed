/*!
 * # Semantic UI x.x - Form Validation
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;!function(c,b,d,a){c.fn.form=function(p){var e,g=c(this),m=g.selector||"",q=(new Date).getTime(),h=[],k=arguments[0],n=arguments[1],i="string"==typeof k,j=[].slice.call(arguments,1);return g.each(function(){var N,X,P,H,W,Y,u,Q,B,G,J,L,o,r,I,M,l,s,t=c(this),K=this,U=[],f=!1;s={initialize:function(){s.get.settings(),i?(l===a&&s.instantiate(),s.invoke(k)):(s.verbose("Initializing form validation",t,Q),s.bindEvents(),s.set.defaults(),s.instantiate())},instantiate:function(){s.verbose("Storing instance of module",s),l=s,t.data(I,s)},destroy:function(){s.verbose("Destroying previous module",l),s.removeEvents(),t.removeData(I)},refresh:function(){s.verbose("Refreshing selector cache"),N=t.find(J.field),X=t.find(J.group),P=t.find(J.message),H=t.find(J.prompt),W=t.find(J.submit),Y=t.find(J.clear),u=t.find(J.reset)},submit:function(){s.verbose("Submitting form",t),t.submit()},attachEvents:function(v,w){w=w||"submit",c(v).on("click"+M,function(x){s[w](),x.preventDefault()})},bindEvents:function(){s.verbose("Attaching form events"),t.on("submit"+M,s.validate.form).on("blur"+M,J.field,s.event.field.blur).on("click"+M,J.submit,s.submit).on("click"+M,J.reset,s.reset).on("click"+M,J.clear,s.clear),Q.keyboardShortcuts&&t.on("keydown"+M,J.field,s.event.field.keydown),N.each(function(){var w=c(this),x=w.prop("type"),v=s.get.changeEvent(x,w);c(this).on(v+M,s.event.field.change)})},clear:function(){N.each(function(){var y=c(this),D=y.parent(),x=y.closest(X),A=x.find(J.prompt),C=y.data(G.defaultValue)||"",w=D.is(J.uiCheckbox),z=D.is(J.uiDropdown),v=x.hasClass(L.error);v&&(s.verbose("Resetting error on field",x),x.removeClass(L.error),A.remove()),z?(s.verbose("Resetting dropdown value",D,C),D.dropdown("clear")):w?y.prop("checked",!1):(s.verbose("Resetting field value",y,C),y.val(""))})},reset:function(){N.each(function(){var x=c(this),D=x.parent(),z=x.closest(X),A=z.find(J.prompt),w=x.data(G.defaultValue),y=D.is(J.uiCheckbox),v=D.is(J.uiDropdown),C=z.hasClass(L.error);w!==a&&(C&&(s.verbose("Resetting error on field",z),z.removeClass(L.error),A.remove()),v?(s.verbose("Resetting dropdown value",D,w),D.dropdown("restore defaults")):y?(s.verbose("Resetting checkbox value",D,w),x.prop("checked",w)):(s.verbose("Resetting field value",x,w),x.val(w)))})},is:{valid:function(){var v=!0;return s.verbose("Checking if form is valid"),c.each(B,function(w,x){s.validate.field(x)||(v=!1)}),v}},removeEvents:function(){t.off(M),N.off(M),W.off(M),N.off(M)},event:{field:{keydown:function(w){var y=c(this),v=w.which,x={enter:13,escape:27};v==x.escape&&(s.verbose("Escape key pressed blurring field"),y.blur()),!w.ctrlKey&&v==x.enter&&y.is(J.input)&&y.not(J.checkbox).length>0&&(f||(y.one("keyup"+M,s.event.field.keyup),s.submit(),s.debug("Enter pressed on input submitting form")),f=!0)},keyup:function(){f=!1},blur:function(){var w=c(this),x=w.closest(X),v=s.get.validation(w);x.hasClass(L.error)?(s.debug("Revalidating field",w,v),s.validate.field(v)):("blur"==Q.on||"change"==Q.on)&&s.validate.field(v)},change:function(){var v=c(this),w=v.closest(X);("change"==Q.on||w.hasClass(L.error)&&Q.revalidate)&&(clearTimeout(s.timer),s.timer=setTimeout(function(){s.debug("Revalidating field",v,s.get.validation(v)),s.validate.field(s.get.validation(v))},Q.delay))}}},get:{changeEvent:function(w,v){return"checkbox"==w||"radio"==w||"hidden"==w||v.is("select")?"change":s.get.inputEvent()},inputEvent:function(){return d.createElement("input").oninput!==a?"input":d.createElement("input").onpropertychange!==a?"propertychange":"keyup"},settings:function(){if(c.isPlainObject(p)){var w=Object.keys(p),v=w.length>0?p[w[0]].identifier!==a:!1;v?(Q=c.extend(!0,{},c.fn.form.settings,n),B=c.extend({},c.fn.form.settings.defaults,p),s.error(Q.error.oldSyntax,K),s.verbose("Extending settings from legacy parameters",B,Q)):(Q=c.extend(!0,{},c.fn.form.settings,p),B=c.extend({},c.fn.form.settings.defaults,Q.fields),s.verbose("Extending settings",B,Q))}else{Q=c.fn.form.settings,B=c.fn.form.settings.defaults,s.verbose("Using default form validation",B,Q)}r=Q.namespace,G=Q.metadata,J=Q.selector,L=Q.className,o=Q.error,I="module-"+r,M="."+r,l=t.data(I),s.refresh()},field:function(v){return s.verbose("Finding field with identifier",v),N.filter("#"+v).length>0?N.filter("#"+v):N.filter('[name="'+v+'"]').length>0?N.filter('[name="'+v+'"]'):N.filter('[name="'+v+'[]"]').length>0?N.filter('[name="'+v+'[]"]'):N.filter("[data-"+G.validate+'="'+v+'"]').length>0?N.filter("[data-"+G.validate+'="'+v+'"]'):c("<input/>")},fields:function(v){var w=c();return c.each(v,function(y,x){w=w.add(s.get.field(x))}),w},validation:function(v){var w;return B?(c.each(B,function(y,x){s.get.field(x.identifier)[0]==v[0]&&(w=x)}),w||!1):!1},value:function(w){var v,x=[];return x.push(w),v=s.get.values.call(K,x),v[w]},values:function(w){var x=c.isArray(w)?s.get.fields(w):N,v={};return x.each(function(O,A){var y=c(A),z=(y.prop("type"),y.prop("name")),E=y.val(),R=y.is(J.checkbox),C=y.is(J.radio),D=-1!==z.indexOf("[]"),F=R?y.is(":checked"):!1;if(z){if(D){if(z=z.replace("[]",""),v[z]||(v[z]=[]),R){if(!F){return s.debug("Omitted unchecked checkbox",y),!0}v[z].push(E)}else{v[z].push(E)}}else{if(C){F&&(v[z]=E)}else{if(R){if(!F){return s.debug("Omitted unchecked checkbox",y),!0}v[z]=!0}else{v[z]=E}}}}}),v}},has:{field:function(v){return s.verbose("Checking for existence of a field with identifier",v),N.filter("#"+v).length>0?!0:N.filter('[name="'+v+'"]').length>0?!0:N.filter("[data-"+G.validate+'="'+v+'"]').length>0?!0:!1}},add:{prompt:function(w,A){var y=s.get.field(w),z=y.closest(X),v=z.children(J.prompt),x=0!==v.length;A="string"==typeof A?[A]:A,s.verbose("Adding field error state",w),z.addClass(L.error),Q.inline&&(x||(v=Q.templates.prompt(A),v.appendTo(z)),v.html(A[0]),x?s.verbose("Inline errors are disabled, no inline error added",w):Q.transition&&c.fn.transition!==a&&t.transition("is supported")?(s.verbose("Displaying error with css transition",Q.transition),v.transition(Q.transition+" in",Q.duration)):(s.verbose("Displaying error with fallback javascript animation"),v.fadeIn(Q.duration)))},errors:function(v){s.debug("Adding form error messages",v),P.html(Q.templates.error(v))}},remove:{prompt:function(v){var y=s.get.field(v.identifier),w=y.closest(X),x=w.children(J.prompt);w.removeClass(L.error),Q.inline&&x.is(":visible")&&(s.verbose("Removing prompt for field",v),Q.transition&&c.fn.transition!==a&&t.transition("is supported")?x.transition(Q.transition+" out",Q.duration,function(){x.remove()}):x.fadeOut(Q.duration,function(){x.remove()}))}},set:{success:function(){t.removeClass(L.error).addClass(L.success)},defaults:function(){N.each(function(){var w=c(this),x=w.filter(J.checkbox).length>0,v=x?w.is(":checked"):w.val();w.data(G.defaultValue,v)})},error:function(){t.removeClass(L.success).addClass(L.error)},value:function(w,v){var x={};return x[w]=v,s.set.values.call(K,x)},values:function(v){c.isEmptyObject(v)||c.each(v,function(F,y){var A,w=s.get.field(F),x=w.parent(),D=c.isArray(y),O=x.is(J.uiCheckbox),z=x.is(J.uiDropdown),C=w.is(J.radio)&&O,E=w.length>0;E&&(D&&O?(s.verbose("Selecting multiple",y,w),x.checkbox("uncheck"),c.each(y,function(S,R){A=w.filter('[value="'+R+'"]'),x=A.parent(),A.length>0&&x.checkbox("check")})):C?(s.verbose("Selecting radio value",y,w),w.filter('[value="'+y+'"]').parent(J.uiCheckbox).checkbox("check")):O?(s.verbose("Setting checkbox value",y,x),x.checkbox(y===!0?"check":"uncheck")):z?(s.verbose("Setting dropdown value",y,x),x.dropdown("set selected",y)):(s.verbose("Setting field value",y,w),w.val(y)))})}},validate:{form:function(v){return f?!1:(U=[],s.is.valid()?(s.debug("Form has no validation errors, submitting"),s.set.success(),Q.onSuccess.call(K,v)):(s.debug("Form has errors"),s.set.error(),Q.inline||s.add.errors(U),t.data("moduleApi")!==a&&v.stopImmediatePropagation(),Q.onFailure.call(K,U)))},field:function(v){var y=s.get.field(v.identifier),w=!0,x=[];return y.prop("disabled")?(s.debug("Field is disabled. Skipping",v.identifier),w=!0):v.optional&&""===c.trim(y.val())?(s.debug("Field is optional and empty. Skipping",v.identifier),w=!0):v.rules!==a&&c.each(v.rules,function(z,A){s.has.field(v.identifier)&&!s.validate.rule(v,A)&&(s.debug("Field is invalid",v.identifier,A.type),x.push(A.prompt),w=!1)}),w?(s.remove.prompt(v,x),Q.onValid.call(y),!0):(U=U.concat(x),s.add.prompt(v.identifier,x),Q.onInvalid.call(y,x),!1)},rule:function(E,x){var z,v,w,C=s.get.field(E.identifier),F=x.type,y=C.val(),A=F.match(Q.regExp.bracket),D=!0;if(y=c.trim(C.val()+""),A){if(v=""+A[1],w=F.replace(A[0],""),z=Q.rules[w],!c.isFunction(z)){return void s.error(o.noRule,w)}D=z.call(C,y,v)}else{if(z=Q.rules[F],!c.isFunction(z)){return void s.error(o.noRule,F)}D=z.call(C,y)}return D}},setting:function(v,w){if(c.isPlainObject(v)){c.extend(!0,Q,v)}else{if(w===a){return Q[v]}Q[v]=w}},internal:function(v,w){if(c.isPlainObject(v)){c.extend(!0,s,v)}else{if(w===a){return s[v]}s[v]=w}},debug:function(){Q.debug&&(Q.performance?s.performance.log(arguments):(s.debug=Function.prototype.bind.call(console.info,console,Q.name+":"),s.debug.apply(console,arguments)))},verbose:function(){Q.verbose&&Q.debug&&(Q.performance?s.performance.log(arguments):(s.verbose=Function.prototype.bind.call(console.info,console,Q.name+":"),s.verbose.apply(console,arguments)))},error:function(){s.error=Function.prototype.bind.call(console.error,console,Q.name+":"),s.error.apply(console,arguments)},performance:{log:function(x){var w,y,v;Q.performance&&(w=(new Date).getTime(),v=q||w,y=w-v,q=w,h.push({Name:x[0],Arguments:[].slice.call(x,1)||"",Element:K,"Execution Time":y})),clearTimeout(s.performance.timer),s.performance.timer=setTimeout(s.performance.display,500)},display:function(){var v=Q.name+":",w=0;q=!1,clearTimeout(s.performance.timer),c.each(h,function(y,x){w+=x["Execution Time"]}),v+=" "+w+"ms",m&&(v+=" '"+m+"'"),g.length>1&&(v+=" ("+g.length+")"),(console.group!==a||console.table!==a)&&h.length>0&&(console.groupCollapsed(v),console.table?console.table(h):c.each(h,function(y,x){console.log(x.Name+": "+x["Execution Time"]+"ms")}),console.groupEnd()),h=[]}},invoke:function(x,C,z){var w,y,v,A=l;return C=C||j,z=K||z,"string"==typeof x&&A!==a&&(x=x.split(/[\. ]/),w=x.length-1,c.each(x,function(F,D){var E=F!=w?D+x[F+1].charAt(0).toUpperCase()+x[F+1].slice(1):x;if(c.isPlainObject(A[E])&&F!=w){A=A[E]}else{if(A[E]!==a){return y=A[E],!1}if(!c.isPlainObject(A[D])||F==w){return A[D]!==a?(y=A[D],!1):!1}A=A[D]}})),c.isFunction(y)?v=y.apply(z,C):y!==a&&(v=y),c.isArray(e)?e.push(v):e!==a?e=[e,v]:v!==a&&(e=v),y}},s.initialize()}),e!==a?e:this},c.fn.form.settings={name:"Form",namespace:"form",debug:!1,verbose:!1,performance:!0,fields:!1,keyboardShortcuts:!0,on:"submit",inline:!1,delay:200,revalidate:!0,transition:"scale",duration:200,onValid:function(){},onInvalid:function(){},onSuccess:function(){return !0},onFailure:function(){return !1},metadata:{defaultValue:"default",validate:"validate"},regExp:{bracket:/\[(.*)\]/i,escape:/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,email:"[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?",integer:/^\-?\d+$/,flags:/^\/(.*)\/(.*)?/,url:/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/i},selector:{checkbox:'input[type="checkbox"], input[type="radio"]',clear:".clear",field:"input, textarea, select",group:".field",input:"input",message:".error.message",prompt:".prompt.label",radio:'input[type="radio"]',reset:'.reset:not([type="reset"])',submit:'.submit:not([type="submit"])',uiCheckbox:".ui.checkbox",uiDropdown:".ui.dropdown"},className:{error:"error",label:"ui prompt label",pressed:"down",success:"success"},error:{oldSyntax:"Starting in 2.0 forms now only take a single settings object. Validation settings converted to new syntax automatically.",noRule:"There is no rule matching the one you specified",method:"The method you called is not defined."},templates:{error:function(e){var f='<ul class="list">';return c.each(e,function(h,g){f+="<li>"+g+"</li>"}),f+="</ul>",c(f)},prompt:function(e){return c("<div/>").addClass("ui red pointing prompt label").html(e[0])}},rules:{checked:function(){return c(this).filter(":checked").length>0},contains:function(e,f){return f=f.replace(c.fn.form.settings.regExp.escape,"\\$&"),-1!==e.search(new RegExp(f,"i"))},containsExactly:function(e,f){return f=f.replace(c.fn.form.settings.regExp.escape,"\\$&"),-1!==e.search(new RegExp(f))},email:function(e){var f=new RegExp(c.fn.form.settings.regExp.email,"i");return f.test(e)},empty:function(e){return !(e===a||""===e||c.isArray(e)&&0===e.length)},integer:function(f,j){var h,i,e,g=c.fn.form.settings.regExp.integer;return j===a||""===j||".."===j||(-1==j.indexOf("..")?g.test(j)&&(h=i=j-0):(e=j.split("..",2),g.test(e[0])&&(h=e[0]-0),g.test(e[1])&&(i=e[1]-0))),g.test(f)&&(h===a||f>=h)&&(i===a||i>=f)},is:function(g,f){return f="string"==typeof f?f.toLowerCase():f,g="string"==typeof g?g.toLowerCase():g,g==f},isExactly:function(g,f){return g==f},length:function(g,f){return g!==a?g.length>=f:!1},different:function(e,g){var f;c(this);return c('[data-validate="'+g+'"]').length>0?f=c('[data-validate="'+g+'"]').val():c("#"+g).length>0?f=c("#"+g).val():c('[name="'+g+'"]').length>0?f=c('[name="'+g+'"]').val():c('[name="'+g+'[]"]').length>0&&(f=c('[name="'+g+'[]"]')),f!==a?e.toString()!==f.toString():!1},match:function(e,g){var f;c(this);return c('[data-validate="'+g+'"]').length>0?f=c('[data-validate="'+g+'"]').val():c("#"+g).length>0?f=c("#"+g).val():c('[name="'+g+'"]').length>0?f=c('[name="'+g+'"]').val():c('[name="'+g+'[]"]').length>0&&(f=c('[name="'+g+'[]"]')),f!==a?e.toString()==f.toString():!1},maxCount:function(e,f){return e=e.split(","),c.isArray(e)&&e.length<=f},exactCount:function(e,f){return e=e.split(","),c.isArray(e)&&e.length==f},minCount:function(e,f){return e=e.split(","),c.isArray(e)&&e.length>=f},regExp:function(f,h){var e,g=h.match(c.fn.form.settings.regExp.flags);return g&&(h=g.length>=2?g[1]:h,e=g.length>=3?g[2]:""),f.match(new RegExp(h,e))},maxLength:function(g,f){return g!==a?g.length<=f:!1},not:function(g,f){return g="string"==typeof g?g.toLowerCase():g,f="string"==typeof f?f.toLowerCase():f,g!=f},notExactly:function(g,f){return g!=f},url:function(e){return c.fn.form.settings.regExp.url.match(e)}}}}(jQuery,window,document);